<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>TFM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Definitivo_files/libs/clipboard/clipboard.min.js"></script>
<script src="Definitivo_files/libs/quarto-html/quarto.js"></script>
<script src="Definitivo_files/libs/quarto-html/popper.min.js"></script>
<script src="Definitivo_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Definitivo_files/libs/quarto-html/anchor.min.js"></script>
<link href="Definitivo_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Definitivo_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Definitivo_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Definitivo_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Definitivo_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="Definitivo_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="Definitivo_files/libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="Definitivo_files/libs/typedarray-0.1/typedarray.min.js"></script>

<script src="Definitivo_files/libs/jquery-3.5.1/jquery.min.js"></script>

<link href="Definitivo_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="Definitivo_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="Definitivo_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="Definitivo_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>



</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">TFM</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="carga-de-datos" class="level1">
<h1>Carga de datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("TSA")</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'TSA'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    acf, arima</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    tar</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'quantmod':
  method            from
  as.zoo.data.frame zoo </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 methods overwritten by 'forecast':
  method       from
  fitted.Arima TSA 
  plot.Arima   TSA </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#!install.packages("MTS")</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MTS)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plotly':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: strucchange</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: sandwich</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: urca</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'vars'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MTS':

    VAR</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gridExtra':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("aod")  </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="co"># Se Desactiva los warnings</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>({</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(quantmod)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(forecast)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tseries)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se carga las variables independiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar archivos</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>data_nieve <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"DepthSnow1931_2021.txt"</span>, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">""</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_nieve) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>, <span class="st">"V4"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>data_radiacion <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"GlobalRadiation1901_2021.txt"</span>, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">""</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_radiacion) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>, <span class="st">"Radiation"</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>data_temperatura <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"MeanTemp1901_2021.txt"</span>, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">""</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_temperatura) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>, <span class="st">"Temperature"</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>data_precipitacion <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Precipitacion1901_2021.txt"</span>, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">""</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_precipitacion) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>, <span class="st">"Precipitation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se carga la variable dependiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>data_balance <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="st">"mass_balance_observation_aletsch.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Se divide Value entre 1000 para pasarlo a metros.</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>data_balance<span class="sc">$</span>Value <span class="ot">&lt;-</span> data_balance<span class="sc">$</span>Value <span class="sc">/</span> <span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se crea la columna fecha en las tablas</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>data_nieve<span class="sc">$</span>Fecha <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">with</span>(data_nieve, <span class="fu">paste</span>(V1, V2, V3, <span class="at">sep =</span> <span class="st">"-"</span>)), <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>data_temperatura<span class="sc">$</span>Fecha <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">with</span>(data_temperatura, <span class="fu">paste</span>(V1, V2, V3, <span class="at">sep =</span> <span class="st">"-"</span>)), <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>data_precipitacion<span class="sc">$</span>Fecha <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">with</span>(data_precipitacion, <span class="fu">paste</span>(V1, V2, V3, <span class="at">sep =</span> <span class="st">"-"</span>)), <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>data_radiacion<span class="sc">$</span>Fecha <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">with</span>(data_radiacion, <span class="fu">paste</span>(V1, V2, V3, <span class="at">sep =</span> <span class="st">"-"</span>)), <span class="st">"%Y-%m-%d"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tratamiento-de-los-datos" class="level1">
<h1>Tratamiento de los datos</h1>
<section id="rellenar-valores-faltantes-de-profundidad-de-la-nieve" class="level2">
<h2 class="anchored" data-anchor-id="rellenar-valores-faltantes-de-profundidad-de-la-nieve">rellenar valores faltantes de Profundidad de la nieve</h2>
<p>Durante el proceso de descarga de datos, se identificó la presencia de valores faltantes en la tabla de profundidad de la nieve. Se observara que, en algunos meses, los registros diarios estaban incompletos y presentaban valores distribuidos de manera aleatoria, sin una secuencia clara.</p>
<p>Para determinar si los datos faltantes deben ser interpolados o descartados, se realizó un análisis comparativo del comportamiento de la profundidad de la nieve (en metros) en los meses con datos ausentes. Esta comparación se llevó a cabo diferenciando dos períodos: antes de 1959 y después de 1959 . Si el patrón observado en ambos períodos es consistente, los valores faltantes podrían ser estimados mediante interpolación. En cambio, si se identifican diferencias significativas en los patrones, se considerará la opción de omitir estos datos en el análisis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un subconjunto con los datos antes de 1959</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>datosAntes1959 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_nieve, Fecha <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">"1959-01-01"</span>))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un subconjunto con los datos después de 1959</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>datosDespues1959 <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_nieve, Fecha <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1959-01-01"</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar columnas de Año y Mes</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>datosAntes1959 <span class="ot">&lt;-</span> datosAntes1959 <span class="sc">%&gt;%</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>), <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>))</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>datosDespues1959 <span class="ot">&lt;-</span> datosDespues1959 <span class="sc">%&gt;%</span> </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>), <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>))</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el número de días presentes por mes antes de 1959</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>diasPorMesAntes1959 <span class="ot">&lt;-</span> datosAntes1959 <span class="sc">%&gt;%</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año, Mes) <span class="sc">%&gt;%</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">DiasPresentes =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el promedio de nieve por mes antes de 1959</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>promedioPorMesAntes1959 <span class="ot">&lt;-</span> datosAntes1959 <span class="sc">%&gt;%</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Mes) <span class="sc">%&gt;%</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">NievePromedio =</span> <span class="fu">mean</span>(V4, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el promedio de nieve por mes después de 1959</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>promedioPorMesDespues1959 <span class="ot">&lt;-</span> datosDespues1959 <span class="sc">%&gt;%</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Mes) <span class="sc">%&gt;%</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">NievePromedio =</span> <span class="fu">mean</span>(V4, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear un dataframe auxiliar para la leyenda</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>leyenda <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">Periodo =</span> <span class="fu">c</span>(<span class="st">"Antes de 1959"</span>, <span class="st">"Después de 1959"</span>),</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Color =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar la comparación de promedios con leyenda</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> promedioPorMesAntes1959, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(Mes), <span class="at">y =</span> NievePromedio, <span class="at">color =</span> <span class="st">"Antes de 1959"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> promedioPorMesDespues1959, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.numeric</span>(Mes), <span class="at">y =</span> NievePromedio, <span class="at">color =</span> <span class="st">"Después de 1959"</span>), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">setNames</span>(leyenda<span class="sc">$</span>Color, leyenda<span class="sc">$</span>Periodo)</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Comparación del nivel promedio de nieve por mes"</span>,</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mes"</span>,</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Nieve Promedio (m)"</span>,</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Periodo"</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">labels =</span> month.abb) <span class="sc">+</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,  <span class="co"># Coloca la leyenda en la parte superior</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),  <span class="co"># Tamaño del título de la leyenda</span></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)     <span class="co"># Tamaño del texto de la leyenda</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como se observa en la gráfica, las líneas siguen un patrón similar, donde la profundidad de la nieve aumenta durante el invierno y disminuye en verano. Este comportamiento consistente sugiere que, al mantener una tendencia estacional clara, los datos faltantes pueden ser interpolados de manera razonable. De este modo, sería posible completar los registros ausentes y recuperar información de los años en los que los datos están incompletos, permitiendo un análisis más amplio y preciso.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una serie completa de fechas desde el primer día hasta el último de los datos</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>fechas_completas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fecha =</span> <span class="fu">seq</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">"1931-01-02"</span>), </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">as.Date</span>(<span class="st">"1958-12-31"</span>), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"day"</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Unir las fechas completas con los datos originales</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>datos_completados <span class="ot">&lt;-</span> fechas_completas <span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(datosAntes1959, <span class="at">by =</span> <span class="st">"Fecha"</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Rellenar los valores faltantes en la columna V4 con interpolación lineal</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>datos_completados <span class="ot">&lt;-</span> datos_completados <span class="sc">%&gt;%</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Fecha) <span class="sc">%&gt;%</span> <span class="co"># Asegurar que las fechas estén ordenadas</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">V4 =</span> <span class="fu">na.approx</span>(V4, <span class="at">na.rm =</span> <span class="cn">FALSE</span>) <span class="co"># Interpolación lineal</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  ambos datasets deben tener las mismas columnas</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datos_completados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Fecha" "V1"    "V2"    "V3"    "V4"    "Año"   "Mes"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(datosDespues1959)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "V1"    "V2"    "V3"    "V4"    "Fecha" "Año"   "Mes"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminar columnas V1,V2,V3,Año,Mes</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>datos_completados<span class="ot">&lt;-</span>datos_completados<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>V1,<span class="sc">-</span>V2,<span class="sc">-</span>V3,<span class="sc">-</span>Año, <span class="sc">-</span>Mes)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>datosDespues1959<span class="ot">&lt;-</span>datosDespues1959<span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>V1,<span class="sc">-</span>V2,<span class="sc">-</span>V3,<span class="sc">-</span>Año, <span class="sc">-</span>Mes)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># organizo datos despues de 1959</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>datosDespues1959<span class="ot">&lt;-</span>datosDespues1959 <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Fecha,V4)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar los datasets</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(datos_completados, datosDespues1959)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordenar por fecha para garantizar continuidad temporal</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Fecha)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>datos_combinados<span class="ot">&lt;-</span>datos_combinados <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">DepthSnow=</span>V4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos_combinados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Fecha              DepthSnow    
 Min.   :1931-01-02   Min.   :0.000  
 1st Qu.:1953-08-15   1st Qu.:0.117  
 Median :1976-03-29   Median :1.350  
 Mean   :1976-03-30   Mean   :1.803  
 3rd Qu.:1998-11-10   3rd Qu.:3.100  
 Max.   :2021-08-31   Max.   :8.160  
                      NA's   :5      </code></pre>
</div>
</div>
<p>Rellenar los datos faltantes con la interpolación esta bien, dado que los valores giran todos entorno a la misma profundida de nieve en este mes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rellenar los valores faltantes en la columna  con interpolación lineal</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados<span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Fecha) <span class="sc">%&gt;%</span> <span class="co"># Asegurar que las fechas estén ordenadas</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">DepthSnow =</span> <span class="fu">na.approx</span>(DepthSnow, <span class="at">na.rm =</span> <span class="cn">FALSE</span>) <span class="co"># Interpolación lineal</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="temperatura" class="level2">
<h2 class="anchored" data-anchor-id="temperatura">Temperatura</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear columnas de Año y Mes y calcular la temperatura promedio por mes</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>promedioPorMes <span class="ot">&lt;-</span> data_temperatura <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>), <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Mes) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TemperaturaPromedio =</span> <span class="fu">mean</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir Mes a numérico para evitar problemas en la gráfica</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>promedioPorMes<span class="sc">$</span>Mes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(promedioPorMes<span class="sc">$</span>Mes)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo con líneas de referencia</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>grafico_interactivo <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(promedioPorMes, </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">x =</span> <span class="sc">~</span>Mes, <span class="at">y =</span> <span class="sc">~</span>TemperaturaPromedio, </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, </span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Promedio mensual de la temperatura"</span>,</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Mes"</span>, <span class="at">tickvals =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">ticktext =</span> month.abb),</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperatura Promedio (°C)"</span>),</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">orientation =</span> <span class="st">"h"</span>, <span class="at">x =</span> <span class="fl">0.3</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fl">0.2</span>),</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>))</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>grafico_interactivo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-627567f99bf2763aba36" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-627567f99bf2763aba36">{"x":{"visdat":{"7ed83438639a":["function () ","plotlyVisDat"]},"cur_data":"7ed83438639a","attrs":{"7ed83438639a":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"blue","width":2},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":50,"r":10},"title":"Promedio mensual de la temperatura","xaxis":{"domain":[0,1],"automargin":true,"title":"Mes","tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"ticktext":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Temperatura Promedio (°C)"},"legend":{"orientation":"h","x":0.29999999999999999,"y":-0.20000000000000001},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[-7.8535979440319821,-7.9988408521303258,-6.2425920639451897,-3.4933923303834806,0.94364830145589496,4.7363421828908558,7.4771338852412219,7.4144931745570721,4.5246546546546549,0.50284800929962215,-4.2709822769600478,-6.7675966288869516],"mode":"lines+markers","line":{"color":"blue","width":2},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la columna Año antes de agrupar</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>promedioPorAnioTemperature <span class="ot">&lt;-</span> data_temperatura <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(<span class="fu">as.Date</span>(Fecha), <span class="st">"%Y"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Convertir Fecha a Date si no lo es</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">TemperaturaPromedioAnual =</span> <span class="fu">mean</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo con plotly</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>grafico_interactivo <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  promedioPorAnioTemperature,</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año),</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>TemperaturaPromedioAnual,</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución anual de la temperatura"</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Temperatura Promedio Anual (°C)"</span>),</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>),</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico interactivo</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>grafico_interactivo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-840c0e5b3d236e5f4dc2" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-840c0e5b3d236e5f4dc2">{"x":{"visdat":{"7ed81eb134e1":["function () ","plotlyVisDat"]},"cur_data":"7ed81eb134e1","attrs":{"7ed81eb134e1":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"blue","width":2},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":50,"r":10},"title":"Evolución anual de la temperatura","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45},"yaxis":{"domain":[0,1],"automargin":true,"title":"Temperatura Promedio Anual (°C)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[-2.2038356164383561,-1.6441095890410959,-1.7687671232876712,-1.0311475409836066,-1.9947945205479451,-1.715068493150685,-1.6706849315068493,-1.5724043715846994,-2.456986301369863,-2.4953424657534247,-0.78219178082191776,-1.8614754098360655,-1.4323287671232876,-1.7213698630136987,-2.2665753424657535,-1.8341530054644808,-2.3799999999999999,-1.296986301369863,-2.592876712328767,-0.44726775956284154,-0.17315068493150687,-1.6402739726027398,-1.2641095890410958,-1.2363387978142077,-2.142924528301887,-0.36575342465753424,-1.9328767123287671,-1.521584699453552,-1.3580821917808219,-0.92493150684931502,-1.789041095890411,-1.9540983606557376,-2.117808219178082,-1.0084931506849315,-0.3115068493150685,-1.8153005464480874,-0.62493150684931509,-0.94657534246575337,0.026849315068493151,-0.22158469945355194,-0.1115068493150685,-0.79671232876712339,-1.6191780821917809,-1.5404371584699454,-0.8167123287671233,-1.8065753424657534,-1.3578082191780823,-2.3587431693989069,-0.53178082191780818,-0.97178082191780824,-0.81452054794520545,-1.4838797814207652,-0.066301369863013701,-2.1041095890410961,-1.9027397260273973,-0.53934426229508203,-2.0408219178082194,-0.72328767123287674,-0.4397260273972603,-0.81748633879781418,-1.2318681318681319,-1.1449315068493151,-0.31863013698630138,-1.1819672131147541,-1.2621917808219179,-0.69863013698630139,0.50739726027397258,-0.22677595628415301,-0.60630136986301375,-0.62438356164383557,-0.55095890410958903,-1.0606557377049179,-0.40054794520547943,-0.69041095890410964,-0.16027397260273973,-2.0991803278688526,-0.96520547945205482,-1.0454794520547945,-0.70082191780821912,-0.42896174863387976,0.32246575342465755,-0.1613698630136986,-0.83534246575342463,0.014207650273224041,-0.80082191780821921,0.32958904109589043,-0.99835616438356167,-1.3904371584699453,0.11643835616438357,-0.36520547945205478,-0.59643835616438357,-0.1685792349726776,-0.49698630136986299,-0.067397260273972623,0.20958904109589041,-0.51612021857923496,-0.85698630136986298,0.085753424657534258,0.25342465753424659,-0.29781420765027322,-0.18191780821917811,-1.5197260273972604,0.7893150684931507,0.061475409836065573,-0.68493150684931503,0.26958904109589044,1.067945205479452,0.2565573770491803,0.52390109890109893,0.62383561643835617,0.50054794520547952,0.95901639344262302,-1.1883177570093457],"mode":"lines+markers","line":{"color":"blue","width":2},"marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="precipitacion" class="level2">
<h2 class="anchored" data-anchor-id="precipitacion">Precipitacion</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asegurar que la columna Fecha sea de tipo Date</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>data_precipitacion <span class="ot">&lt;-</span> data_precipitacion <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Fecha =</span> <span class="fu">as.Date</span>(Fecha))  <span class="co"># Asegurar formato correcto</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar columnas de Año y Mes y calcular la suma de precipitación por mes</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>sumaPorMesPrecip <span class="ot">&lt;-</span> data_precipitacion <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>), <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Mes) <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">PrecipitacionTotal =</span> <span class="fu">sum</span>(Precipitation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir Mes a numérico para graficar correctamente</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>sumaPorMesPrecip<span class="sc">$</span>Mes <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(sumaPorMesPrecip<span class="sc">$</span>Mes)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo con líneas de referencia</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>grafico_interactivo <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(sumaPorMesPrecip, </span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">x =</span> <span class="sc">~</span>Mes, <span class="at">y =</span> <span class="sc">~</span>PrecipitacionTotal, </span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'green'</span>, <span class="at">width =</span> <span class="dv">2</span>), </span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">title =</span> <span class="st">"Suma mensual de la precipitación"</span>,</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Mes"</span>, <span class="at">tickvals =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">ticktext =</span> month.abb),</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Precipitación Total (mm)"</span>),</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>),</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">hovermode =</span> <span class="st">"closest"</span>)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico interactivo</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>grafico_interactivo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f447ddecc0bd27ba62b3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f447ddecc0bd27ba62b3">{"x":{"visdat":{"7ed875ef1404":["function () ","plotlyVisDat"]},"cur_data":"7ed875ef1404","attrs":{"7ed875ef1404":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"green","width":2},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":50,"r":10},"title":"Suma mensual de la precipitación","xaxis":{"domain":[0,1],"automargin":true,"title":"Mes","tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"ticktext":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Precipitación Total (mm)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[21380.799999999999,19179.799999999999,20680.700000000001,21758.099999999999,20324.5,16666,14249.6,15210.4,15058.299999999999,20664.299999999999,23057.299999999999,22623.299999999999],"mode":"lines+markers","line":{"color":"green","width":2},"marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la columna Año y calcular la suma anual de precipitación</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>PrecipitationAnual <span class="ot">&lt;-</span> data_precipitacion <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Extraer el año de la fecha</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año) <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">PrecipitacionTotalAnual =</span> <span class="fu">sum</span>(Precipitation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>grafico_interactivo <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  PrecipitationAnual,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>Año,</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>PrecipitacionTotalAnual,</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'green'</span>, <span class="at">width =</span> <span class="dv">2</span>)</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución anual de la precipitación"</span>,</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Precipitación Total Anual (mm)"</span>),</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>, <span class="at">b =</span> <span class="dv">100</span>)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico interactivo</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>grafico_interactivo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-200b562f2aa1f99adb93" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-200b562f2aa1f99adb93">{"x":{"visdat":{"7ed82c92735":["function () ","plotlyVisDat"]},"cur_data":"7ed82c92735","attrs":{"7ed82c92735":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"green","width":2},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":100,"l":60,"t":50,"r":10},"title":"Evolución anual de la precipitación","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45,"type":"category","categoryorder":"array","categoryarray":["1901","1902","1903","1904","1905","1906","1907","1908","1909","1910","1911","1912","1913","1914","1915","1916","1917","1918","1919","1920","1921","1922","1923","1924","1925","1934","1935","1936","1937","1938","1939","1940","1941","1942","1943","1944","1945","1946","1947","1948","1949","1950","1951","1952","1953","1954","1955","1956","1957","1958","1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Precipitación Total Anual (mm)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["1901","1902","1903","1904","1905","1906","1907","1908","1909","1910","1911","1912","1913","1914","1915","1916","1917","1918","1919","1920","1921","1922","1923","1924","1925","1934","1935","1936","1937","1938","1939","1940","1941","1942","1943","1944","1945","1946","1947","1948","1949","1950","1951","1952","1953","1954","1955","1956","1957","1958","1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021"],"y":[1656.9000000000001,1367.5999999999999,1573.8,1219.2,1709.5999999999999,1332.5999999999999,1720.7,1217.3,1447.5999999999999,1856.5,1275.5999999999999,1551.7,1643.4000000000001,1907.2,1569.7,1705.2,1380.3,2126,1478.2,1904.4000000000001,1202.2,2420.6999999999998,2024.3,1744.3,980.79999999999995,2082.4000000000001,2762.9000000000001,2398.1999999999998,2539.8000000000002,1927.3,2490.8000000000002,2530.5,2201.4000000000001,1855.0999999999999,1980.4000000000001,2353,1970.3,1793.2,1996.5999999999999,1832.8,1406.9000000000001,1691.2,2094.8000000000002,2075,1656.5999999999999,1961.0999999999999,1987.8,1819.4000000000001,1757.7,2439.5,1790.3,2436.6999999999998,1712.5999999999999,1876.7,2100.0999999999999,1872.2,2576.5999999999999,2185.8000000000002,1659.7,2308,2076,2302.9000000000001,1714,2026.5999999999999,1950.0999999999999,2320.5999999999999,2069.4000000000001,1979.7,2810.6999999999998,2257.4000000000001,2317.0999999999999,2202,2605.5,2298.1999999999998,2346.9000000000001,2292.8000000000002,1963.7,2751.1999999999998,2500.6999999999998,2769.1999999999998,2063.8000000000002,2141.5999999999999,2011.9000000000001,2115.8000000000002,2261.0999999999999,2617.8000000000002,2836.1999999999998,2492.6999999999998,2268.4000000000001,2096.0999999999999,3103.1999999999998,2731,2218.9000000000001,3089.5,1945.4000000000001,2147,2053.1999999999998,2044.5,2513.3000000000002,2319.4000000000001,1811.4000000000001,2324.8000000000002,2243.8000000000002,2454.5999999999999,1856.2,1976.2,2132.5999999999999,2309.1999999999998,1998.5999999999999,2468.1999999999998,2324.9000000000001,1273.8,914.10000000000002],"mode":"lines+markers","line":{"color":"green","width":2},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="radiación" class="level2">
<h2 class="anchored" data-anchor-id="radiación">Radiación</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregar columnas de Año y Mes</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>data_radiacion <span class="ot">&lt;-</span> data_radiacion <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>), <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el promedio de radiación por mes</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>promedioPorMesRadiation <span class="ot">&lt;-</span> data_radiacion <span class="sc">%&gt;%</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Mes) <span class="sc">%&gt;%</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">RadiacionPromedio =</span> <span class="fu">mean</span>(Radiation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo con plotly</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>grafico_interactivo <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  promedioPorMesRadiation,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Mes),</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>RadiacionPromedio,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'orange'</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(promedioPorMesRadiation<span class="sc">$</span>RadiacionPromedio)),</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">'dash'</span>, <span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"Inicio temporada"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">9</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(promedioPorMesRadiation<span class="sc">$</span>RadiacionPromedio)),</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">'dash'</span>, <span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"Fin temporada"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Promedio mensual de la radiación"</span>,</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Mes"</span>, <span class="at">tickvals =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">ticktext =</span> month.abb),</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Radiación Promedio (W/m²)"</span>),</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>),</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico interactivo</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>grafico_interactivo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>A marker object has been specified, but markers is not in the mode
Adding markers to the mode...
A marker object has been specified, but markers is not in the mode
Adding markers to the mode...</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a98acff2477743c19bd7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a98acff2477743c19bd7">{"x":{"visdat":{"7ed85890fa1":["function () ","plotlyVisDat"]},"cur_data":"7ed85890fa1","attrs":{"7ed85890fa1":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"orange","width":2},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"7ed85890fa1.1":{"x":[3,3],"y":[0,213.11099224391549],"mode":"lines","line":{"color":"blue","width":1,"dash":"dash"},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"Inicio temporada","inherit":true},"7ed85890fa1.2":{"x":[9,9],"y":[0,213.11099224391549],"mode":"lines","line":{"color":"blue","width":1,"dash":"dash"},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"Fin temporada","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":50,"r":10},"title":"Promedio mensual de la radiación","xaxis":{"domain":[0,1],"automargin":true,"title":"Mes","tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"ticktext":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Radiación Promedio (W/m²)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[58.259761388286336,90.157625075346601,138.23996723996723,181.77574750830564,213.11099224391549,208.06522940851298,207.75701684041701,186.8738979428266,152.26709641255604,108.13296551724137,65.995403619649522,49.656147986942329],"mode":"lines+markers","line":{"color":"orange","width":2},"marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[3,3],"y":[0,213.11099224391549],"mode":"lines+markers","line":{"color":"blue","width":1,"dash":"dash"},"marker":{"color":"rgba(255,127,14,1)","size":5,"line":{"color":"rgba(255,127,14,1)"}},"type":"scatter","name":"Inicio temporada","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[9,9],"y":[0,213.11099224391549],"mode":"lines+markers","line":{"color":"blue","width":1,"dash":"dash"},"marker":{"color":"rgba(44,160,44,1)","size":5,"line":{"color":"rgba(44,160,44,1)"}},"type":"scatter","name":"Fin temporada","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el promedio anual de radiación</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>promedioPorAnioRadiation <span class="ot">&lt;-</span> data_radiacion <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">RadiacionPromedioAnual =</span> <span class="fu">mean</span>(Radiation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo con plotly</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>grafico_interactivo <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  promedioPorAnioRadiation,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año),</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>RadiacionPromedioAnual,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'orange'</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución anual de la radiación"</span>,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Radiación Promedio Anual (W/m²)"</span>),</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>),</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el gráfico interactivo</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>grafico_interactivo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-21286b872b8ead513e68" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-21286b872b8ead513e68">{"x":{"visdat":{"7ed821d86d8e":["function () ","plotlyVisDat"]},"cur_data":"7ed821d86d8e","attrs":{"7ed821d86d8e":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"orange","width":2},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":50,"r":10},"title":"Evolución anual de la radiación","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45},"yaxis":{"domain":[0,1],"automargin":true,"title":"Radiación Promedio Anual (W/m²)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[132.1068493150685,130.47945205479451,128.0904109589041,135.84699453551912,134.03835616438357,137.16712328767125,133.04383561643834,135.05191256830602,133.04383561643834,128.36712328767123,148.28493150684932,122.65027322404372,128.48767123287672,133.70410958904111,136.62191780821917,132.86612021857923,143.86301369863014,138.6904109589041,134.37808219178083,131.63934426229508,148.74246575342465,125.68767123287671,122.3013698630137,121.02459016393442,117.1041095890411,124.45205479452055,127.38356164383562,130.9071038251366,139.41643835616438,124.72328767123288,128.36438356164385,132.68579234972677,127.7972602739726,142.90684931506848,131.95890410958904,124.34699453551913,123.8958904109589,136.74520547945207,122.72054794520548,121.39890710382514,126.02191780821917,135.19452054794522,135.67671232876711,119.30601092896175,133.32054794520548,131.66849315068492,136.93424657534246,141.06830601092895,145.48493150684931,139.19999999999999,148.96712328767123,140.0136612021858,153.39178082191782,133.68493150684932,139.25205479452055,143.40437158469945,142.28493150684932,142.02739726027397,150.95068493150686,135.12841530054644,144.13972602739727,144.62191780821917,142.48493150684931,145.89890710382514,130.25479452054793,137.04383561643834,148.64383561643837,143.58743169398906,146.8931506849315,129.45479452054795,150.68493150684932,133.62021857923497,135.87671232876713,131.35890410958905,144.03287671232877,141.46721311475409,128.61643835616439,126.21643835616439,128.19452054794522,125.65027322404372,144.86645962732919,155.96677740863788,160.04626334519574,149.48396501457725,154.55485893416929,155.11988304093566,142.51479289940829,141.23837209302326,152.13352272727272,144.87356321839081,152.36079545454547,147.77197802197801,141.39385474860336,130.9689265536723,143.9971346704871,145.16666666666666,129.40555555555557,145.71671388101984,151.47214076246334,152.1432584269663,150.10955056179776,147.76123595505618,159.91712707182322,141.7068493150685,141.3072625698324,152.34349030470915,151.49579831932772,150.83241758241758,149.6098901098901,150.07162534435261,159.65205479452055,160.06887052341597,153.76470588235293,144.21917808219177,158.31955922865015,137.25210084033614,147.9325513196481,157.04285714285714,128.9607843137255,138.00824175824175,161.28870292887029],"mode":"lines+markers","line":{"color":"orange","width":2},"marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="profundidad-de-la-nieve" class="level2">
<h2 class="anchored" data-anchor-id="profundidad-de-la-nieve">Profundidad de la nieve</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Mes) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">DepthSnowPromedio =</span> <span class="fu">mean</span>(DepthSnow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Mes),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>DepthSnowPromedio,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'purple'</span>, <span class="at">width =</span> <span class="dv">2</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">7</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(datos_combinados<span class="sc">$</span>DepthSnow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">'dash'</span>, <span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"Inicio temporada"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_lines</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">11</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(datos_combinados<span class="sc">$</span>DepthSnow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)),</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">line =</span> <span class="fu">list</span>(<span class="at">dash =</span> <span class="st">'dash'</span>, <span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">1</span>), <span class="at">name =</span> <span class="st">"Fin temporada"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Promedio mensual de la profundidad de nieve"</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Mes"</span>, <span class="at">tickvals =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">ticktext =</span> month.abb),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Profundidad de Nieve Promedio (m)"</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-3e057a04c51890d52b5e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3e057a04c51890d52b5e">{"x":{"visdat":{"7ed84366aa6":["function () ","plotlyVisDat"]},"cur_data":"7ed84366aa6","attrs":{"7ed84366aa6":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"purple","width":2},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"7ed84366aa6.1":{"x":[7,7],"y":[0,8.1600000000000001],"mode":"lines","line":{"color":"blue","width":1,"dash":"dash"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"Inicio temporada","inherit":true},"7ed84366aa6.2":{"x":[11,11],"y":[0,8.1600000000000001],"mode":"lines","line":{"color":"blue","width":1,"dash":"dash"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","name":"Fin temporada","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Promedio mensual de la profundidad de nieve","xaxis":{"domain":[0,1],"automargin":true,"title":"Mes","tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"ticktext":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Profundidad de Nieve Promedio (m)"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[2.3950297513095662,3.2713526192337765,3.8180688775510205,3.9689742509609816,3.3204604477426174,1.8955068898133149,0.57446785291804336,0.096453512573720965,0.080527498555197807,0.21886603551588099,0.64630082109853348,1.4453712999482093],"mode":"lines+markers","line":{"color":"purple","width":2},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[7,7],"y":[0,8.1600000000000001],"mode":"lines","line":{"color":"blue","width":1,"dash":"dash"},"type":"scatter","name":"Inicio temporada","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[11,11],"y":[0,8.1600000000000001],"mode":"lines","line":{"color":"blue","width":1,"dash":"dash"},"type":"scatter","name":"Fin temporada","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la columna Año si no existe</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>)) <span class="co"># Extraer el año de la fecha</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Año) <span class="sc">%&gt;%</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">DepthSnowPromedioAnual =</span> <span class="fu">mean</span>(DepthSnow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año),</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>DepthSnowPromedioAnual,</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'purple'</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución anual de la profundidad de nieve"</span>,</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Profundidad de Nieve Promedio Anual (m)"</span>),</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-779ffe16d76319464324" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-779ffe16d76319464324">{"x":{"visdat":{"7ed868771e92":["function () ","plotlyVisDat"]},"cur_data":"7ed868771e92","attrs":{"7ed868771e92":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"purple","width":2},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución anual de la profundidad de nieve","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45},"yaxis":{"domain":[0,1],"automargin":true,"title":"Profundidad de Nieve Promedio Anual (m)"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[1.5282554945054945,1.0283138173302109,1.5775264187866926,0.6476203522504892,2.3016360078277884,2.0295530835284934,2.2391780821917808,1.4663033268101762,1.5647299412915852,1.9097970335675254,1.9873953033268101,1.701857142857143,1.2030821917808219,2.1166081186572989,1.8866771037181995,1.1953405088062623,1.0534442270058708,1.360936768149883,0.71926223091976516,1.2911624266144814,1.6923209393346379,2.1220999219359875,2.1269569471624266,1.056123287671233,1.6492876712328768,1.0028142076502733,1.0868356164383561,1.0062191780821919,0.91994520547945202,1.0903551912568306,0.88304109589041091,1.1353150684931508,1.0840821917808219,0.73133879781420763,1.8648767123287671,1.9532054794520548,2.7017808219178083,1.8348907103825136,1.0775068493150686,2.884164383561644,1.4066027397260275,0.80836065573770488,2.288849315068493,2.1430684931506851,1.8335890410958904,1.4304918032786886,2.0466849315068494,2.4807123287671233,1.9258082191780821,3.451311475409836,2.8353424657534245,2.9931780821917808,2.133232876712329,2.0579234972677596,1.7728493150684932,1.6213698630136986,2.6557534246575343,2.5271311475409837,1.5464931506849315,1.5434520547945205,1.6868767123287671,2.2714480874316938,1.8602465753424657,1.8613698630136986,2.8323561643835617,1.4273224043715846,1.8182191780821917,1.9316712328767123,3.3630684931506849,2.7114754098360656,1.7836712328767124,1.8361917808219177,1.7633424657534247,2.5505464480874318,1.9945205479452055,1.7061643835616438,1.4785479452054795,2.4327868852459016,1.7563287671232877,1.8767123287671232,1.4207397260273973,2.7630601092896176,2.4674246575342464,1.1482191780821918,1.6521095890410959,1.8076502732240438,1.2752472527472527,2.1386703601108032,2.2528246753246752,1.5063636363636363,2.9652500000000002],"mode":"lines+markers","line":{"color":"purple","width":2},"marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="union-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="union-de-los-datos">Union de los datos</h2>
<p>Se pasan todas las columnas a la tabla “datos_combinados”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se Combina las tablas utilizando joins de dplyr</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar Temperature</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_temperatura <span class="sc">%&gt;%</span> <span class="fu">select</span>(Fecha, Temperature), <span class="at">by =</span> <span class="st">"Fecha"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar Precipitation</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_precipitacion <span class="sc">%&gt;%</span> <span class="fu">select</span>(Fecha, Precipitation), <span class="at">by =</span> <span class="st">"Fecha"</span>)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Combinar Radiation</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_radiacion <span class="sc">%&gt;%</span> <span class="fu">select</span>(Fecha, Radiation), <span class="at">by =</span> <span class="st">"Fecha"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Antes de 01/01/1934 No hay datos de Temperatura y precipitacion, por ello se empieza desde 1934</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar las fechas entre 1934-01-01 y 2021-08-02</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Fecha <span class="sc">&gt;=</span> <span class="fu">as.Date</span>(<span class="st">"1934-01-01"</span>) <span class="sc">&amp;</span> Fecha <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">"2021-08-02"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rellenar-datos-faltantes" class="level2">
<h2 class="anchored" data-anchor-id="rellenar-datos-faltantes">Rellenar datos faltantes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(datos_combinados))  <span class="co"># Contar valores NA por columna</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Fecha     DepthSnow           Año   Temperature Precipitation 
            0             0             0             2           108 
    Radiation 
          592 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>datos_combinados[<span class="sc">!</span><span class="fu">complete.cases</span>(datos_combinados),] <span class="co"># se mira los datos faltantes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Fecha DepthSnow  Año Temperature Precipitation Radiation
13118 1969-11-30      2.00 1969          NA           0.0        39
17175 1981-01-08      4.30 1981       -16.4           0.0        NA
17188 1981-01-21      5.30 1981       -12.6           0.0        NA
17189 1981-01-22      5.30 1981        -8.7           0.0        NA
17190 1981-01-23      5.30 1981        -4.0           0.0        NA
17191 1981-01-24      5.30 1981        -1.3           0.0        NA
17194 1981-01-27      5.35 1981        -6.8           0.0        NA
17195 1981-01-28      5.35 1981        -3.4           0.0        NA
17196 1981-01-29      5.30 1981        -6.3           0.0        NA
17197 1981-01-30      5.30 1981        -4.7           0.0        NA
17198 1981-01-31      5.20 1981        -1.6           0.0        NA
17199 1981-02-01      5.10 1981        -1.8           0.0        NA
17200 1981-02-02      5.10 1981        -1.8           0.0        NA
17206 1981-02-08      5.41 1981        -1.2           0.0        NA
17207 1981-02-09      5.40 1981        -0.5           0.0        NA
17210 1981-02-12      5.40 1981       -11.4           0.0        NA
17211 1981-02-13      5.40 1981       -10.5           0.0        NA
17212 1981-02-14      5.40 1981        -5.0           0.0        NA
17213 1981-02-15      5.40 1981        -3.6           0.0        NA
17214 1981-02-16      5.40 1981        -2.8           0.0        NA
17215 1981-02-17      5.40 1981        -7.8           0.6        NA
17216 1981-02-18      5.40 1981       -14.3           1.4        NA
17218 1981-02-20      5.40 1981       -11.5           0.0        NA
17220 1981-02-22      5.40 1981       -12.1           1.1        NA
17221 1981-02-23      5.40 1981       -12.1           0.3        NA
17222 1981-02-24      5.40 1981       -10.3           4.2        NA
17223 1981-02-25      5.40 1981        -9.1           0.0        NA
17224 1981-02-26      5.40 1981        -9.9           0.0        NA
17225 1981-02-27      5.40 1981       -10.6           1.8        NA
17245 1981-03-19      6.10 1981        -7.9           0.0        NA
17253 1981-03-27      5.50 1981         1.0           0.0        NA
17416 1981-09-06      0.00 1981         7.5           0.0        NA
17431 1981-09-21      0.00 1981         6.6           2.0        NA
17441 1981-10-01      0.45 1981         2.5          10.2        NA
17448 1981-10-08      0.15 1981         5.2           0.0        NA
17469 1981-10-29      0.80 1981        -1.9           0.0        NA
17474 1981-11-03      0.45 1981         6.8           0.0        NA
17475 1981-11-04      0.35 1981         4.9           0.0        NA
17477 1981-11-06      0.20 1981        -2.0           0.0        NA
17487 1981-11-16      0.65 1981        -6.3           0.0        NA
17488 1981-11-17      0.65 1981        -2.8           0.0        NA
17492 1981-11-21      0.60 1981         0.0           0.0        NA
17494 1981-11-23      0.50 1981         1.0           3.4        NA
17521 1981-12-20      3.75 1981       -11.3           1.5        NA
17545 1982-01-13      5.15 1982        -7.9           0.0        NA
17546 1982-01-14      5.15 1982        -8.5           2.8        NA
17549 1982-01-17      5.00 1982        -5.8           0.0        NA
17550 1982-01-18      4.90 1982        -4.6           0.0        NA
17551 1982-01-19      4.85 1982        -4.6           0.0        NA
17552 1982-01-20      4.80 1982        -6.2           0.0        NA
17557 1982-01-25      4.85 1982       -11.7           0.0        NA
17560 1982-01-28      5.05 1982       -10.4           0.1        NA
17565 1982-02-02      5.30 1982        -5.2           0.0        NA
17566 1982-02-03      5.20 1982        -7.1           0.0        NA
17568 1982-02-05      5.20 1982        -5.1           0.0        NA
17576 1982-02-13      5.20 1982        -4.8           0.0        NA
17584 1982-02-21      5.20 1982       -12.4           0.0        NA
17585 1982-02-22      5.20 1982       -12.4           0.2        NA
17589 1982-02-26      5.22 1982       -17.1           0.8        NA
17590 1982-02-27      5.20 1982        -8.7           0.0        NA
17606 1982-03-15      6.20 1982        -8.6           0.0        NA
17615 1982-03-24      7.00 1982        -9.3           0.0        NA
17617 1982-03-26      7.00 1982        -4.1           0.0        NA
17623 1982-04-01      6.85 1982        -5.4           0.0        NA
17663 1982-05-11      6.60 1982        -0.7           0.0        NA
17722 1982-07-09      2.35 1982        13.7           0.0        NA
17724 1982-07-11      2.25 1982        13.2           0.0        NA
17732 1982-07-19      1.30 1982        10.2           0.2        NA
17767 1982-08-23      0.00 1982         6.6           0.0        NA
17774 1982-08-30      0.00 1982         6.4           0.0        NA
17777 1982-09-02      0.05 1982         5.8           0.0        NA
17778 1982-09-03      0.00 1982         8.9           0.0        NA
17784 1982-09-09      0.00 1982         7.1           0.0        NA
17789 1982-09-14      0.00 1982         7.9           0.0        NA
17790 1982-09-15      0.00 1982         8.5           0.0        NA
17794 1982-09-19      0.00 1982         8.1           0.0        NA
17802 1982-09-27      0.05 1982         4.6           0.0        NA
17804 1982-09-29      0.00 1982         4.1           4.0        NA
17812 1982-10-07      0.14 1982        -4.4           3.7        NA
17821 1982-10-16      0.25 1982        -3.5           0.4        NA
17823 1982-10-18      0.25 1982        -1.8          10.3        NA
17825 1982-10-20      0.20 1982         3.1           0.0        NA
17826 1982-10-21      0.20 1982         1.2           0.0        NA
17831 1982-10-26      0.10 1982        -1.5           0.0        NA
17833 1982-10-28      0.10 1982         0.5           0.0        NA
17834 1982-10-29      0.05 1982         2.6           0.0        NA
17835 1982-10-30      0.05 1982         1.8           0.0        NA
17836 1982-10-31      0.05 1982         1.3           0.0        NA
17837 1982-11-01      0.05 1982         3.6           0.0        NA
17839 1982-11-03      0.05 1982         1.8           0.0        NA
17840 1982-11-04      0.05 1982         0.1           0.0        NA
17841 1982-11-05      0.05 1982         0.0           0.0        NA
17842 1982-11-06      0.05 1982        -4.8           0.1        NA
17848 1982-11-12      0.10 1982        -2.2          16.1        NA
17852 1982-11-16      0.40 1982        -9.2           5.0        NA
17856 1982-11-20      0.50 1982        -3.4           0.0        NA
17857 1982-11-21      0.50 1982        -4.3           0.0        NA
17858 1982-11-22      0.50 1982        -5.3           0.0        NA
17861 1982-11-25      0.40 1982        -5.0           5.8        NA
17866 1982-11-30      0.40 1982        -2.1           9.0        NA
17867 1982-12-01      0.40 1982        -2.1           4.6        NA
17870 1982-12-04      0.40 1982        -3.3           0.3        NA
17871 1982-12-05      0.40 1982        -3.6           0.0        NA
17888 1982-12-22      0.95 1982       -14.0           0.2        NA
17890 1982-12-24      1.00 1982       -13.8           0.4        NA
17892 1982-12-26      1.00 1982        -6.4           0.0        NA
17893 1982-12-27      1.00 1982        -4.1           0.0        NA
17896 1982-12-30      1.35 1982        -5.0           0.0        NA
17903 1983-01-06      1.55 1983         3.0           0.0        NA
17906 1983-01-09      1.65 1983        -5.5           0.0        NA
17907 1983-01-10      1.65 1983        -2.8           0.0        NA
17908 1983-01-11      1.65 1983         0.1           0.0        NA
17909 1983-01-12      1.60 1983        -1.0           0.0        NA
17915 1983-01-18      2.40 1983         1.6           1.1        NA
17919 1983-01-22      3.25 1983        -2.3           0.0        NA
17920 1983-01-23      3.25 1983        -1.2           0.0        NA
17921 1983-01-24      3.20 1983        -1.2           0.0        NA
17932 1983-02-04      3.50 1983       -12.3           5.0        NA
17940 1983-02-12      3.80 1983       -14.8           0.1        NA
17943 1983-02-15      3.80 1983       -10.2           0.0        NA
17944 1983-02-16      3.80 1983       -12.6           0.0        NA
17945 1983-02-17      3.80 1983        -7.5           0.0        NA
17946 1983-02-18      3.80 1983        -8.9           0.0        NA
17947 1983-02-19      3.80 1983        -6.0           0.0        NA
17948 1983-02-20      3.80 1983        -6.9           0.0        NA
17949 1983-02-21      3.80 1983        -8.0           0.0        NA
17950 1983-02-22      3.80 1983        -7.4           0.0        NA
17951 1983-02-23      3.80 1983        -8.4           0.0        NA
17952 1983-02-24      3.80 1983        -5.7           0.0        NA
17959 1983-03-03      4.10 1983        -7.1           0.0        NA
17960 1983-03-04      4.10 1983        -5.0           0.0        NA
17961 1983-03-05      4.10 1983        -4.9           0.0        NA
17962 1983-03-06      4.10 1983        -3.3           0.0        NA
17964 1983-03-08      4.10 1983         0.9           0.0        NA
17965 1983-03-09      4.00 1983        -0.8           0.0        NA
17966 1983-03-10      4.00 1983        -0.8           0.0        NA
17967 1983-03-11      4.00 1983        -2.3           0.0        NA
17968 1983-03-12      4.00 1983        -1.3           0.0        NA
17969 1983-03-13      4.00 1983        -1.2           0.0        NA
17973 1983-03-17      4.05 1983        -3.5           0.0        NA
17976 1983-03-20      4.15 1983         0.3           0.0        NA
17983 1983-03-27      4.45 1983       -11.0           2.1        NA
18003 1983-04-16      5.80 1983        -0.4           0.0        NA
18006 1983-04-19      5.70 1983        -3.6          13.7        NA
18034 1983-05-17      4.65 1983        -1.3           6.8        NA
18055 1983-06-07      4.00 1983         8.0           0.0        NA
18056 1983-06-08      3.90 1983         8.6           0.0        NA
18148 1983-09-08      0.00 1983         9.4           0.3        NA
18159 1983-09-19      0.10 1983         8.4           0.0        NA
18163 1983-09-23      0.00 1983         9.9           0.0        NA
18164 1983-09-24      0.00 1983        10.8           0.0        NA
18166 1983-09-26      0.00 1983        10.3           0.0        NA
18167 1983-09-27      0.00 1983        10.1           0.0        NA
18168 1983-09-28      0.00 1983         8.9           0.0        NA
18174 1983-10-04      0.00 1983         9.5           0.0        NA
18175 1983-10-05      0.00 1983         8.3           0.0        NA
18180 1983-10-10      0.03 1983         6.9           0.0        NA
18183 1983-10-13      0.05 1983         2.1           0.0        NA
18192 1983-10-22      0.10 1983        -2.8           3.4        NA
18193 1983-10-23      0.10 1983        -2.1           0.0        NA
18194 1983-10-24      0.10 1983        -1.2           0.0        NA
18195 1983-10-25      0.10 1983        -0.2           0.0        NA
18197 1983-10-27      0.05 1983         4.8           0.0        NA
18198 1983-10-28      0.05 1983         1.1           0.0        NA
18199 1983-10-29      0.05 1983        -0.2           9.6        NA
18202 1983-11-01      0.05 1983         0.4           0.0        NA
18203 1983-11-02      0.05 1983         2.8           0.0        NA
18204 1983-11-03      0.05 1983        -0.2           0.6        NA
18207 1983-11-06      0.05 1983         0.2           0.0        NA
18208 1983-11-07      0.05 1983        -1.9           0.0        NA
18209 1983-11-08      0.05 1983         0.4           0.0        NA
18210 1983-11-09      0.05 1983         2.9           0.0        NA
18211 1983-11-10      0.05 1983         2.0           0.0        NA
18212 1983-11-11      0.00 1983         0.9           0.0        NA
18213 1983-11-12      0.00 1983         0.5           0.0        NA
18214 1983-11-13      0.00 1983        -1.9           0.0        NA
18216 1983-11-15      0.00 1983        -4.6           0.0        NA
18217 1983-11-16      0.00 1983        -2.8           0.0        NA
18218 1983-11-17      0.00 1983        -2.8           0.0        NA
18219 1983-11-18      0.00 1983        -4.1           0.0        NA
18220 1983-11-19      0.00 1983         0.6           0.0        NA
18221 1983-11-20      0.00 1983         0.7           0.0        NA
18223 1983-11-22      0.00 1983        -1.9           0.0        NA
18225 1983-11-24      0.00 1983        -0.7           4.6        NA
18232 1983-12-01      0.70 1983       -11.4           0.0        NA
18233 1983-12-02      0.70 1983        -6.9           0.0        NA
18235 1983-12-04      0.70 1983        -4.8           0.0        NA
18236 1983-12-05      0.70 1983        -3.9           0.0        NA
18245 1983-12-14      1.30 1983        -7.7           0.0        NA
18246 1983-12-15      1.20 1983        -7.7           0.2        NA
18251 1983-12-20      1.15 1983        -6.3           2.2        NA
18258 1983-12-27      1.30 1983        -5.1           0.0        NA
18273 1984-01-11      1.90 1984        -6.5           0.0        NA
18289 1984-01-27      2.80 1984       -10.3           2.8        NA
18303 1984-02-10      4.50 1984       -13.5           0.1        NA
18305 1984-02-12      4.75 1984        -9.9           0.6        NA
18526 1984-09-20      0.15 1984         5.5           0.0        NA
18550 1984-10-14      0.20 1984         5.8           0.0        NA
18551 1984-10-15      0.20 1984         4.9           0.0        NA
18552 1984-10-16      0.20 1984         5.3           0.0        NA
18553 1984-10-17      0.20 1984         2.6           0.0        NA
18554 1984-10-18      0.20 1984        -1.2           0.0        NA
18555 1984-10-19      0.15 1984        -1.4          12.5        NA
18564 1984-10-28      0.15 1984        -0.5           0.0        NA
18565 1984-10-29      0.10 1984         2.8           0.0        NA
18567 1984-10-31      0.10 1984         4.6           0.0        NA
18568 1984-11-01      0.10 1984         5.2           0.0        NA
18569 1984-11-02      0.10 1984         2.2           0.0        NA
18571 1984-11-04      0.10 1984        -3.9           0.0        NA
18594 1984-11-27      0.35 1984        -6.8           0.0        NA
18600 1984-12-03      0.25 1984        -4.1           0.9        NA
18603 1984-12-06      0.25 1984        -1.3           0.0        NA
18605 1984-12-08      0.20 1984        -2.8           0.0        NA
18627 1984-12-30      0.75 1984       -11.5           0.6        NA
18628 1984-12-31      0.85 1984       -16.1           0.0        NA
18634 1985-01-06      1.80 1985       -23.7           0.0        NA
18636 1985-01-08      1.80 1985       -23.7           0.2        NA
18637 1985-01-09      1.80 1985       -22.7           0.0        NA
18639 1985-01-11      1.80 1985       -16.7           0.0        NA
18663 1985-02-04      2.45 1985         0.6           0.0        NA
18671 1985-02-12      2.70 1985       -10.1           0.1        NA
18675 1985-02-16      3.00 1985        -9.2          28.2        NA
18677 1985-02-18      2.90 1985       -10.4           0.1        NA
18679 1985-02-20      2.90 1985        -9.2           0.0        NA
18680 1985-02-21      2.90 1985        -8.2           0.0        NA
18681 1985-02-22      2.90 1985        -9.9           0.0        NA
18682 1985-02-23      2.90 1985        -7.4           0.0        NA
18690 1985-03-03      2.95 1985        -7.1           0.0        NA
18700 1985-03-13      2.80 1985        -6.9           0.0        NA
18701 1985-03-14      2.80 1985        -8.0           1.7        NA
18706 1985-03-19      4.30 1985       -13.5           0.0        NA
18707 1985-03-20      4.30 1985       -12.3           0.5        NA
18712 1985-03-25      4.00 1985        -6.9           6.1        NA
18721 1985-04-03      3.90 1985         1.5           0.0        NA
18737 1985-04-19      3.95 1985        -1.6           0.0        NA
18812 1985-07-03      2.70 1985        11.4           0.0        NA
18869 1985-08-29      0.15 1985         8.0           0.0        NA
18870 1985-08-30      0.10 1985         9.8           0.0        NA
18878 1985-09-07      0.00 1985         5.5           0.0        NA
18881 1985-09-10      0.00 1985         6.2           0.0        NA
18900 1985-09-29      0.00 1985         9.4           0.0        NA
18901 1985-09-30      0.00 1985         9.4           0.0        NA
18918 1985-10-17      0.00 1985         2.7           0.0        NA
18921 1985-10-20      0.00 1985        -0.1           0.0        NA
18922 1985-10-21      0.00 1985        -1.0           0.0        NA
18923 1985-10-22      0.00 1985         1.0           0.0        NA
18924 1985-10-23      0.00 1985         1.8           0.0        NA
18925 1985-10-24      0.00 1985        -1.6           0.0        NA
18926 1985-10-25      0.00 1985        -2.2           0.0        NA
18927 1985-10-26      0.00 1985        -0.9           0.0        NA
18928 1985-10-27      0.00 1985         1.5           0.0        NA
18929 1985-10-28      0.00 1985         1.7           0.0        NA
18936 1985-11-04      0.10 1985        -4.5          16.1        NA
18947 1985-11-15      0.90 1985        -7.6           0.0        NA
18948 1985-11-16      0.90 1985        -9.2           0.0        NA
18951 1985-11-19      0.90 1985       -12.3           4.6        NA
18956 1985-11-24      0.90 1985        -8.5           0.0        NA
18957 1985-11-25      0.80 1985       -10.5           0.0        NA
18958 1985-11-26      0.80 1985       -10.0           0.0        NA
18959 1985-11-27      0.75 1985       -11.8           0.0        NA
18973 1985-12-11      0.45 1985        -7.9           0.0        NA
19000 1986-01-07      0.55 1986        -9.6           0.0        NA
19027 1986-02-03      3.40 1986        -9.3           0.8        NA
19036 1986-02-12      3.30 1986       -12.5           0.0        NA
19037 1986-02-13      3.20 1986       -13.8           0.0        NA
19044 1986-02-20      3.10 1986       -13.1           0.0        NA
19045 1986-02-21      3.10 1986       -12.0           0.0        NA
19046 1986-02-22      3.10 1986        -8.4           7.8        NA
19049 1986-02-25      3.25 1986       -11.5           0.0        NA
19050 1986-02-26      3.25 1986       -10.4           0.0        NA
19056 1986-03-04      3.05 1986        -7.9           0.0        NA
19067 1986-03-15      2.90 1986        -6.5           0.0        NA
19258 1986-09-22      0.00 1986         7.2           0.0        NA
19275 1986-10-09      0.00 1986         5.2           0.0        NA
19296 1986-10-30      0.45 1986         0.0           0.0        NA
19300 1986-11-03      0.70 1986        -6.7           0.3        NA
19305 1986-11-08      0.50 1986         1.7           0.0        NA
19307 1986-11-10      0.40 1986        -0.7           0.0        NA
19308 1986-11-11      0.30 1986        -3.4           0.0        NA
19321 1986-11-24      0.55 1986        -8.8           0.2        NA
19325 1986-11-28      0.50 1986        -2.8           0.0        NA
19326 1986-11-29      0.50 1986        -8.9           0.0        NA
19327 1986-11-30      0.50 1986        -0.4           0.0        NA
19328 1986-12-01      0.40 1986        -1.0           0.0        NA
19366 1987-01-08      3.70 1987       -17.1           0.1        NA
19370 1987-01-12      3.74 1987       -23.0           0.5        NA
19379 1987-01-21      3.70 1987        -6.1           0.0        NA
19387 1987-01-29      3.80 1987        -6.2           0.0        NA
19389 1987-01-31      3.80 1987        -6.2           0.0        NA
19390 1987-02-01      3.70 1987        -6.6           0.0        NA
19424 1987-03-07      4.70 1987        -9.8           0.0        NA
19425 1987-03-08      4.70 1987        -7.0           0.2        NA
19426 1987-03-09      4.70 1987        -8.2           0.1        NA
19427 1987-03-10      4.60 1987        -8.2           0.0        NA
19428 1987-03-11      4.50 1987        -9.9           0.0        NA
19429 1987-03-12      4.50 1987       -10.5           0.0        NA
19438 1987-03-21      5.15 1987       -13.7           3.5        NA
19630 1987-09-29      0.00 1987         0.8           0.0        NA
19631 1987-09-30      0.00 1987        -0.6           0.0        NA
19649 1987-10-18      0.12 1987         1.7           0.0        NA
19650 1987-10-19      0.10 1987         1.3           0.0        NA
19661 1987-10-30      0.00 1987         1.2           0.1        NA
19665 1987-11-03      0.03 1987        -1.3           0.0        NA
19666 1987-11-04      0.03 1987         2.0           0.0        NA
19667 1987-11-05      0.02 1987         2.5           0.0        NA
19668 1987-11-06      0.02 1987         3.1           0.0        NA
19669 1987-11-07      0.01 1987         3.4           0.0        NA
19670 1987-11-08      0.01 1987         1.5           0.0        NA
19677 1987-11-15      0.20 1987        -8.5           2.0        NA
19687 1987-11-25      1.10 1987        -7.8           6.4        NA
19702 1987-12-10      0.90 1987        -9.1           0.0        NA
19767 1988-02-13      2.40 1988       -11.6           0.0        NA
19769 1988-02-15      2.35 1988        -3.7           0.0        NA
19770 1988-02-16      2.25 1988        -1.6           0.0        NA
19775 1988-02-21      2.65 1988        -7.9           0.0        NA
19819 1988-04-05      7.50 1988        -3.6           1.7        NA
19828 1988-04-14      7.10 1988        -2.1           0.0        NA
20018 1988-10-21      0.04 1988        -0.5           0.0        NA
20027 1988-10-30      0.00 1988        -0.2           0.0        NA
20028 1988-10-31      0.00 1988        -1.1           0.0        NA
20029 1988-11-01      0.00 1988         2.1           0.0        NA
20031 1988-11-03      0.05 1988        -3.1           0.0        NA
20032 1988-11-04      0.05 1988        -5.7           0.0        NA
20033 1988-11-05      0.03 1988        -1.8           0.0        NA
20034 1988-11-06      0.02 1988         1.0           0.0        NA
20035 1988-11-07      0.02 1988         2.1           0.0        NA
20036 1988-11-08      0.02 1988         1.3           0.6        NA
20045 1988-11-17      0.15 1988         1.5           0.0        NA
20050 1988-11-22      1.00 1988       -19.9           0.4        NA
20052 1988-11-24      1.00 1988        -8.6           0.0        NA
20054 1988-11-26      0.98 1988        -2.6           0.0        NA
20055 1988-11-27      0.96 1988        -3.1           0.0        NA
20083 1988-12-25      2.90 1988         0.1           0.0        NA
20112 1989-01-23      2.25 1989        -7.4           0.0        NA
20130 1989-02-10      1.80 1989        -4.3           0.0        NA
20167 1989-03-19      3.12 1989        -6.0           0.0        NA
20363 1989-10-01      0.05 1989         6.3           0.0        NA
20364 1989-10-02      0.05 1989         5.1           0.0        NA
20366 1989-10-04      0.05 1989         3.0           0.0        NA
20367 1989-10-05      0.00 1989         5.2           0.0        NA
20406 1989-11-13      0.60 1989        -0.2           0.0        NA
20409 1989-11-16      0.50 1989        -4.6           0.0        NA
20410 1989-11-17      0.45 1989        -7.9           0.0        NA
20416 1989-11-23      0.40 1989        -6.6           0.0        NA
20422 1989-11-29      0.35 1989        -7.9           0.0        NA
20430 1989-12-07      0.30 1989        -2.5           0.0        NA
20517 1990-03-04      3.46 1990        -7.1           0.0        NA
20732 1990-10-05      0.02 1990         2.0           0.0        NA
20738 1990-10-11      0.01 1990         6.9           1.4        NA
20749 1990-10-22      0.00 1990         0.6           0.0        NA
20764 1990-11-06      0.80 1990       -10.5           0.0        NA
20765 1990-11-07      0.75 1990        -6.1           0.1        NA
20766 1990-11-08      0.75 1990        -0.4           0.0        NA
20767 1990-11-09      0.75 1990        -1.6           0.0        NA
20770 1990-11-12      0.95 1990        -2.8           0.0        NA
20771 1990-11-13      0.90 1990        -0.4           0.0        NA
20787 1990-11-29      1.30 1990        -9.8           0.0        NA
20794 1990-12-06      1.95 1990       -10.3           0.0        NA
20795 1990-12-07      1.90 1990        -5.2           0.0        NA
20799 1990-12-11      1.82 1990       -11.5           1.2        NA
20802 1990-12-14      2.10 1990        -9.6           0.0        NA
20805 1990-12-17      2.00 1990       -10.8           0.1        NA
20816 1990-12-28      2.00 1990        -8.3           0.9        NA
20835 1991-01-16      2.70 1991       -10.6           0.0        NA
20839 1991-01-20      2.70 1991        -7.6           0.0        NA
20842 1991-01-23      2.70 1991        -7.1           0.0        NA
20843 1991-01-24      2.70 1991        -5.8           0.0        NA
20847 1991-01-28      2.70 1991        -6.0           0.0        NA
20851 1991-02-01      2.70 1991       -12.1           0.0        NA
20852 1991-02-02      2.70 1991       -11.5           0.0        NA
20867 1991-02-17      3.10 1991        -8.9           0.4        NA
20869 1991-02-19      3.10 1991        -5.7           0.0        NA
20890 1991-03-12      2.70 1991        -3.9           0.0        NA
20892 1991-03-14      2.60 1991        -4.0           0.0        NA
20894 1991-03-16      2.60 1991        -4.1           0.0        NA
21169 1991-12-16      0.80 1991        -8.2           0.0        NA
21190 1992-01-06      2.45 1992         1.0           0.0        NA
21496 1992-11-07      0.80 1992         5.2           0.0        NA
21559 1993-01-09      2.55 1993        -3.3           0.0        NA
21596 1993-02-15      2.70 1993        -6.3           0.0        NA
21599 1993-02-18      2.78 1993        -5.0           0.0        NA
21617 1993-03-08      4.10 1993        -8.3           0.0        NA
21619 1993-03-10      4.00 1993        -6.8           0.0        NA
21638 1993-03-29      4.95 1993       -11.3           0.0        NA
21692 1993-05-22      3.54 1993         2.1           0.0        NA
22194 1994-10-06      0.11 1994        -0.9           0.0        NA
22198 1994-10-10      0.10 1994         5.3           0.0        NA
22199 1994-10-11      0.07 1994         5.7           0.2        NA
22201 1994-10-13      0.03 1994         6.7           0.0        NA
22202 1994-10-14      0.02 1994         5.2           0.0        NA
22203 1994-10-15      0.00 1994         4.8           0.0        NA
22205 1994-10-17      0.00 1994         4.3           0.0        NA
22206 1994-10-18      0.00 1994         1.6           0.0        NA
22215 1994-10-27      0.17 1994        -3.7           8.5        NA
22217 1994-10-29      0.20 1994        -3.5           0.5        NA
22249 1994-11-30      0.20 1994        -3.2           0.0        NA
22284 1995-01-04      2.25 1995       -17.8           0.0        NA
22288 1995-01-08      2.25 1995       -11.5           0.0        NA
22296 1995-01-16      3.10 1995        -5.2           0.0        NA
22297 1995-01-17      3.00 1995        -6.3           0.0        NA
22311 1995-01-31      3.90 1995        -5.7           0.0        NA
22352 1995-03-13      5.20 1995        -7.1           0.1        NA
22361 1995-03-22      5.70 1995        -9.1           0.0        NA
22373 1995-04-03      6.05 1995         2.6           0.0        NA
22573 1995-10-20      0.00 1995         5.4           0.0        NA
22574 1995-10-21      0.00 1995         3.8           0.0        NA
22575 1995-10-22      0.00 1995         0.5           0.0        NA
22576 1995-10-23      0.00 1995         0.8           0.0        NA
22577 1995-10-24      0.00 1995         2.0           0.0        NA
22605 1995-11-21      1.30 1995        -3.2           0.1        NA
22618 1995-12-04      1.20 1995       -10.1           0.0        NA
22619 1995-12-05      1.18 1995       -12.7           0.0        NA
22649 1996-01-04      2.35 1996        -2.5           0.0        NA
22662 1996-01-17      2.05 1996        -5.1           0.0        NA
22675 1996-01-30      1.95 1996        -5.7           0.0        NA
22676 1996-01-31      1.93 1996       -10.5           2.7        NA
22681 1996-02-05      1.90 1996       -14.6           0.3        NA
22682 1996-02-06      1.90 1996       -14.7           2.0        NA
22685 1996-02-09      2.30 1996       -11.0           0.1        NA
22699 1996-02-23      3.10 1996       -13.9           2.4        NA
22700 1996-02-24      3.10 1996        -9.8           0.0        NA
22705 1996-02-29      2.85 1996        -5.5           0.0        NA
22710 1996-03-05      2.90 1996       -12.1           0.0        NA
22711 1996-03-06      2.90 1996        -8.1           0.0        NA
22713 1996-03-08      2.85 1996       -11.6           0.1        NA
22714 1996-03-09      2.80 1996        -7.9           0.0        NA
22715 1996-03-10      2.75 1996       -10.3           0.0        NA
22733 1996-03-28      2.93 1996        -7.4           0.0        NA
22984 1996-12-04      3.10 1996       -10.0           0.0        NA
23006 1996-12-26      2.50 1996       -13.5           0.0        NA
23048 1997-02-06      2.20 1997        -6.5           0.0        NA
23092 1997-03-22      3.80 1997        -4.9           0.0        NA
23108 1997-04-07      4.35 1997        -2.2           0.0        NA
23109 1997-04-08      4.30 1997        -3.3           0.0        NA
23334 1997-11-19      0.12 1997        -4.6           0.5        NA
23433 1998-02-26      2.55 1998        -1.5           0.0        NA
23434 1998-02-27      2.50 1998         0.4           0.0        NA
23445 1998-03-10      3.45 1998       -13.6           0.0        NA
23453 1998-03-18      4.35 1998        -0.4           0.0        NA
23460 1998-03-25      4.50 1998        -7.0           0.0        NA
23461 1998-03-26      4.50 1998        -5.4           0.0        NA
23638 1998-09-19      0.80 1998         6.0           0.0        NA
23640 1998-09-21      0.65 1998         3.6           0.0        NA
23658 1998-10-09      0.08 1998        -1.4           0.1        NA
23686 1998-11-06      1.15 1998        -5.8           0.0        NA
23698 1998-11-18      1.75 1998       -12.3           0.0        NA
23701 1998-11-21      1.85 1998       -16.3           0.0        NA
23784 1999-02-12      5.70 1999       -20.2           0.0        NA
23787 1999-02-15      5.70 1999       -10.5           0.0        NA
23797 1999-02-25      7.35 1999        -5.9           0.0        NA
23798 1999-02-26      7.35 1999        -1.7           0.1        NA
23817 1999-03-17      7.40 1999        -4.8           0.0        NA
23818 1999-03-18      7.20 1999        -7.1           0.0        NA
23824 1999-03-24      7.35 1999        -2.3           0.0        NA
23915 1999-06-23      4.35 1999         5.4           0.0        NA
23946 1999-07-24      1.90 1999         7.0           0.0        NA
23997 1999-09-13      0.00 1999         9.5           0.0        NA
23998 1999-09-14      0.00 1999         7.3           0.0        NA
24021 1999-10-07      0.40 1999        -0.5           0.0        NA
24025 1999-10-11      0.20 1999         5.2           0.0        NA
24028 1999-10-14      0.10 1999         4.2           0.0        NA
24030 1999-10-16      0.10 1999         2.2           0.0        NA
24031 1999-10-17      0.10 1999         0.4           0.0        NA
24032 1999-10-18      0.05 1999        -2.3           3.6        NA
24041 1999-10-27      0.01 1999         4.1           0.0        NA
24046 1999-11-01      0.00 1999         2.0           0.0        NA
24057 1999-11-12      0.70 1999        -6.0           0.1        NA
24060 1999-11-15      0.62 1999        -6.6           0.2        NA
24065 1999-11-20      1.15 1999       -14.7           0.2        NA
24070 1999-11-25      1.84 1999        -3.7           0.0        NA
24075 1999-11-30      1.50 1999        -2.8           0.0        NA
24164 2000-02-27      6.00 2000        -3.5           0.0        NA
24173 2000-03-07      6.15 2000        -3.9           0.0        NA
24178 2000-03-12      6.40 2000        -0.7           0.0        NA
24179 2000-03-13      6.40 2000        -2.3           0.5        NA
24186 2000-03-20      7.50 2000        -6.4           0.0        NA
24187 2000-03-21      7.40 2000        -2.8           0.0        NA
24188 2000-03-22      7.25 2000        -2.0           0.0        NA
24204 2000-04-07      7.70 2000        -4.9           0.0        NA
24205 2000-04-08      7.70 2000        -2.3           0.0        NA
24277 2000-06-19      2.40 2000        11.6           0.0        NA
24485 2001-01-13      1.40 2001        -6.0           2.4        NA
24521 2001-02-18      2.25 2001        -6.1           0.0        NA
24537 2001-03-06      3.20 2001        -2.2           1.4        NA
24547 2001-03-16      3.40 2001        -2.9          21.2        NA
24562 2001-03-31      4.07 2001        -4.5           0.0        NA
24756 2001-10-11      0.00 2001         7.2           0.0        NA
24777 2001-11-01      0.02 2001        -3.6           0.0        NA
24786 2001-11-10      0.55 2001        -9.9           0.0        NA
24818 2001-12-12      1.50 2001        -4.7           0.0        NA
24884 2002-02-16      2.95 2002        -8.5           4.3        NA
24922 2002-03-26      3.55 2002        -8.5           0.0        NA
24923 2002-03-27      3.55 2002        -7.8           0.0        NA
24924 2002-03-28      3.55 2002        -5.8           0.0        NA
24925 2002-03-29      3.55 2002        -6.6           0.0        NA
25108 2002-09-28      0.55 2002        -1.0           0.0        NA
25153 2002-11-12      1.45 2002        -3.6           0.0        NA
25161 2002-11-20      1.30 2002        -5.7           7.6        NA
25175 2002-12-04      1.60 2002        -9.6           0.3        NA
25300 2003-04-08      3.95 2003       -11.8           0.0        NA
25305 2003-04-13      4.16 2003        -3.7           0.0        NA
25533 2003-11-27      0.35 2003        -5.0         107.6        NA
25883 2004-11-11      0.20 2004        -7.3           6.2        NA
25971 2005-02-07      3.55 2005       -12.5           0.0        NA
25992 2005-02-28      4.96 2005       -17.8           0.0        NA
26218 2005-10-12      0.00 2005        -1.1           0.0        NA
26220 2005-10-14      0.00 2005         5.0           0.0        NA
26221 2005-10-15      0.00 2005         5.5           0.0        NA
26223 2005-10-17      0.00 2005         5.1           0.0        NA
26251 2005-11-14      0.01 2005        -1.4           0.0        NA
26317 2006-01-19      2.47 2006        -3.5           0.0        NA
26321 2006-01-23      2.67 2006        -7.8           0.0        NA
26340 2006-02-11      3.25 2006       -11.5           0.0        NA
26356 2006-02-27      3.06 2006       -11.9           0.0        NA
26691 2007-01-28      1.81 2007        -5.6           0.0        NA
26696 2007-02-02      1.81 2007        -1.9           0.0        NA
26761 2007-04-08      4.02 2007        -0.4           0.0        NA
26763 2007-04-10      3.93 2007         0.4           0.0        NA
26813 2007-05-30      1.90 2007        -0.4           0.0        NA
26943 2007-10-07      0.00 2007         4.4           0.0        NA
26947 2007-10-11      0.00 2007         1.8           0.0        NA
26967 2007-10-31      0.18 2007        -0.1           0.0        NA
27066 2008-02-07      3.50 2008        -5.5           0.0        NA
27094 2008-03-06      3.93 2008        -9.2           0.0        NA
27686 2009-10-19      0.76 2009        -4.1           0.0        NA
27762 2010-01-03      3.22 2010       -13.3           0.0        NA
28047 2010-10-15      0.00 2010         1.4           0.0        NA
28747 2012-09-14      0.05 2012         1.5           0.0        NA
28792 2012-10-29      0.22 2012        -9.5           0.0        NA
28809 2012-11-15      0.70 2012         1.7           0.0        NA
28896 2013-02-10      5.63 2013       -16.1           0.8        NA
28899 2013-02-13      5.72 2013       -13.7           0.1        NA
28916 2013-03-02      5.30 2013        -3.7           0.0        NA
28918 2013-03-04      5.25 2013        -4.3           0.0        NA
28941 2013-03-27      5.11 2013        -7.3           0.0        NA
28946 2013-04-01      5.11 2013        -8.5           0.0        NA
28948 2013-04-03      5.00 2013        -5.5           0.0        NA
29012 2013-06-06      4.47 2013         4.7           1.9        NA
29262 2014-02-11      2.39 2014        -8.8            NA       114
29263 2014-02-12      2.39 2014        -7.7            NA       115
29264 2014-02-13      2.39 2014        -7.2            NA        54
29265 2014-02-14      2.49 2014        -5.5            NA        67
29266 2014-02-15      2.50 2014        -7.5            NA       126
29267 2014-02-16      2.53 2014        -7.5            NA        51
29268 2014-02-17      2.63 2014        -7.8            NA       122
29269 2014-02-18      2.63 2014        -5.5            NA       122
29270 2014-02-19      2.63 2014        -5.9            NA        78
29271 2014-02-20      2.65 2014        -6.6            NA       155
29272 2014-02-21      2.66 2014        -6.3            NA        67
29273 2014-02-22      2.73 2014        -9.2            NA       123
29274 2014-02-23      2.78 2014        -6.3            NA       168
29275 2014-02-24      2.78 2014        -7.8            NA       171
29276 2014-02-25      2.78 2014        -9.0            NA       150
29277 2014-02-26      2.78 2014        -8.0            NA       104
29278 2014-02-27      2.81 2014        -8.7            NA       176
29279 2014-02-28      2.84 2014        -8.5            NA       151
29590 2015-01-05      1.59 2015        -5.7           0.0        NA
29916 2015-11-27      0.86 2015        -6.6           0.0        NA
30019 2016-03-09      4.30 2016       -11.5           0.0        NA
30021 2016-03-11      4.30 2016        -5.6           0.0        NA
30022 2016-03-12      4.30 2016        -5.8           0.0        NA
30024 2016-03-14      4.30 2016        -6.9           0.0        NA
30028 2016-03-18      4.25 2016        -5.2           0.0        NA
30029 2016-03-19      4.20 2016        -3.7           0.0        NA
30030 2016-03-20      4.20 2016        -3.8           0.0        NA
30032 2016-03-22      4.10 2016        -3.8           0.0        NA
30086 2016-05-15      4.20 2016        -3.7            NA       170
30087 2016-05-16      4.23 2016        -3.3            NA       160
30283 2016-11-28      0.56 2016        -4.6           0.0        NA
30318 2017-01-02      0.20 2017        -3.9            NA        76
30319 2017-01-03      0.26 2017        -8.9            NA        87
30320 2017-01-04      0.26 2017        -6.5            NA        18
30321 2017-01-05      0.48 2017       -12.4            NA        28
30322 2017-01-06      0.66 2017       -12.9            NA        94
30323 2017-01-07      0.63 2017        -9.2            NA        54
30324 2017-01-08      0.81 2017        -7.7            NA        54
30325 2017-01-09      0.78 2017        -7.4            NA        94
30327 2017-01-11      0.84 2017        -9.3            NA        70
30328 2017-01-12      0.99 2017        -4.1            NA        34
30329 2017-01-13      1.21 2017          NA            NA        24
30330 2017-01-14      1.35 2017       -13.6            NA        30
30331 2017-01-15      1.63 2017       -16.5            NA        61
30332 2017-01-16      1.68 2017       -17.9            NA        54
30333 2017-01-17      1.73 2017       -17.6            NA        93
30335 2017-01-19      1.70 2017        -9.8            NA       106
30336 2017-01-20      1.70 2017       -10.1            NA       107
30337 2017-01-21      1.70 2017        -8.9            NA       109
30339 2017-01-23      1.68 2017        -5.9            NA       112
30340 2017-01-24      1.65 2017        -7.3            NA       111
30341 2017-01-25      1.65 2017        -7.5            NA       113
30342 2017-01-26      1.65 2017        -7.4            NA       115
30343 2017-01-27      1.65 2017        -8.7            NA       111
30344 2017-01-28      1.65 2017        -7.1            NA       100
30345 2017-01-29      1.65 2017        -6.7            NA       116
30346 2017-01-30      1.65 2017        -4.7            NA        39
30347 2017-01-31      1.70 2017        -1.9            NA        26
30365 2017-02-18      2.28 2017        -6.6           0.0        NA
30446 2017-05-10      2.84 2017         0.5           1.3        NA
30452 2017-05-16      2.60 2017         5.6           0.0        NA
30453 2017-05-17      2.55 2017         6.8           0.0        NA
30458 2017-05-22      2.38 2017         5.3           0.0        NA
30462 2017-05-26      2.10 2017         8.3           0.0        NA
30463 2017-05-27      2.05 2017         9.3           0.0        NA
30464 2017-05-28      1.90 2017         9.2           0.0        NA
30465 2017-05-29      1.80 2017         9.0           0.8        NA
30477 2017-06-11      0.95 2017        13.0           0.0        NA
30484 2017-06-18      0.45 2017        11.4           0.0        NA
30486 2017-06-20      0.35 2017        13.1           0.0        NA
30492 2017-06-26      0.00 2017        10.4          14.9        NA
30605 2017-10-17      0.00 2017         7.1           0.0        NA
30618 2017-10-30      0.34 2017        -2.1           0.1        NA
30626 2017-11-07      0.41 2017        -2.9           0.8        NA
30628 2017-11-09      0.43 2017        -4.8           0.2        NA
30634 2017-11-15      0.75 2017        -1.7           0.0        NA
30637 2017-11-18      0.70 2017        -4.9           0.0        NA
30664 2017-12-15      3.06 2017       -10.2           3.0        NA
30665 2017-12-16      3.10 2017       -11.6          22.5        NA
30666 2017-12-17      3.68 2017       -13.5           1.0        NA
30667 2017-12-18      3.65 2017        -9.4          12.7        NA
30721 2018-02-13      5.35 2018       -15.7           0.0        NA
30727 2018-02-19      5.63 2018        -9.6           0.7        NA
30734 2018-02-26      5.58 2018       -19.6           0.1        NA
30744 2018-03-08      5.81 2018        -7.9           0.0        NA
30760 2018-03-24      5.80 2018        -8.9           0.0        NA
30848 2018-06-20      0.85 2018        10.7           0.0        NA
30857 2018-06-29      0.20 2018         9.0           0.0        NA
30859 2018-07-01      0.20 2018        13.9           0.0        NA
30870 2018-07-12      0.00 2018         8.4           0.0        NA
30871 2018-07-13      0.00 2018        10.0           0.0        NA
30876 2018-07-18      0.00 2018        10.8           5.3        NA
30889 2018-07-31      0.00 2018        13.8           0.0        NA
30945 2018-09-25      0.02 2018         3.6           0.0        NA
30996 2018-11-15      0.00 2018         0.1           0.0        NA
30997 2018-11-16      0.00 2018        -0.9           0.0        NA
31023 2018-12-12      0.75 2018       -10.5            NA        88
31024 2018-12-13      0.75 2018       -14.1            NA        83
31025 2018-12-14      0.75 2018       -11.3            NA        84
31026 2018-12-15      0.74 2018        -7.6            NA        85
31027 2018-12-16      0.75 2018        -3.4            NA        29
31028 2018-12-17      0.85 2018        -7.3            NA        32
31029 2018-12-18      0.88 2018        -6.7            NA        81
31030 2018-12-19      0.80 2018        -7.6            NA        33
31031 2018-12-20      0.86 2018        -7.7            NA        50
31032 2018-12-21      0.87 2018        -3.0            NA        18
31033 2018-12-22      0.90 2018        -1.4            NA        16
31034 2018-12-23      1.05 2018        -0.7            NA        19
31035 2018-12-25      1.45 2018        -4.7            NA        67
31036 2018-12-26      1.40 2018        -1.1            NA        81
31037 2018-12-27      1.40 2018         0.4            NA        77
31038 2018-12-28      1.40 2018        -0.9            NA        75
31039 2018-12-29      1.40 2018        -2.7            NA        79
31040 2018-12-30      1.43 2018        -3.9            NA        23
31041 2018-12-31      1.45 2018        -3.7            NA        36
31042 2019-01-01      1.45 2019        -1.4            NA        78
31043 2019-01-02      1.60 2019       -11.0            NA        24
31044 2019-01-03      1.75 2019       -12.6            NA        62
31045 2019-01-04      1.78 2019       -10.1            NA        71
31046 2019-01-05      1.80 2019        -8.2            NA        22
31047 2019-01-06      2.19 2019        -7.2            NA        47
31048 2019-01-07      2.22 2019        -6.4            NA        93
31049 2019-01-08      2.28 2019        -7.4            NA        20
31050 2019-01-09      2.65 2019       -12.6            NA        29
31051 2019-01-10      3.00 2019       -15.2            NA        58
31052 2019-01-11      3.10 2019       -14.1            NA        74
31053 2019-01-12      3.13 2019        -7.6            NA        55
31054 2019-01-13      3.50 2019        -5.3            NA        18
31055 2019-01-14      3.80 2019        -7.8            NA        20
31056 2019-01-15      4.30 2019        -6.5            NA        45
31057 2019-01-16      4.70 2019        -3.6            NA        96
31058 2019-01-21      4.79 2019       -12.2            NA        79
31059 2019-01-22      4.79 2019       -12.5            NA       111
31060 2019-01-23      4.65 2019       -13.2            NA       101
31061 2019-01-24      4.50 2019       -15.3            NA       103
31062 2019-01-25      4.52 2019       -14.4            NA       115
31063 2019-01-30      4.40 2019       -14.2            NA        52
31064 2019-01-31      4.45 2019       -12.3            NA        82
31065 2019-02-04      4.60 2019        -9.5           0.0        NA
31086 2019-03-20      6.25 2019        -7.3           0.0        NA
31087 2019-03-21      6.00 2019        -2.3           0.0        NA
31273 2019-10-16      0.05 2019         1.3           0.0        NA
31383 2020-02-03      2.50 2020         1.3          20.6        NA
31438 2020-03-31      3.99 2020        -5.8           0.0        NA
31784 2021-03-13      3.90 2021        -5.8            NA       181
31785 2021-03-14      4.09 2021       -10.0            NA        71
31786 2021-03-15      4.22 2021        -9.3            NA        61
31787 2021-03-16      4.45 2021       -10.7            NA       104
31788 2021-03-17      4.60 2021        -9.5            NA       155
31789 2021-03-18      4.90 2021       -12.3            NA       212
31790 2021-03-19      4.88 2021       -12.5            NA       190
31791 2021-03-20      5.07 2021       -13.4            NA       193
31792 2021-03-21      5.00 2021        -9.9            NA       164
31793 2021-03-22      5.04 2021        -9.6            NA       164
31794 2021-03-23      4.92 2021        -5.3            NA       228
31795 2021-03-24      4.85 2021        -3.0            NA       240
31796 2021-03-25      4.80 2021        -2.8            NA       237
31797 2021-03-26      4.70 2021        -2.5            NA       228
31798 2021-03-27      4.70 2021        -3.8            NA       113
31799 2021-03-28      4.71 2021        -2.1            NA       248
31800 2021-03-29      4.65 2021         2.5            NA       243
31801 2021-03-30      4.50 2021         4.3            NA       252
31802 2021-03-31      4.42 2021         3.2            NA       257</code></pre>
</div>
</div>
<section id="observaciones-para-rellenar-los-valores-faltantes-en-la-radiación" class="level3">
<h3 class="anchored" data-anchor-id="observaciones-para-rellenar-los-valores-faltantes-en-la-radiación">Observaciones para rellenar los valores faltantes en la radiación</h3>
<p>La radiación tiene 592 valores faltantes.</p>
<p>El mayor numero de datos faltantes se eencuentra entre los años 1981-1983. Siguiendo un poco el historico de la radiacion, es bastante aleatoria.</p>
<p>Se plantean panoramas para ver el comportamiento de los datos y asi rellenar los datos faltantessiguiendo una lógica:</p>
<p>Primero se observara como se comporta la radiacion en un mismo dia en diferentes años</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar datos para el 10 de mayo</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>dia_especifico <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dia =</span> <span class="fu">format</span>(Fecha, <span class="st">"%d"</span>), <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>), Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Dia <span class="sc">==</span> <span class="st">"10"</span> <span class="sc">&amp;</span> Mes <span class="sc">==</span> <span class="st">"05"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  dia_especifico,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año),</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Radiation,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">'blue'</span>, <span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Cambio de la radiación para el 10 de mayo a lo largo de los años"</span>,</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>),</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Radiación"</span>),</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ea746952f6a42021a8e6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ea746952f6a42021a8e6">{"x":{"visdat":{"7ed869610ce":["function () ","plotlyVisDat"]},"cur_data":"7ed869610ce","attrs":{"7ed869610ce":{"x":{},"y":{},"mode":"lines+markers","line":{"color":"blue","width":2},"marker":{"size":5},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Cambio de la radiación para el 10 de mayo a lo largo de los años","xaxis":{"domain":[0,1],"automargin":true,"title":"Año"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Radiación"},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,null,2018,2019,2020,2021],"y":[338,275,259,311,87,164,273,204,245,311,209,315,270,112,212,87,235,87,289,176,321,204,87,297,242,313,194,87,87,159,187,87,129,324,228,87,146,246,87,217,117,274,259,148,107,136,170,254,239,239,165,302,316,234,143,92,256,220,174,261,254,175,309,262,353,287,314,254,296,230,286,156,307,299,364,249,118,307,328,138,221,300,165,null,113,214,281,180],"mode":"lines+markers","line":{"color":"blue","width":2},"marker":{"color":"rgba(31,119,180,1)","size":5,"line":{"color":"rgba(31,119,180,1)"}},"type":"scatter","error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>La Variación es enorme, no sigue una tendencia. No es una buena opcion para rellenar los datos faltantes.</p>
<p>Ahora se mira como cambia la radiacion durante un mismo mes en 3 años diferentes seguidos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Asegurarse de que la columna Fecha sea de tipo Date</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>datos_combinados<span class="sc">$</span>Fecha <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(datos_combinados<span class="sc">$</span>Fecha)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar datos para noviembre (Mes = "11") y los años 1984, 1985, 1986</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>mayo_datos <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>),</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dia =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(Fecha, <span class="st">"%d"</span>))</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Mes <span class="sc">==</span> <span class="st">"11"</span> <span class="sc">&amp;</span> Año <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1984"</span>, <span class="st">"1985"</span>, <span class="st">"1986"</span>))</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico interactivo con plotly</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  mayo_datos,</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>Dia,</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Radiation,</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span>Año,</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>),</span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Variación de la radiación durante Noviembre (1984-1986)"</span>,</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Día del mes"</span>, <span class="at">tickvals =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">31</span>, <span class="at">by =</span> <span class="dv">1</span>)),</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Radiación"</span>),</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Año"</span>)),</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9c671f2b01ec8df9b4a4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9c671f2b01ec8df9b4a4">{"x":{"visdat":{"7ed8646d528d":["function () ","plotlyVisDat"]},"cur_data":"7ed8646d528d","attrs":{"7ed8646d528d":{"x":{},"y":{},"mode":"lines+markers","line":{"width":2},"marker":{"size":5},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variación de la radiación durante Noviembre (1984-1986)","xaxis":{"domain":[0,1],"automargin":true,"title":"Día del mes","tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Radiación"},"legend":{"title":{"text":"Año"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[3,null,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,null,28,29,30],"y":[92,null,120,77,79,92,98,115,116,115,90,46,66,44,97,102,49,20,22,23,58,23,63,26,null,95,96,87],"mode":"lines+markers","line":{"color":"rgba(102,194,165,1)","width":2},"marker":{"color":"rgba(102,194,165,1)","size":5,"line":{"color":"rgba(102,194,165,1)"}},"type":"scatter","name":"1984","textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,null,5,6,7,8,9,10,11,12,13,14,null,17,18,null,20,21,22,23,null,28,29,30],"y":[35,13,79,null,67,23,111,23,93,23,76,99,51,56,null,97,66,null,105,61,72,97,null,32,23,20],"mode":"lines+markers","line":{"color":"rgba(252,141,98,1)","width":2},"marker":{"color":"rgba(252,141,98,1)","size":5,"line":{"color":"rgba(252,141,98,1)"}},"type":"scatter","name":"1985","textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,null,4,5,6,7,null,9,null,12,13,14,15,16,17,18,19,20,21,22,23,null,25,26,27],"y":[31,36,null,108,124,54,122,null,118,null,118,41,22,78,95,63,90,77,38,57,21,19,null,93,95,85],"mode":"lines+markers","line":{"color":"rgba(141,160,203,1)","width":2},"marker":{"color":"rgba(141,160,203,1)","size":5,"line":{"color":"rgba(141,160,203,1)"}},"type":"scatter","name":"1986","textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>A simple vista, no se observa un patrón claro y existe una variabilidad considerable en los datos. Sin embargo, la media mensual-anual es relativamente baja en comparación con otros meses, aunque esto no se aprecia directamente en la gráfica. Por esta razón, los valores faltantes se imputarán de manera aleatoria, basándose en la media y la desviación estándar de cada mes por año.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear columnas de Año y Mes</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la media y la desviación estándar por Mes y Año</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>estadisticas_mensuales <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año, Mes) <span class="sc">%&gt;%</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">media_mensualRad =</span> <span class="fu">mean</span>(Radiation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_mensualRad =</span> <span class="fu">sd</span>(Radiation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Unir las estadísticas mensuales con los datos originales</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(estadisticas_mensuales, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Año"</span>, <span class="st">"Mes"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rellenar valores faltantes de Radiation con valores aleatorios basados en la media mensual</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># Para reproducibilidad</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Radiation =</span> <span class="fu">ifelse</span>(</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(Radiation),</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> media_mensualRad, <span class="at">sd =</span> sd_mensualRad), <span class="co"># Generar valores aleatorios</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>      Radiation</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se comprueba que los valores sigan conservando la aleatoriedad y no sigan un patrón claro. Esto durante el mes de noviembre</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtrar datos para noviembre (Mes = "11") y los años 1984, 1985, 1986</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>noviembrer_datos <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mes =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m"</span>),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>),</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dia =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(Fecha, <span class="st">"%d"</span>))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Mes <span class="sc">==</span> <span class="st">"11"</span> <span class="sc">&amp;</span> Año <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1984"</span>, <span class="st">"1985"</span>, <span class="st">"1986"</span>))</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  noviembrer_datos,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>Dia,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>Radiation,</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">color =</span> <span class="sc">~</span><span class="fu">as.factor</span>(Año),  <span class="co"># Asegurar que el color se base en una variable categórica</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'scatter'</span>,</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="st">"linear"</span>),  <span class="co"># Forzar conexión</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Variación de la radiación durante Noviembre (1984-1986)"</span>,</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Día del mes"</span>, <span class="at">tickvals =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">31</span>, <span class="at">by =</span> <span class="dv">1</span>)),</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Radiación"</span>),</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Año"</span>)),</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9be10bf6d60bb3d9fb9a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9be10bf6d60bb3d9fb9a">{"x":{"visdat":{"7ed8520e25a5":["function () ","plotlyVisDat"]},"cur_data":"7ed8520e25a5","attrs":{"7ed8520e25a5":{"x":{},"y":{},"mode":"lines+markers","line":{"width":2,"shape":"linear"},"marker":{"size":5},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Variación de la radiación durante Noviembre (1984-1986)","xaxis":{"domain":[0,1],"automargin":true,"title":"Día del mes","tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Radiación"},"legend":{"title":{"text":"Año"}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y":[89.400037745201587,-7.0076051301551416,92,71.726453976838485,120,77,79,92,98,115,116,115,90,46,66,44,97,102,49,20,22,23,58,23,63,26,65.169325286516951,95,96,87],"mode":"lines+markers","line":{"color":"rgba(102,194,165,1)","width":2,"shape":"linear"},"marker":{"color":"rgba(102,194,165,1)","size":5,"line":{"color":"rgba(102,194,165,1)"}},"type":"scatter","name":"1984","textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y":[35,13,79,57.49378717684079,67,23,111,23,93,23,76,99,51,56,111.9854604127767,17.908300126578453,97,66,13.887666898254928,105,61,72,97,36.842053283035149,99.41957994981729,37.550878383407571,6.5597535487240108,32,23,20],"mode":"lines+markers","line":{"color":"rgba(252,141,98,1)","width":2,"shape":"linear"},"marker":{"color":"rgba(252,141,98,1)","size":5,"line":{"color":"rgba(252,141,98,1)"}},"type":"scatter","name":"1985","textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y":[31,36,110.99723277986101,108,124,54,122,92.558856008427298,118,87.624807427781136,113.87452597909385,118,41,22,78,95,63,90,77,38,57,21,19,135.66322029951152,93,95,85,33.375644669680014,58.841245395595351,51.059495052449265],"mode":"lines+markers","line":{"color":"rgba(141,160,203,1)","width":2,"shape":"linear"},"marker":{"color":"rgba(141,160,203,1)","size":5,"line":{"color":"rgba(141,160,203,1)"}},"type":"scatter","name":"1986","textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="observaciones-para-rellenar-los-valores-faltantes-de-las-precipitaciones" class="level3">
<h3 class="anchored" data-anchor-id="observaciones-para-rellenar-los-valores-faltantes-de-las-precipitaciones">Observaciones para rellenar los valores faltantes de las Precipitaciones</h3>
<p>Hay un total de 108 valores faltantes Distribuccion de los valores faltantes: los valores faltantes estan en los años 2014,2016 (sólo 2 dias), 2017,2018,2019, 2021 (estos 4 últimos son los que mas valores faltantes tienen). Falta casi el mes entero de:</p>
<ul>
<li><p>Marzo del 2021</p></li>
<li><p>Enero del 2019</p></li>
<li><p>Diciembre del 2018</p></li>
<li><p>Enero del 2017</p></li>
<li><p>Febrero del 2014</p></li>
</ul>
<p>En términos generales, las precipitaciones no siguen un patrón diario claro. Sin embargo, al analizar la media mensual, se observa que algunos meses presentan mayores niveles de lluvia que otros, similar a lo que ocurre con la radiación. No obstante, en este caso, no se procederá a rellenar los valores faltantes de la misma manera, ya que casi todo el mes carece de datos.</p>
<p>Diciembre, enero y marzo destacan como meses de alta precipitación. Dado que abril no presenta días faltantes y también pertenece al grupo de meses con mayores lluvias, se calcularán la media y la desviación estándar de febrero para cada año. Con base en estos valores, se imputarán los datos faltantes de cada año, asegurando así la conservación de la media y la varianza anual.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la media y desviación estándar de abril de cada año</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>estadisticas_abril <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Mes <span class="sc">==</span> <span class="st">"04"</span>) <span class="sc">%&gt;%</span> <span class="co"># Filtrar solo el mes de abril</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año) <span class="sc">%&gt;%</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">media_abril =</span> <span class="fu">mean</span>(Precipitation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_abril =</span> <span class="fu">sd</span>(Precipitation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Unir las estadísticas de abril con los datos originales</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(estadisticas_abril, <span class="at">by =</span> <span class="st">"Año"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rellenar valores faltantes en Precipitation</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># Para reproducibilidad</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Precipitation =</span> <span class="fu">ifelse</span>(</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">is.na</span>(Precipitation),</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> media_abril, <span class="at">sd =</span> sd_abril),   <span class="co"># Basado en estadísticas de Abril</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>      Precipitation</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="observaciones-para-rellenar-los-valores-faltantes-de-la-temperatura" class="level3">
<h3 class="anchored" data-anchor-id="observaciones-para-rellenar-los-valores-faltantes-de-la-temperatura">Observaciones para rellenar los valores faltantes de la Temperatura</h3>
<p>Hay sólo 2 datos faltantes de la temperatura, entonces se optara por rellenarlos segun una interpolacion, ya que la temperatura suele seguir un patron.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rellenar los valores faltantes en la columna Temperature por interpolación</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Fecha) <span class="sc">%&gt;%</span> <span class="co"># Asegurar que los datos estén ordenados por fecha</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Temperature =</span> <span class="fu">na.approx</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">FALSE</span>) <span class="co"># Interpolación lineal</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="separacion-de-los-datos-por-temporada" class="level2">
<h2 class="anchored" data-anchor-id="separacion-de-los-datos-por-temporada">Separacion de los datos por temporada</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear la columna Año y Temporada</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>datos_combinados <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    Año <span class="ot">=</span> <span class="fu">format</span>(Fecha, <span class="st">"%Y"</span>),</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">MesDia =</span> <span class="fu">format</span>(Fecha, <span class="st">"%m-%d"</span>),</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Temporada =</span> <span class="fu">case_when</span>(</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>      MesDia <span class="sc">&gt;=</span> <span class="st">"05-20"</span> <span class="sc">&amp;</span> MesDia <span class="sc">&lt;=</span> <span class="st">"09-20"</span> <span class="sc">~</span> <span class="st">"Verano"</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Invierno"</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular el promedio  por temporada y año</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>datos_temporada <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año, Temporada) <span class="sc">%&gt;%</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">DepthSnowPromedio =</span> <span class="fu">mean</span>(DepthSnow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">RadiationPromedio =</span> <span class="fu">mean</span>(Radiation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">PrecipitationPromedio =</span> <span class="fu">mean</span>(Precipitation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">TemperaturePromedio =</span> <span class="fu">mean</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular los promedios anuales</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>datos_anuales <span class="ot">&lt;-</span> datos_combinados <span class="sc">%&gt;%</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Año) <span class="sc">%&gt;%</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">DepthSnowPromedio_Anual =</span> <span class="fu">mean</span>(DepthSnow, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">RadiationPromedio_Anual =</span> <span class="fu">mean</span>(Radiation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">PrecipitationPromedio_Anual =</span> <span class="fu">mean</span>(Precipitation, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">TemperaturePromedio_Anual =</span> <span class="fu">mean</span>(Temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se crea un gráfico interactivo para cada variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(datos_temporada, <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año), <span class="at">y =</span> <span class="sc">~</span>DepthSnowPromedio, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">color =</span> <span class="sc">~</span>Temporada, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución estacional de la profundidad de la nieve"</span>,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Valor Promedio"</span>),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Temporada"</span>))</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-f05febf07305203246b7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f05febf07305203246b7">{"x":{"visdat":{"7ed81174c1e":["function () ","plotlyVisDat"]},"cur_data":"7ed81174c1e","attrs":{"7ed81174c1e":{"x":{},"y":{},"mode":"lines+markers","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución estacional de la profundidad de la nieve","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45},"yaxis":{"domain":[0,1],"automargin":true,"title":"Valor Promedio"},"hovermode":"closest","legend":{"title":{"text":"Temporada"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[0.93541216513375525,2.9911079826121321,2.8553276269185361,3.0507587433313574,1.9099858781686949,2.0630764671013635,2.5920032001491333,2.5410003743799332,2.4285091879075282,1.7043094250148192,2.8476387249114521,2.6219573206876112,1.7452608180201541,1.548677049594205,1.8610301062573791,1.0460666289182423,1.7955710333926103,2.2446594361292234,2.9510625737898466,2.7957600135489882,1.3452710774702477,1.9462359217545939,1.287396694214876,1.3166586870943717,1.4883995257854179,1.3195435684647303,1.5596280991735538,1.1132365145228216,1.3572199170124482,1.4102489626556016,1.0675619834710743,2.0308713692946059,2.5812863070539418,3.2568879668049791,2.6345454545454547,1.5029460580912863,3.3672199170124482,1.9097510373443982,0.95677685950413227,2.9962240663900417,2.7887136929460583,2.217551867219917,1.9160330578512397,2.5443568464730291,2.5118672199170127,2.3738589211618257,3.4536363636363636,3.3787136929460582,3.5219502074688798,2.4418672199170124,2.3844214876033059,1.8904979253112033,2.0250207468879666,2.7149792531120331,2.8124793388429752,1.8114107883817427,1.8639834024896265,1.9477593360995851,2.8733884297520662,2.3433609958506225,2.2663900414937759,3.0076348547717844,1.9484297520661158,2.1497095435684646,2.5134854771784232,3.8818672199170123,3.3665702479338844,2.1300829875518672,2.4339004149377592,2.4194605809128631,2.8976446280991737,2.3743983402489626,2.0442738589211618,2.0197510373443985,2.9637603305785123,2.4003734439834026,2.4562240663900416,1.9945643153526971,3.4574380165289256,2.8548132780082986,1.5161410788381742,2.0646887966804979,2.1123553719008266,1.7443153526970954,2.9424050632911394,2.4535326086956522,1.9975732217573221,3.8315827338129496],"mode":"lines+markers","line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"Invierno","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[0.08828303850156087,0.9616138632872504,0.41796082949308755,0.66183179723502306,0.60398481973434537,0.5961693548387097,0.57839467620664564,0.91143706039291772,0.28957373271889403,0.22892281105990783,0.6899193548387097,0.45762442396313363,0.12654377880184331,0.090935273426930821,0.38494815668202764,0.084102070293692821,0.31081989247311825,0.61882434475806447,0.50428571428571434,0.82710582620144835,0.49415056717476069,1.0721543778801843,0.44741935483870965,0.64016335814722913,0.069078341013824887,0.14330645161290323,0.17451612903225805,0.4356451612903226,0.70403225806451608,0.45016129032258062,0.075161290322580648,1.542258064516129,0.73250000000000004,1.6229032258064515,0.27427419354838711,0.2506451612903226,1.9453225806451613,0.42870967741935484,0.51870967741935481,0.91403225806451616,0.88822580645161286,1.0873387096774194,0.48290322580645162,1.0794354838709677,2.4201612903225804,1.0549999999999999,3.4467741935483871,1.7792741935483871,1.965483870967742,1.5333870967741936,1.4207258064516128,1.5441935483870968,0.83685483870967747,2.5406451612903225,1.9702419354838709,1.0316129032258063,0.92048387096774198,1.1798387096774194,1.0966935483870968,0.92129032258064514,1.0741935483870968,2.4916935483870968,0.41032258064516131,1.1739516129032259,0.80088709677419356,2.3547580645161292,1.432983870967742,1.1104032258064516,0.6745161290322581,0.48814516129032259,1.8731451612903225,1.2562096774193547,1.0490322580645162,0.42669354838709678,1.3965322580645161,0.50459677419354843,0.75040322580645158,0.30548387096774193,1.4079032258064517,1.7145161290322581,0.4331451612903226,0.85024193548387095,1.2129838709677419,0.35617886178861791,0.60250000000000004,1.9550000000000001,0.55959677419354836,2.3862666666666668],"mode":"lines+markers","line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"Verano","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(datos_temporada, <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año),<span class="at">y =</span> <span class="sc">~</span>RadiationPromedio, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">color =</span> <span class="sc">~</span>Temporada,   <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución estacional de la Radiación"</span>,</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Valor Promedio"</span>),</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span>,</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Temporada"</span>))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c92d63f484c5948cc09c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c92d63f484c5948cc09c">{"x":{"visdat":{"7ed8676e3419":["function () ","plotlyVisDat"]},"cur_data":"7ed8676e3419","attrs":{"7ed8676e3419":{"x":{},"y":{},"mode":"lines+markers","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución estacional de la Radiación","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45},"yaxis":{"domain":[0,1],"automargin":true,"title":"Valor Promedio"},"hovermode":"closest","legend":{"title":{"text":"Temporada"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[115.10373443983403,94.286307053941911,100.60330578512396,90.954356846473033,111.55186721991701,90.850622406639005,95.057851239669418,98.087136929460584,105.66804979253112,111.58091286307054,90.376033057851245,102.19502074688796,111.75518672199171,97.037344398340252,118.91735537190083,114.39419087136929,106.0954356846473,110.73858921161826,102.23140495867769,128.78838174273858,107.38589211618257,110.76348547717842,113.37190082644628,114.72614107883817,103.87136929460581,120.14522821576763,105.46280991735537,111.31120331950207,108.149377593361,107.25726141078839,108.97933884297521,100.63070539419087,106.45228215767635,114.81327800829875,115.20661157024793,114.57261410788382,95.008298755186729,118.82157676348548,109.26859504132231,100.93775933609959,97.257261410788388,113.60165975103735,115.59504132231405,93.033195020746888,98.556016597510379,97.825726141078832,99.446280991735534,102.2206664230623,114.04167468667502,108.01685624176405,122.05539068256591,119.9039999673363,119.64470479008909,115.60448862075758,106.02982491734032,123.75170332758579,112.50827269926981,115.67527837941081,115.86322370857508,115.69175985902078,103.61563973045492,113.24979371868577,116.42731819817591,113.77280296006842,114.44209219835378,116.7176513041419,118.85743371975671,116.93389520949451,113.23481982869522,126.74321679376537,112.85073335462276,114.31189198150166,120.0176818554223,122.99391250530144,119.86044614998529,120.75882219963431,121.31128794425658,133.34439834024897,126.91548056009093,122.81359971135413,120.52697095435684,127.51778737316378,116.69788192207594,127.35995643546636,130.63875804544423,103.08882016460909,119.53006120079802,148.71223021582733],"mode":"lines+markers","line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"Invierno","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[196.94354838709677,205.17741935483872,170.68548387096774,187.91935483870967,185.70967741935485,184.66129032258064,172.80645161290323,180.31451612903226,192.58064516129033,182.50806451612902,175.76612903225808,193.81451612903226,170.37096774193549,214.4758064516129,184.29838709677421,205.91129032258064,203.54032258064515,223.26612903225808,213.75,201.20967741935485,184.79838709677421,194.62096774193549,202.01612903225808,195.84677419354838,216.18548387096774,210.82258064516128,193.0241935483871,207.94354838709677,215.50806451612902,210.95161290322579,217.95161290322579,187.83064516129033,196.5,214.39516129032259,198.9758064516129,209.70967741935485,196.40322580645162,212.61290322580646,181.14516129032259,203.78225806451613,197.63709677419354,203.17741935483872,191.95967741935485,197.7741935483871,179.9758064516129,187.21774193548387,176.79032258064515,201.18898936396252,205.37580290537619,212.57836294519794,191.33842833348987,213.53645155869276,213.25,185.76612903225808,201.61290322580646,201.60483870967741,196.93548387096774,217.08870967741936,208.62096774193549,192.99178507661486,182.76612903225808,197.55645161290323,194.32258064516128,160.21774193548387,201.30173165908917,210.47627664867633,216.52146217439554,210.70161290322579,211.87096774193549,224.46774193548387,197.61290322580646,192.12903225806451,212.12096774193549,206.51469376888303,210.88709677419354,205.11290322580646,204.45161290322579,210.78225806451613,224.77302415551495,215.77947682975781,190.26612903225808,216.58870967741936,179.83870967741936,187.68326680629966,209.33904157799685,159.41935483870967,174.0241935483871,220.63999999999999],"mode":"lines+markers","line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"Verano","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(datos_temporada, <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año), <span class="at">y =</span> <span class="sc">~</span>PrecipitationPromedio, <span class="at">color =</span> <span class="sc">~</span>Temporada,  <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución estacional de las precipitaciones"</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Valor Total"</span>),</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span>,</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Temporada"</span>))</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8df8783b7d245bebb3e4" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8df8783b7d245bebb3e4">{"x":{"visdat":{"7ed816454fc3":["function () ","plotlyVisDat"]},"cur_data":"7ed816454fc3","attrs":{"7ed816454fc3":{"x":{},"y":{},"mode":"lines+markers","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución estacional de las precipitaciones","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45},"yaxis":{"domain":[0,1],"automargin":true,"title":"Valor Total"},"hovermode":"closest","legend":{"title":{"text":"Temporada"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[6.186721991701245,9.0157676348547717,7.5595041322314049,7.6369294605809133,4.7742738589211617,7.9095435684647306,7.406611570247934,6.5580912863070537,5.5336099585062239,5.9896265560165975,7.2698347107438019,5.8775933609958502,4.5443983402489625,7.055186721991701,4.1938016528925619,3.970539419087137,5.0539419087136928,5.9580912863070541,6.9880165289256198,3.8659751037344399,5.4821576763485478,5.6684647302904567,4.7351239669421492,4.5684647302904562,7.3780082987551872,5.9095435684647306,6.6867768595041319,4.8904564315352701,6.7680497925311203,5.7402489626556017,4.9863636363636363,7.3763485477178419,7.5692946058091284,5.0207468879668049,6.5528925619834713,5.351452282157676,7.6074688796680503,4.6423236514522825,6,4.9933609958506224,7.038174273858921,5.6651452282157679,5.7904958677685947,8.5692946058091284,7.360165975103734,7.5452282157676347,6.5611570247933884,7.9539419087136931,7.7991701244813276,7.3236514522821574,6.5623966942148764,5.7365145228215768,8.8834024896265564,7.9651452282157678,9.4028925619834709,6.8120331950207467,7.1688796680497928,6.9676348547717843,6.2541322314049586,6.8788381742738594,8.2269709543568457,8.9390041493775936,7.8723140495867767,6.1875518672199172,6.2576763485477178,10.148132780082987,8.4462809917355379,6.3539419087136926,9.4165975103734443,6.6128630705394187,7.0004132231404963,6.0136929460580912,6.1020746887966801,6.2236514522821578,6.6074380165289259,6.2157676348547719,6.9186721991701248,6.317842323651452,7.8082644628099169,5.4016597510373447,7.1474081168058854,6.4634854771784234,7.5578575080125123,7.0878581489183921,8.9834549744506642,10.52895288107003,4.0602510460251047,5.0632676905975726],"mode":"lines+markers","line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"Invierno","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[4.7693548387096776,4.7588709677419354,4.5870967741935482,5.6395161290322582,6.2637096774193548,4.7145161290322584,5.9524193548387094,5.0072580645161286,4.205645161290323,4.3298387096774196,4.7879032258064518,4.4661290322580642,5.629032258064516,2.3895161290322582,6.5959677419354836,3.629032258064516,3.8161290322580643,5.3137096774193546,3.0959677419354841,5.8459677419354836,5.1604838709677416,5.0137096774193548,5.431451612903226,5.2959677419354838,5.3338709677419356,2.9524193548387099,6.600806451612903,4.306451612903226,1.9806451612903226,5.7798387096774198,5.366935483870968,6.4427419354838706,2.9161290322580644,3.6266129032258063,5.8241935483870968,6.3411290322580642,3.786290322580645,4.7999999999999998,4.6338709677419354,6.0217741935483868,5.0354838709677416,5.6782258064516133,4.6645161290322577,6.012096774193548,3.8999999999999999,4.0217741935483868,4.9532258064516128,5.5532258064516125,3.3758064516129034,4.6927419354838706,5.6830645161290319,4.6870967741935488,4.9217741935483872,4.6862903225806454,3.9814516129032258,3.4040322580645159,3.3379032258064516,2.6830645161290323,4.8572580645161292,4.8653225806451612,5.1217741935483874,5.4991935483870966,4.7387096774193544,6.2677419354838708,4.741935483870968,5.30241935483871,5.540322580645161,5.5451612903225804,6.6137096774193544,2.8362903225806453,3.6524193548387096,4.8701612903225806,4.6282258064516126,8.1725806451612897,5.8096774193548386,2.5274193548387096,5.3016129032258066,5.8161290322580648,4.556451612903226,4.4709677419354836,4.0016129032258068,4.6362903225806456,4.1185483870967738,3.2910569105691057,2.8564516129032258,3.7903225806451615,2.2596774193548388,4.214666666666667],"mode":"lines+markers","line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"Verano","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(datos_temporada, <span class="at">x =</span> <span class="sc">~</span><span class="fu">as.numeric</span>(Año), <span class="at">y =</span> <span class="sc">~</span>TemperaturePromedio, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines+markers'</span>, <span class="at">color =</span> <span class="sc">~</span>Temporada, <span class="at">line =</span> <span class="fu">list</span>(<span class="at">width =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Evolución estacional de la Temperatura"</span>,</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Año"</span>, <span class="at">tickangle =</span> <span class="dv">45</span>),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Valor Promedio"</span>),</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">hovermode =</span> <span class="st">"closest"</span>,</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="fu">list</span>(<span class="at">text =</span> <span class="st">"Temporada"</span>))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d747855ec5e0cc4de0ab" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d747855ec5e0cc4de0ab">{"x":{"visdat":{"7ed81e6f1aae":["function () ","plotlyVisDat"]},"cur_data":"7ed81e6f1aae","attrs":{"7ed81e6f1aae":{"x":{},"y":{},"mode":"lines+markers","line":{"width":2},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Evolución estacional de la Temperatura","xaxis":{"domain":[0,1],"automargin":true,"title":"Año","tickangle":45},"yaxis":{"domain":[0,1],"automargin":true,"title":"Valor Promedio"},"hovermode":"closest","legend":{"title":{"text":"Temporada"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[-3.6601659751037343,-6.03402489626556,-4.8516528925619831,-5.0103734439834025,-4.0946058091286304,-5.2423236514522822,-5.3479338842975208,-5.7029045643153529,-4.8854771784232369,-3.9232365145228214,-5.8809917355371901,-4.3651452282157672,-4.3439834024896262,-4.2618257261410788,-2.6929752066115702,-3.5921161825726142,-4.974688796680498,-5.3908713692946062,-5.5508264462809915,-3.9842323651452283,-5.050622406639004,-4.436514522821577,-6.0938016528925623,-3.3493775933609959,-4.7477178423236515,-4.1825726141078841,-4.6090909090909093,-2.8867219917012448,-6.0838174273858918,-5.5925311203319499,-4.026859504132231,-5.3726141078838179,-4.1336099585062245,-3.6033195020746889,-3.9037190082644626,-4.605809128630705,-4.9186721991701248,-3.667219917012448,-4.1677685950413226,-5.4294605809128633,-4.3950207468879672,-2.7821576763485476,-3.6181818181818182,-3.6846473029045645,-3.8634854771784233,-4.440663900414938,-4.460330578512397,-4.2045643153526973,-4.5141078838174273,-3.3448132780082989,-5.3888429752066118,-4.6593360995850626,-4.6452282157676352,-4.2489626556016598,-3.6367768595041321,-2.4302904564315351,-3.3261410788381744,-4.8402489626556013,-3.2640495867768595,-4.199170124481328,-3.0514522821576762,-4.1095435684647299,-4.7111570247933887,-3.0614107883817425,-3.8821576763485477,-4.2531120331950207,-3.5247933884297522,-3.7506224066390041,-3.3224066390041496,-4.2929460580912862,-4.1004132231404959,-4.733195020746888,-3.2904564315352696,-2.7091286307053943,-3.8194214876033059,-4.0999999999999996,-5.6535269709543572,-2.3336099585062242,-3.7904958677685952,-4.0365145228215766,-2.6215767634854772,-2.2464730290456432,-3.3797520661157026,-3.2321576763485478,-3.2046413502109705,-2.9798913043478259,-2.4489539748953977,-5.3273381294964031],"mode":"lines+markers","line":{"color":"rgba(102,194,165,1)","width":2},"type":"scatter","name":"Invierno","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],"y":[6.0370967741935484,6.0379032258064518,4.9774193548387098,5.7403225806451612,5.2354838709677418,4.9225806451612906,4.669354838709677,4.8499999999999996,6.5266129032258062,6.7080645161290322,6.1193548387096772,6.6443548387096776,5.6564516129032256,8.3620967741935477,4.6016129032258064,6.653225806451613,7.3233870967741934,5.7112903225806448,6.286290322580645,5.3395161290322584,4.4983870967741932,4.6258064516129034,4.9306451612903226,4.9443548387096774,6.366935483870968,5.7314516129032258,4.6153225806451612,5.415322580645161,5.6306451612903228,5.2685483870967742,6.2669354838709674,4.4346774193548386,5.9048387096774198,5.7088709677419356,5.205645161290323,5.2427419354838714,6.189516129032258,6.189516129032258,4.645161290322581,6.8370967741935482,6.4854838709677418,6.9008064516129028,6.3919354838709674,5.3766129032258068,5.6709677419354838,7.0088709677419354,5.5741935483870968,6.9927419354838705,6.7411290322580646,6.0290322580645164,4.3209677419354842,6.2145161290322584,5.9508064516129036,6.1951612903225808,5.8314516129032254,5.6725806451612906,5.9895161290322578,6.9483870967741934,6.4120967741935484,5.8040322580645158,6.9008064516129028,5.0483870967741939,5.0903225806451609,6.2927419354838712,6.4701612903225802,6.5104838709677422,6.3814516129032262,5.8266129032258061,6.2588709677419354,8.9604838709677423,6.4790322580645165,6.6766129032258066,6.6475806451612902,6.0112903225806447,6.5750000000000002,7.4330645161290319,6.5145161290322582,6.8588709677419359,7.5790322580645162,5.8290322580645162,5.8887096774193548,7.5096774193548388,7.3532258064516132,7.7528455284552846,8.1629032258064509,8.245967741935484,7.6387096774193548,6.4826666666666668],"mode":"lines+markers","line":{"color":"rgba(141,160,203,1)","width":2},"type":"scatter","name":"Verano","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Se separa los datos en columnas de verano e invierno</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorganizar los datos para tener columnas separadas para verano e invierno</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>datos_temporada_wide <span class="ot">&lt;-</span> datos_temporada <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Temporada,  <span class="co"># Usar los valores de "Temporada" para crear nuevas columnas</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(DepthSnowPromedio, RadiationPromedio, PrecipitationPromedio, TemperaturePromedio)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Unir los promedios anuales con los promedios de temporada</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>datos_finales <span class="ot">&lt;-</span> datos_anuales <span class="sc">%&gt;%</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(datos_temporada_wide, <span class="at">by =</span> <span class="st">"Año"</span>)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>datos_finales <span class="ot">&lt;-</span> datos_finales <span class="sc">%&gt;%</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Temporada =</span> Año)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se añade columna de variable dependiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraer el año de la columna End.date.of.observation y seleccionar solo las columnas necesarias</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>data_balance <span class="ot">&lt;-</span> data_balance <span class="sc">%&gt;%</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Temporada =</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(<span class="fu">as.Date</span>(End.date.of.observation, <span class="at">format =</span> <span class="st">"%d/%m/%Y"</span>), <span class="st">"%Y"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Temporada, Value)  <span class="co"># Mantener solo Temporada y Value</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Se cambia el tipo de dato</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>data_balance<span class="sc">$</span>Temporada<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data_balance<span class="sc">$</span>Temporada) </span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>datos_finales<span class="sc">$</span>Temporada<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(datos_finales<span class="sc">$</span>Temporada)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co"># agregar la columna a values a la tabla por datos_anual</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>datos_finales<span class="ot">&lt;-</span> datos_finales <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(data_balance <span class="sc">%&gt;%</span> <span class="fu">select</span>(Temporada, Value), <span class="at">by=</span><span class="st">"Temporada"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se elimina la columna Temporada</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>datos_finales <span class="ot">&lt;-</span> datos_finales<span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Temporada)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># se renombra la columna value</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>datos_finales<span class="ot">&lt;-</span> datos_finales <span class="sc">%&gt;%</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">mass_balance=</span>Value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos_finales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> DepthSnowPromedio_Anual RadiationPromedio_Anual PrecipitationPromedio_Anual
 Min.   :0.6476          Min.   :119.3           Min.   :3.445              
 1st Qu.:1.4172          1st Qu.:135.2           1st Qu.:5.378              
 Median :1.8259          Median :142.2           Median :5.867              
 Mean   :1.8270          Mean   :141.5           Mean   :5.993              
 3rd Qu.:2.1398          3rd Qu.:148.7           3rd Qu.:6.579              
 Max.   :3.4513          Max.   :173.9           Max.   :8.502              
 TemperaturePromedio_Anual DepthSnowPromedio_Invierno DepthSnowPromedio_Verano
 Min.   :-2.3587           Min.   :0.9354             Min.   :0.06908         
 1st Qu.:-1.1836           1st Qu.:1.8632             1st Qu.:0.44448         
 Median :-0.6549           Median :2.3049             Median :0.77565         
 Mean   :-0.6621           Mean   :2.2845             Mean   :0.93888         
 3rd Qu.:-0.1611           3rd Qu.:2.7999             3rd Qu.:1.22379         
 Max.   : 1.5396           Max.   :3.8819             Max.   :3.44677         
 RadiationPromedio_Invierno RadiationPromedio_Verano
 Min.   : 90.38             Min.   :159.4           
 1st Qu.:105.06             1st Qu.:187.9           
 Median :113.49             Median :201.2           
 Mean   :111.97             Mean   :198.9           
 3rd Qu.:118.87             3rd Qu.:210.8           
 Max.   :148.71             Max.   :224.8           
 PrecipitationPromedio_Invierno PrecipitationPromedio_Verano
 Min.   : 3.866                 Min.   :1.981               
 1st Qu.: 5.739                 1st Qu.:3.997               
 Median : 6.585                 Median :4.764               
 Mean   : 6.653                 Mean   :4.723               
 3rd Qu.: 7.548                 3rd Qu.:5.542               
 Max.   :10.529                 Max.   :8.173               
 TemperaturePromedio_Invierno TemperaturePromedio_Verano  mass_balance     
 Min.   :-6.094               Min.   :4.321              Min.   :-2.21700  
 1st Qu.:-4.771               1st Qu.:5.534              1st Qu.:-1.00825  
 Median :-4.151               Median :6.154              Median :-0.56850  
 Mean   :-4.166               Mean   :6.124              Mean   :-0.56877  
 3rd Qu.:-3.575               3rd Qu.:6.649              3rd Qu.:-0.06525  
 Max.   :-2.246               Max.   :8.960              Max.   : 1.30200  </code></pre>
</div>
</div>
</section>
<section id="métricas-de-seleccion-de-variables" class="level2">
<h2 class="anchored" data-anchor-id="métricas-de-seleccion-de-variables">Métricas de seleccion de variables</h2>
<p>###correlación</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: corrplot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.94 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(datos_finales), <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># coeficiente de correlación</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(<span class="at">x=</span>datos_finales, <span class="at">method=</span><span class="st">"pearson"</span>),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               DepthSnowPromedio_Anual RadiationPromedio_Anual
DepthSnowPromedio_Anual                          1.000                  -0.002
RadiationPromedio_Anual                         -0.002                   1.000
PrecipitationPromedio_Anual                      0.429                  -0.235
TemperaturePromedio_Anual                       -0.005                   0.330
DepthSnowPromedio_Invierno                       0.962                   0.006
DepthSnowPromedio_Verano                         0.846                  -0.018
RadiationPromedio_Invierno                      -0.025                   0.897
RadiationPromedio_Verano                         0.021                   0.772
PrecipitationPromedio_Invierno                   0.454                  -0.205
PrecipitationPromedio_Verano                    -0.005                  -0.111
TemperaturePromedio_Invierno                    -0.098                   0.284
TemperaturePromedio_Verano                       0.148                   0.298
mass_balance                                     0.143                  -0.380
                               PrecipitationPromedio_Anual
DepthSnowPromedio_Anual                              0.429
RadiationPromedio_Anual                             -0.235
PrecipitationPromedio_Anual                          1.000
TemperaturePromedio_Anual                           -0.031
DepthSnowPromedio_Invierno                           0.417
DepthSnowPromedio_Verano                             0.356
RadiationPromedio_Invierno                          -0.279
RadiationPromedio_Verano                            -0.096
PrecipitationPromedio_Invierno                       0.913
PrecipitationPromedio_Verano                         0.334
TemperaturePromedio_Invierno                        -0.042
TemperaturePromedio_Verano                          -0.037
mass_balance                                         0.032
                               TemperaturePromedio_Anual
DepthSnowPromedio_Anual                           -0.005
RadiationPromedio_Anual                            0.330
PrecipitationPromedio_Anual                       -0.031
TemperaturePromedio_Anual                          1.000
DepthSnowPromedio_Invierno                        -0.015
DepthSnowPromedio_Verano                           0.022
RadiationPromedio_Invierno                         0.421
RadiationPromedio_Verano                           0.055
PrecipitationPromedio_Invierno                     0.074
PrecipitationPromedio_Verano                      -0.217
TemperaturePromedio_Invierno                       0.909
TemperaturePromedio_Verano                         0.673
mass_balance                                      -0.473
                               DepthSnowPromedio_Invierno
DepthSnowPromedio_Anual                             0.962
RadiationPromedio_Anual                             0.006
PrecipitationPromedio_Anual                         0.417
TemperaturePromedio_Anual                          -0.015
DepthSnowPromedio_Invierno                          1.000
DepthSnowPromedio_Verano                            0.668
RadiationPromedio_Invierno                         -0.037
RadiationPromedio_Verano                            0.058
PrecipitationPromedio_Invierno                      0.433
PrecipitationPromedio_Verano                        0.008
TemperaturePromedio_Invierno                       -0.133
TemperaturePromedio_Verano                          0.198
mass_balance                                        0.084
                               DepthSnowPromedio_Verano
DepthSnowPromedio_Anual                           0.846
RadiationPromedio_Anual                          -0.018
PrecipitationPromedio_Anual                       0.356
TemperaturePromedio_Anual                         0.022
DepthSnowPromedio_Invierno                        0.668
DepthSnowPromedio_Verano                          1.000
RadiationPromedio_Invierno                        0.005
RadiationPromedio_Verano                         -0.058
PrecipitationPromedio_Invierno                    0.393
PrecipitationPromedio_Verano                     -0.032
TemperaturePromedio_Invierno                     -0.007
TemperaturePromedio_Verano                        0.021
mass_balance                                      0.222
                               RadiationPromedio_Invierno
DepthSnowPromedio_Anual                            -0.025
RadiationPromedio_Anual                             0.897
PrecipitationPromedio_Anual                        -0.279
TemperaturePromedio_Anual                           0.421
DepthSnowPromedio_Invierno                         -0.037
DepthSnowPromedio_Verano                            0.005
RadiationPromedio_Invierno                          1.000
RadiationPromedio_Verano                            0.414
PrecipitationPromedio_Invierno                     -0.266
PrecipitationPromedio_Verano                       -0.068
TemperaturePromedio_Invierno                        0.421
TemperaturePromedio_Verano                          0.242
mass_balance                                       -0.331
                               RadiationPromedio_Verano
DepthSnowPromedio_Anual                           0.021
RadiationPromedio_Anual                           0.772
PrecipitationPromedio_Anual                      -0.096
TemperaturePromedio_Anual                         0.055
DepthSnowPromedio_Invierno                        0.058
DepthSnowPromedio_Verano                         -0.058
RadiationPromedio_Invierno                        0.414
RadiationPromedio_Verano                          1.000
PrecipitationPromedio_Invierno                   -0.064
PrecipitationPromedio_Verano                     -0.120
TemperaturePromedio_Invierno                     -0.025
TemperaturePromedio_Verano                        0.242
mass_balance                                     -0.293
                               PrecipitationPromedio_Invierno
DepthSnowPromedio_Anual                                 0.454
RadiationPromedio_Anual                                -0.205
PrecipitationPromedio_Anual                             0.913
TemperaturePromedio_Anual                               0.074
DepthSnowPromedio_Invierno                              0.433
DepthSnowPromedio_Verano                                0.393
RadiationPromedio_Invierno                             -0.266
RadiationPromedio_Verano                               -0.064
PrecipitationPromedio_Invierno                          1.000
PrecipitationPromedio_Verano                           -0.077
TemperaturePromedio_Invierno                           -0.032
TemperaturePromedio_Verano                              0.178
mass_balance                                           -0.110
                               PrecipitationPromedio_Verano
DepthSnowPromedio_Anual                              -0.005
RadiationPromedio_Anual                              -0.111
PrecipitationPromedio_Anual                           0.334
TemperaturePromedio_Anual                            -0.217
DepthSnowPromedio_Invierno                            0.008
DepthSnowPromedio_Verano                             -0.032
RadiationPromedio_Invierno                           -0.068
RadiationPromedio_Verano                             -0.120
PrecipitationPromedio_Invierno                       -0.077
PrecipitationPromedio_Verano                          1.000
TemperaturePromedio_Invierno                         -0.012
TemperaturePromedio_Verano                           -0.485
mass_balance                                          0.320
                               TemperaturePromedio_Invierno
DepthSnowPromedio_Anual                              -0.098
RadiationPromedio_Anual                               0.284
PrecipitationPromedio_Anual                          -0.042
TemperaturePromedio_Anual                             0.909
DepthSnowPromedio_Invierno                           -0.133
DepthSnowPromedio_Verano                             -0.007
RadiationPromedio_Invierno                            0.421
RadiationPromedio_Verano                             -0.025
PrecipitationPromedio_Invierno                       -0.032
PrecipitationPromedio_Verano                         -0.012
TemperaturePromedio_Invierno                          1.000
TemperaturePromedio_Verano                            0.315
mass_balance                                         -0.243
                               TemperaturePromedio_Verano mass_balance
DepthSnowPromedio_Anual                             0.148        0.143
RadiationPromedio_Anual                             0.298       -0.380
PrecipitationPromedio_Anual                        -0.037        0.032
TemperaturePromedio_Anual                           0.673       -0.473
DepthSnowPromedio_Invierno                          0.198        0.084
DepthSnowPromedio_Verano                            0.021        0.222
RadiationPromedio_Invierno                          0.242       -0.331
RadiationPromedio_Verano                            0.242       -0.293
PrecipitationPromedio_Invierno                      0.178       -0.110
PrecipitationPromedio_Verano                       -0.485        0.320
TemperaturePromedio_Invierno                        0.315       -0.243
TemperaturePromedio_Verano                          1.000       -0.668
mass_balance                                       -0.668        1.000</code></pre>
</div>
</div>
<p>Se crea un modelo con todas las variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>full_model<span class="ot">&lt;-</span> <span class="fu">lm</span>(mass_balance<span class="sc">~</span>., <span class="at">data =</span>datos_finales )</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(full_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ ., data = datos_finales)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.86777 -0.35827 -0.00149  0.36182  1.28381 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                       5.753      1.155   4.982 3.92e-06 ***
DepthSnowPromedio_Anual         -33.914     93.374  -0.363    0.717    
RadiationPromedio_Anual           6.075      5.310   1.144    0.256    
PrecipitationPromedio_Anual      -6.183     13.755  -0.450    0.654    
TemperaturePromedio_Anual       -36.214     27.830  -1.301    0.197    
DepthSnowPromedio_Invierno       22.560     61.656   0.366    0.715    
DepthSnowPromedio_Verano         11.729     31.710   0.370    0.713    
RadiationPromedio_Invierno       -4.033      3.506  -1.150    0.254    
RadiationPromedio_Verano         -2.066      1.803  -1.146    0.256    
PrecipitationPromedio_Invierno    3.978      9.072   0.439    0.662    
PrecipitationPromedio_Verano      2.103      4.672   0.450    0.654    
TemperaturePromedio_Invierno     23.996     18.374   1.306    0.196    
TemperaturePromedio_Verano       11.818      9.443   1.252    0.215    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4825 on 75 degrees of freedom
Multiple R-squared:  0.6098,    Adjusted R-squared:  0.5473 
F-statistic: 9.765 on 12 and 75 DF,  p-value: 3.933e-11</code></pre>
</div>
</div>
<p>El modelo con todas las variables introducidas tiene un R2 ajustado=0.5429, lo que quiere decir que es capaz de explicar el 54.29% de la variabilidad observada en el balance de masas y un p-value significativo, por lo que se puede aceptar que el modelo no es por azar.</p>
<section id="aic" class="level3">
<h3 class="anchored" data-anchor-id="aic">AIC</h3>
<p>El AIC (Criterio de Información de Akaike) mide qué tan bien un modelo se ajusta a los datos mientras penaliza la complejidad del modelo (evita sobreajuste).</p>
<p>Un valor de AIC más bajo indica un mejor modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(<span class="at">object =</span> full_model, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-116.34
mass_balance ~ DepthSnowPromedio_Anual + RadiationPromedio_Anual + 
    PrecipitationPromedio_Anual + TemperaturePromedio_Anual + 
    DepthSnowPromedio_Invierno + DepthSnowPromedio_Verano + RadiationPromedio_Invierno + 
    RadiationPromedio_Verano + PrecipitationPromedio_Invierno + 
    PrecipitationPromedio_Verano + TemperaturePromedio_Invierno + 
    TemperaturePromedio_Verano

                                 Df Sum of Sq    RSS     AIC
- DepthSnowPromedio_Anual         1   0.03071 17.489 -118.19
- DepthSnowPromedio_Invierno      1   0.03116 17.490 -118.18
- DepthSnowPromedio_Verano        1   0.03185 17.491 -118.18
- PrecipitationPromedio_Invierno  1   0.04477 17.503 -118.11
- PrecipitationPromedio_Anual     1   0.04704 17.506 -118.10
- PrecipitationPromedio_Verano    1   0.04716 17.506 -118.10
- RadiationPromedio_Anual         1   0.30476 17.763 -116.82
- RadiationPromedio_Verano        1   0.30560 17.764 -116.81
- RadiationPromedio_Invierno      1   0.30807 17.767 -116.80
- TemperaturePromedio_Verano      1   0.36462 17.823 -116.52
- TemperaturePromedio_Anual       1   0.39416 17.853 -116.38
- TemperaturePromedio_Invierno    1   0.39704 17.856 -116.36
&lt;none&gt;                                        17.459 -116.34

Step:  AIC=-118.19
mass_balance ~ RadiationPromedio_Anual + PrecipitationPromedio_Anual + 
    TemperaturePromedio_Anual + DepthSnowPromedio_Invierno + 
    DepthSnowPromedio_Verano + RadiationPromedio_Invierno + RadiationPromedio_Verano + 
    PrecipitationPromedio_Invierno + PrecipitationPromedio_Verano + 
    TemperaturePromedio_Invierno + TemperaturePromedio_Verano

                                 Df Sum of Sq    RSS     AIC
- PrecipitationPromedio_Invierno  1   0.02480 17.514 -120.06
- PrecipitationPromedio_Anual     1   0.02664 17.516 -120.05
- PrecipitationPromedio_Verano    1   0.02671 17.516 -120.05
&lt;none&gt;                                        17.489 -118.19
- DepthSnowPromedio_Invierno      1   0.43935 17.929 -118.00
- TemperaturePromedio_Verano      1   0.54075 18.030 -117.51
- TemperaturePromedio_Anual       1   0.57951 18.069 -117.32
- TemperaturePromedio_Invierno    1   0.58337 18.073 -117.30
+ DepthSnowPromedio_Anual         1   0.03071 17.459 -116.34
- DepthSnowPromedio_Verano        1   0.82910 18.318 -116.11
- RadiationPromedio_Anual         1   0.86143 18.351 -115.95
- RadiationPromedio_Verano        1   0.86359 18.353 -115.94
- RadiationPromedio_Invierno      1   0.86862 18.358 -115.92

Step:  AIC=-120.06
mass_balance ~ RadiationPromedio_Anual + PrecipitationPromedio_Anual + 
    TemperaturePromedio_Anual + DepthSnowPromedio_Invierno + 
    DepthSnowPromedio_Verano + RadiationPromedio_Invierno + RadiationPromedio_Verano + 
    PrecipitationPromedio_Verano + TemperaturePromedio_Invierno + 
    TemperaturePromedio_Verano

                                 Df Sum of Sq    RSS     AIC
- PrecipitationPromedio_Verano    1   0.19664 17.711 -121.08
&lt;none&gt;                                        17.514 -120.06
- DepthSnowPromedio_Invierno      1   0.41489 17.929 -120.00
+ PrecipitationPromedio_Invierno  1   0.02480 17.489 -118.19
+ DepthSnowPromedio_Anual         1   0.01074 17.503 -118.11
- DepthSnowPromedio_Verano        1   0.81167 18.326 -118.07
- PrecipitationPromedio_Anual     1   1.11423 18.628 -116.63
- TemperaturePromedio_Verano      1   1.40727 18.921 -115.26
- RadiationPromedio_Anual         1   1.50850 19.023 -114.79
- RadiationPromedio_Verano        1   1.51254 19.027 -114.77
- RadiationPromedio_Invierno      1   1.51989 19.034 -114.74
- TemperaturePromedio_Anual       1   1.53230 19.046 -114.68
- TemperaturePromedio_Invierno    1   1.53974 19.054 -114.65

Step:  AIC=-121.08
mass_balance ~ RadiationPromedio_Anual + PrecipitationPromedio_Anual + 
    TemperaturePromedio_Anual + DepthSnowPromedio_Invierno + 
    DepthSnowPromedio_Verano + RadiationPromedio_Invierno + RadiationPromedio_Verano + 
    TemperaturePromedio_Invierno + TemperaturePromedio_Verano

                                 Df Sum of Sq    RSS     AIC
&lt;none&gt;                                        17.711 -121.08
- DepthSnowPromedio_Invierno      1   0.50925 18.220 -120.58
+ PrecipitationPromedio_Verano    1   0.19664 17.514 -120.06
+ PrecipitationPromedio_Invierno  1   0.19472 17.516 -120.05
- DepthSnowPromedio_Verano        1   0.67368 18.384 -119.79
+ DepthSnowPromedio_Anual         1   0.00811 17.703 -119.12
- PrecipitationPromedio_Anual     1   0.92016 18.631 -118.62
- TemperaturePromedio_Verano      1   1.35179 19.063 -116.61
- RadiationPromedio_Anual         1   1.45881 19.170 -116.11
- RadiationPromedio_Verano        1   1.46290 19.174 -116.09
- RadiationPromedio_Invierno      1   1.46957 19.180 -116.06
- TemperaturePromedio_Anual       1   1.48297 19.194 -116.00
- TemperaturePromedio_Invierno    1   1.49149 19.202 -115.96</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ RadiationPromedio_Anual + PrecipitationPromedio_Anual + 
    TemperaturePromedio_Anual + DepthSnowPromedio_Invierno + 
    DepthSnowPromedio_Verano + RadiationPromedio_Invierno + RadiationPromedio_Verano + 
    TemperaturePromedio_Invierno + TemperaturePromedio_Verano, 
    data = datos_finales)

Coefficients:
                 (Intercept)       RadiationPromedio_Anual  
                      6.0631                        6.3444  
 PrecipitationPromedio_Anual     TemperaturePromedio_Anual  
                     -0.1283                      -32.4924  
  DepthSnowPromedio_Invierno      DepthSnowPromedio_Verano  
                      0.1729                        0.1852  
  RadiationPromedio_Invierno      RadiationPromedio_Verano  
                     -4.2099                       -2.1578  
TemperaturePromedio_Invierno    TemperaturePromedio_Verano  
                     21.5519                       10.5213  </code></pre>
</div>
</div>
<p>Cada una de las pendientes de un modelo de regresión lineal múltiple (coeficientes parciales de regresión de los predictores) se define del siguiente modo: Si el resto de las variables se mantienen constantes, por cada unidad que aumenta el predictor en cuestión, la variable (Y) varía en promedio tantas unidades como indica la pendiente (Rodrigo, 2016).</p>
<p>Para este ejemplo, por cada unidad que aumenta el predictor de profundidad de nieve en verano, el balance de masas aumenta en promedio 0.1852 unidades, manteniéndose constantes el resto de predictores.</p>
<p>Una vista más a fondo encuentra algunas incongruencias por ejemplo la temperatura. Por cada unidad que aumente la temperatura promedio anual, el balance de masas disminuirá 32,4924 unidades, manteniéndose constantes el resto de predictores. Esto podría ser razonable pero luego se observa que por cada unidad que aumenta la temperatura promedio de invierno o verano, aumenta el balance de masas.</p>
<p>Esto podría ocurrir por la multicolinealidad ya que las temperaturas están correlacionadas y pueden generar coeficientes con signos inesperados. Entonces por ello en el modelo final, se elegirá sólo una variable por temporada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loaded glmnet 4.1-8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(mass_balance <span class="sc">~</span> ., <span class="at">data =</span> datos_finales)[,<span class="sc">-</span><span class="dv">1</span>] <span class="co"># Matriz de predictores</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> datos_finales<span class="sc">$</span>mass_balance</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>lasso_model <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(X, y, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="co"># LASSO usa alpha = 1</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lasso_model, <span class="at">s =</span> <span class="st">"lambda.min"</span>) <span class="co"># Ver variables seleccionadas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13 x 1 sparse Matrix of class "dgCMatrix"
                                         s1
(Intercept)                     4.127679211
DepthSnowPromedio_Anual         0.175257300
RadiationPromedio_Anual        -0.010507165
PrecipitationPromedio_Anual     .          
TemperaturePromedio_Anual       .          
DepthSnowPromedio_Invierno      .          
DepthSnowPromedio_Verano        0.139507548
RadiationPromedio_Invierno     -0.004484644
RadiationPromedio_Verano        .          
PrecipitationPromedio_Invierno -0.076101854
PrecipitationPromedio_Verano    .          
TemperaturePromedio_Invierno    .          
TemperaturePromedio_Verano     -0.433049325</code></pre>
</div>
</div>
</section>
<section id="relación-lineal-entre-los-predictores-numéricos-y-las-variables-respuesta" class="level3">
<h3 class="anchored" data-anchor-id="relación-lineal-entre-los-predictores-numéricos-y-las-variables-respuesta">Relación lineal entre los predictores numéricos y las variables respuesta</h3>
<p>Esta condición se puede validar bien mediante diagramas de dispersión entre la variable dependiente y cada uno de los predictores o con diagramas de dispersión entre cada uno de los predictores y los residuos del modelo. Si la relación es lineal, los residuos deben de distribuirse aleatoriamente en torno a 0 con una variabilidad constante a lo largo del eje X. Esta última opción suele ser más indicada ya que permite identificar posibles datos atípicos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Radiación</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(RadiationPromedio_Anual, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(RadiationPromedio_Invierno, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(RadiationPromedio_Verano, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1,plot2,plot3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precipitacion</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(PrecipitationPromedio_Anual, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(PrecipitationPromedio_Invierno, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(PrecipitationPromedio_Verano, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1,plot2,plot3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperatura</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(TemperaturePromedio_Anual, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(TemperaturePromedio_Invierno, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(TemperaturePromedio_Verano, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1,plot2,plot3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Profundidad de la nieve</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(DepthSnowPromedio_Anual, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(DepthSnowPromedio_Invierno, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(DepthSnowPromedio_Verano, full_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1,plot2,plot3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'
`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se cumple la linealidad para todos los predictores</p>
</section>
</section>
</section>
<section id="modelo-regresión-lineal-múltiple" class="level1">
<h1>Modelo Regresión Lineal Múltiple</h1>
<p>Confirmación del modelo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mass_balance<span class="sc">~</span> DepthSnowPromedio_Verano<span class="sc">+</span>TemperaturePromedio_Verano<span class="sc">+</span>PrecipitationPromedio_Verano<span class="sc">+</span>RadiationPromedio_Anual, <span class="at">data =</span>datos_finales  )</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    PrecipitationPromedio_Verano + RadiationPromedio_Anual, data = datos_finales)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.9466 -0.3926 -0.0637  0.3490  1.4867 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   3.909976   0.874991   4.469 2.47e-05 ***
DepthSnowPromedio_Verano      0.243971   0.078886   3.093   0.0027 ** 
TemperaturePromedio_Verano   -0.456985   0.066776  -6.844 1.23e-09 ***
PrecipitationPromedio_Verano  0.006257   0.053513   0.117   0.9072    
RadiationPromedio_Anual      -0.013698   0.005571  -2.459   0.0160 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5005 on 83 degrees of freedom
Multiple R-squared:  0.5353,    Adjusted R-squared:  0.5129 
F-statistic:  23.9 on 4 and 83 DF,  p-value: 3.578e-13</code></pre>
</div>
</div>
<p>El modelo con las variables elegidas tiene un R2 ajustado=0.5129, lo que quiere decir que es capaz de explicar el 51.29% de la variabilidad observada en el balance de masas y un p-value significativo, por lo que se puede aceptar que el modelo no es por azar.</p>
<p>El valor matemático empleado para determinar la calidad del modelo va a ser Akaike(AIC).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calidad del modelo -&gt;AIC</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(<span class="at">object =</span> best_model, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-116.97
mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    PrecipitationPromedio_Verano + RadiationPromedio_Anual

                               Df Sum of Sq    RSS      AIC
- PrecipitationPromedio_Verano  1    0.0034 20.793 -118.959
&lt;none&gt;                                      20.790 -116.973
- RadiationPromedio_Anual       1    1.5142 22.304 -112.787
- DepthSnowPromedio_Verano      1    2.3958 23.185 -109.375
- TemperaturePromedio_Verano    1   11.7309 32.521  -79.601

Step:  AIC=-118.96
mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    RadiationPromedio_Anual

                               Df Sum of Sq    RSS      AIC
&lt;none&gt;                                      20.793 -118.959
+ PrecipitationPromedio_Verano  1    0.0034 20.790 -116.973
- RadiationPromedio_Anual       1    1.5109 22.304 -114.786
- DepthSnowPromedio_Verano      1    2.3928 23.186 -111.374
- TemperaturePromedio_Verano    1   15.4142 36.207  -72.151</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    RadiationPromedio_Anual, data = datos_finales)

Coefficients:
               (Intercept)    DepthSnowPromedio_Verano  
                   3.95886                     0.24375  
TemperaturePromedio_Verano     RadiationPromedio_Anual  
                  -0.46070                    -0.01367  </code></pre>
</div>
</div>
<p>Segun el Akaike, el mejor modelo es sin incluir la variable de precipitación promedio de verano.</p>
<p>Se hacen pruebas</p>
<section id="mejor-modelo-segun-akaike-aic" class="level4">
<h4 class="anchored" data-anchor-id="mejor-modelo-segun-akaike-aic">Mejor modelo segun Akaike (AIC)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>best_model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mass_balance<span class="sc">~</span> DepthSnowPromedio_Verano<span class="sc">+</span>TemperaturePromedio_Verano<span class="sc">+</span>RadiationPromedio_Anual, <span class="at">data =</span>datos_finales  )</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(best_model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    RadiationPromedio_Anual, data = datos_finales)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.94545 -0.38080 -0.06387  0.34380  1.49556 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 3.958860   0.764122   5.181 1.49e-06 ***
DepthSnowPromedio_Verano    0.243753   0.078400   3.109  0.00256 ** 
TemperaturePromedio_Verano -0.460702   0.058382  -7.891 1.00e-11 ***
RadiationPromedio_Anual    -0.013672   0.005534  -2.471  0.01551 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4975 on 84 degrees of freedom
Multiple R-squared:  0.5352,    Adjusted R-squared:  0.5186 
F-statistic: 32.24 on 3 and 84 DF,  p-value: 5.768e-14</code></pre>
</div>
</div>
<p>El modelo con las variables seleccionadas presenta un R2 ajustado de 0.5186, lo que indica que es capaz de explicar aproximadamente el 51.86% de la variabilidad observada en el balance de masas. Además, el p-value asociado al modelo es significativo, lo que permite concluir que el modelo no es resultado del azar.</p>
<p>Al comparar este R2 ajustado con el del modelo anterior, se observa que es ligeramente superior, aunque solo por unas décimas. Si el objetivo es explicar el balance de masas con el menor número de variables posible, eliminar una de las columnas podría ser una opción recomendable. Esto se debe a que, incluso con una variable menos, el modelo es capaz de explicar prácticamente la misma proporción de variabilidad, e incluso un poco más, lo que sugiere que la variable eliminada no contribuye significativamente a la capacidad explicativa del modelo. En otras palabras, la precipitación no aporta información relevante al balance de masas bajo las condiciones de este estudio.</p>
<p>El mejor modelo es aquel que logra explicar con mayor precisión la variabilidad observada en la variable respuesta utilizando el menor número de predictores posibles, reduciendo así la complejidad y las asunciones del modelo.</p>
<p>Aunque el AIC recomienda eliminar la precipitación, hay razones sólidas para mantenerla. Desde un enfoque teórico, la precipitación es un factor climático clave que, aunque no sea estadísticamente significativa en este modelo, tiene un impacto potencial sobre el balance de masas. Su inclusión asegura que el modelo refleje de manera más completa las variables climáticas relevantes, lo que es crucial para su interpretación en otros contextos o estudios futuros. Además, el AIC no debe ser el único criterio: la relevancia teórica de la precipitación justifica su presencia, incluso si su contribución no es evidente en estos datos. Mantenerla enriquece el modelo y lo hace más robusto para representar los procesos subyacentes.</p>
</section>
<section id="distribuccion-normal-de-los-residuos" class="level3">
<h3 class="anchored" data-anchor-id="distribuccion-normal-de-los-residuos">Distribuccion normal de los residuos</h3>
<p>Test de Jarque Bera El test de Jarque-Bera es una prueba de hipótesis que se basa en dos propiedades de la distribución normal: (Jarque, 1980) Asimetría (skewness): Mide la falta de simetría en la distribución de los datos. En una distribución normal, la asimetría es 0. Curtosis (kurtosis): Mide la “cola” de la distribución, es decir, cuánta masa se concentra en las colas en comparación con una distribución normal. En una distribución normal, la curtosis es 3.</p>
<p>Hipótesis del test: 〖Hipotesis nula (H〗_0):Los datos siguen una distribucción normal 〖Hipotesis alternativa (H〗_1):Los datos no siguen una distribucción normal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(best_model<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  best_model$residuals
X-squared = 2.5294, df = 2, p-value = 0.2823</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 2.5294 y un p-value = 0.2823 Dado que el p-value es mayor que 0.05, no hay evidencia suficiente para rechazar la hipótesis nula, lo que indica que los residuos siguen una distribución normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-52-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-52-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>interpretacion del Gráfico Q-Q El Q-Q plot compara los cuantiles de los residuos observados con los cuantilres de una distribución normal teórica. Si los puntos siguen aproximadamente la línea diagonal, los residuos se distribuyen normalmente. En este cso los residuos se alinean basntante bien con la línea, con algunas desviaciones leves en los extremos.</p>
</section>
<section id="variabilidad-constante-de-los-residuos-homocedasticidad" class="level3">
<h3 class="anchored" data-anchor-id="variabilidad-constante-de-los-residuos-homocedasticidad">Variabilidad constante de los residuos (homocedasticidad)</h3>
<p>Este análisis evalúa si los residuales del modelo (best_model) presentan homocedasticidad, es decir, si la varianza de los errores es constante a lo largo de los valores ajustados.</p>
<p>Al representar los residuos frente a los valores ajustados por el modelo, los primeros se tienen que distribuir de forma aleatoria en torno a cero, manteniendo aproximadamente la misma variabilidad a lo largo del eje X. Si se observa algún patrón específico, por ejemplo forma cónica o mayor dispersión en los extremos, significa que la variabilidad es dependiente del valor ajustado y por lo tanto no hay homocedasticidad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> datos_finales, <span class="fu">aes</span>(best_model<span class="sc">$</span>fitted.values, best_model<span class="sc">$</span>residuals)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">color =</span> <span class="st">"firebrick"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La línea roja muestra una tendencia no completamente plana, lo que podría indicar cierta variación en la dispersión de los residuos. Sin embargo, no hay una tendencia clara de expansión o contracción de los residuos en función de los valores ajustados, lo que sugiere que la variabilidad se mantiene relativamente constante.</p>
</section>
<section id="homocedasticidad" class="level3">
<h3 class="anchored" data-anchor-id="homocedasticidad">Homocedasticidad</h3>
<p>Test de Breusch-Pagan</p>
<p>Hipótesis nula (H₀): Los errores tienen varianza constante (homocedasticidad). Hipótesis alternativa (H₁): Los errores presentan heterocedasticidad (varianza no constante).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  best_model
BP = 3.0785, df = 4, p-value = 0.5448</code></pre>
</div>
</div>
<p>no hay suficiente evidencia para afirmar que existe heterocedasticidad. Se puede asumir que los residuos cumplen con la homocedasticidad.</p>
<p>luego, No hay evidencias de falta de homocedasticidad.</p>
</section>
<section id="análisis-de-inflación-de-varianza-vif" class="level3">
<h3 class="anchored" data-anchor-id="análisis-de-inflación-de-varianza-vif">Análisis de Inflación de Varianza (VIF)</h3>
<p>El VIF (Variance Inflation Factor) es una métrica utilizada para detectar la presencia de colinealidad entre las variables independientes de un modelo de regresión. Un valor elevado de VIF indica que una variable está altamente correlacionada con otra(s), lo que puede afectar la estabilidad y la interpretabilidad de los coeficientes del modelo. Criterios: • VIF &lt; 5 → No hay colinealidad problemática. • VIF entre 5 y 10 → Existe moderada colinealidad, revisar la variable. • VIF &gt; 10 → Alta colinealidad, la variable debería ser reconsiderada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    DepthSnowPromedio_Verano   TemperaturePromedio_Verano 
                    1.001622                     1.419770 
PrecipitationPromedio_Verano      RadiationPromedio_Anual 
                    1.310528                     1.099729 </code></pre>
</div>
</div>
<p>En este caso, todos los valores de VIF obtenidos están muy por debajo de 5. Esto indica que no existe colinealidad problemática entre las variables independientes del modelo, lo que confirma la robustez y la adecuación de la estructura del modelo propuesto.</p>
</section>
<section id="autocorrelación" class="level3">
<h3 class="anchored" data-anchor-id="autocorrelación">Autocorrelación</h3>
<p>Test de Box-Ljung El test de Box-Ljung es una prueba estadística utilizada para evaluar si los residuos de un modelo de series temporales son independientes (es decir, si no hay autocorrelación). (Box, 1970)</p>
<p>Hipotesis nula (H0):No hay autocorrelación en los residuos Hipotesis alternativa (H1):Existe autocorrelacion en los residuos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(best_model<span class="sc">$</span>residuals, <span class="at">lag =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Ljung test

data:  best_model$residuals
X-squared = 39.61, df = 20, p-value = 0.005593</code></pre>
</div>
</div>
<p>El estadístico del test fue X-squared = 39.61 con 20 grados de libertad, y se obtuvo un p-value = 0.0056. Dado que el p-value es inferior al nivel de significancia de 0.05, se rechaza la hipótesis nula de que no existe autocorrelación en los residuos. Por lo tanto, se concluye que existe evidencia significativa de autocorrelación en los residuos del modelo, lo cual sugiere que el supuesto de independencia no se cumple completamente y podría ser necesario considerar un modelo alternativo que tenga en cuenta esta dependencia temporal o estructural. ### Resumen del modelo (MLR)</p>
<p>El modelo con las variables elegidas tiene un R2 ajustado=0.5129, lo que quiere decir que es capaz de explicar el 51.29% de la variabilidad observada en el balance de masas y un p-value significativo, por lo que se puede aceptar que el modelo no es por azar.En cuanto a los residuos, cumple con el supuesto de homocedasticidad y distribucción normal, pero existe evidencia significativa de autocorrelación en los residuos del modelo, lo cual sugiere que el supuesto de independencia no se cumple completamente y podría ser necesario considerar un modelo alternativo que tenga en cuenta esta dependencia temporal o estructural.</p>
</section>
</section>
<section id="modelo-de-regresión-lineal-múltiple-con-componente-autorregresiva-mlr-ar" class="level1">
<h1>Modelo de regresión lineal múltiple con componente autorregresiva (MLR-AR)</h1>
<p>Siguiendo la sugerencia de los resultados anteriores, se crea otro modelo que tiene en cuenta la dependencia temporal de la variable dependendiente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear variable rezagada (lag 1) de la variable dependiente</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>datos_finales <span class="ot">&lt;-</span> datos_finales <span class="sc">%&gt;%</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mass_balance_lag1 =</span> <span class="fu">lag</span>(mass_balance, <span class="dv">1</span>))</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminar la primera fila con NA en mass_balance_lag1 (por el lag)</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>datos_finales_limpio <span class="ot">&lt;-</span> datos_finales <span class="sc">%&gt;%</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(mass_balance_lag1))</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el nuevo modelo con la variable de rezago incluida</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>modelo_corrigido <span class="ot">&lt;-</span> <span class="fu">lm</span>(mass_balance <span class="sc">~</span> </span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>                         DepthSnowPromedio_Verano <span class="sc">+</span> </span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>                         TemperaturePromedio_Verano <span class="sc">+</span> </span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>                         PrecipitationPromedio_Verano <span class="sc">+</span> </span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>                         RadiationPromedio_Anual <span class="sc">+</span> </span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>                         mass_balance_lag1,</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> datos_finales_limpio)</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_corrigido)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    PrecipitationPromedio_Verano + RadiationPromedio_Anual + 
    mass_balance_lag1, data = datos_finales_limpio)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.85923 -0.34644  0.02261  0.31385  1.40225 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   3.384133   0.890831   3.799  0.00028 ***
DepthSnowPromedio_Verano      0.234066   0.077245   3.030  0.00328 ** 
TemperaturePromedio_Verano   -0.431761   0.066063  -6.536 5.23e-09 ***
PrecipitationPromedio_Verano  0.026643   0.052879   0.504  0.61574    
RadiationPromedio_Anual      -0.010989   0.005548  -1.981  0.05099 .  
mass_balance_lag1             0.154036   0.077891   1.978  0.05138 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4846 on 81 degrees of freedom
Multiple R-squared:  0.5629,    Adjusted R-squared:  0.536 
F-statistic: 20.87 on 5 and 81 DF,  p-value: 2.437e-13</code></pre>
</div>
</div>
<p>Se puede observar que añadiendo la variable de autoregresión se obtiene un R2 ajustado=0.536, lo que quiere decir que es capaz de explicar el 53.6% de la variabilidad observada en el balance de masas y un p-value significativo, por lo que se puede aceptar que el modelo no es por azar.</p>
<section id="aic-1" class="level3">
<h3 class="anchored" data-anchor-id="aic-1">AIC</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calidad del modelo -&gt;AIC</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">step</span>(<span class="at">object =</span> modelo_corrigido, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-120.25
mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    PrecipitationPromedio_Verano + RadiationPromedio_Anual + 
    mass_balance_lag1

                               Df Sum of Sq    RSS      AIC
- PrecipitationPromedio_Verano  1    0.0596 19.085 -121.980
&lt;none&gt;                                      19.025 -120.252
- mass_balance_lag1             1    0.9186 19.944 -118.150
- RadiationPromedio_Anual       1    0.9217 19.947 -118.136
- DepthSnowPromedio_Verano      1    2.1567 21.182 -112.910
- TemperaturePromedio_Verano    1   10.0327 29.058  -85.405

Step:  AIC=-121.98
mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    RadiationPromedio_Anual + mass_balance_lag1

                               Df Sum of Sq    RSS      AIC
&lt;none&gt;                                      19.085 -121.980
+ PrecipitationPromedio_Verano  1    0.0596 19.025 -120.252
- mass_balance_lag1             1    0.8619 19.947 -120.137
- RadiationPromedio_Anual       1    0.9258 20.011 -119.859
- DepthSnowPromedio_Verano      1    2.1336 21.219 -114.760
- TemperaturePromedio_Verano    1   14.3702 33.455  -75.146</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    RadiationPromedio_Anual + mass_balance_lag1, data = datos_finales_limpio)

Coefficients:
               (Intercept)    DepthSnowPromedio_Verano  
                   3.61162                     0.23266  
TemperaturePromedio_Verano     RadiationPromedio_Anual  
                  -0.44831                    -0.01101  
         mass_balance_lag1  
                   0.14622  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar el nuevo modelo con la variable de rezago incluida</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>modelo_corrigido1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mass_balance <span class="sc">~</span> </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>                         DepthSnowPromedio_Verano <span class="sc">+</span> </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>                         TemperaturePromedio_Verano <span class="sc">+</span> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>                         RadiationPromedio_Anual <span class="sc">+</span> </span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>                         mass_balance_lag1,</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> datos_finales_limpio)</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_corrigido1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass_balance ~ DepthSnowPromedio_Verano + TemperaturePromedio_Verano + 
    RadiationPromedio_Anual + mass_balance_lag1, data = datos_finales_limpio)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.85784 -0.33116 -0.00353  0.28290  1.42855 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 3.611619   0.764434   4.725 9.42e-06 ***
DepthSnowPromedio_Verano    0.232659   0.076843   3.028  0.00329 ** 
TemperaturePromedio_Verano -0.448313   0.057054  -7.858 1.34e-11 ***
RadiationPromedio_Anual    -0.011014   0.005522  -1.994  0.04942 *  
mass_balance_lag1           0.146224   0.075984   1.924  0.05777 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4824 on 82 degrees of freedom
Multiple R-squared:  0.5616,    Adjusted R-squared:  0.5402 
F-statistic: 26.26 on 4 and 82 DF,  p-value: 4.993e-14</code></pre>
</div>
</div>
</section>
<section id="autocorrelación-1" class="level3">
<h3 class="anchored" data-anchor-id="autocorrelación-1">Autocorrelación</h3>
<p>Tras incorporar un rezago de la variable dependiente (mass_balance) al modelo de regresión lineal múltiple, se aplicó nuevamente el test de Ljung-Box para evaluar la autocorrelación en los residuos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(<span class="fu">residuals</span>(modelo_corrigido), <span class="at">lag =</span> <span class="dv">20</span>, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Ljung test

data:  residuals(modelo_corrigido)
X-squared = 22.872, df = 20, p-value = 0.2951</code></pre>
</div>
</div>
<p>El resultado obtenido fue X-squared = 22.872, con 20 grados de libertad y un p-value = 0.2951. Dado que el p-value es superior al umbral de significancia (0.05), no se rechaza la hipótesis nula de independencia. Por lo tanto, se concluye que no existe evidencia estadísticamente significativa de autocorrelación en los residuos del modelo corregido. Esto indica que la inclusión del componente autorregresivo ha sido efectiva para capturar la dependencia temporal detectada previamente, mejorando el cumplimiento de los supuestos clásicos del modelo de regresión.</p>
</section>
<section id="homocedasticidad-1" class="level3">
<h3 class="anchored" data-anchor-id="homocedasticidad-1">Homocedasticidad</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(modelo_corrigido)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  modelo_corrigido
BP = 3.5641, df = 5, p-value = 0.6137</code></pre>
</div>
</div>
<p>El resultado fue BP = 3.5641, con 5 grados de libertad y un p-value = 0.6137. Dado que el p-value es muy superior al nivel de significancia convencional (0.05), no hay evidencia suficiente para rechazar la hipótesis nula de homocedasticidad. En consecuencia, No hay evidencia de falta de homocedasticidad</p>
</section>
<section id="distribuccion-normal-de-los-residuos-1" class="level3">
<h3 class="anchored" data-anchor-id="distribuccion-normal-de-los-residuos-1">Distribuccion normal de los residuos</h3>
<p>Test de Jarque Bera</p>
<p>Hipótesis del test: Hipotesis nula (H0):Los datos siguen una distribucción normal Hipotesis alternativa (H1):Los datos no siguen una distribucción normal</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(modelo_corrigido<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  modelo_corrigido$residuals
X-squared = 4.5255, df = 2, p-value = 0.1041</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 4.5255 y un p-value = 0.1041 Dado que el p-value es mayor que 0.05, no hay evidencia suficiente para rechazar la hipótesis nula, lo que indica que los residuos siguen una distribución normal.</p>
</section>
<section id="estacionareidad-de-los-residuos" class="level3">
<h3 class="anchored" data-anchor-id="estacionareidad-de-los-residuos">Estacionareidad de los residuos</h3>
<p>Hipótesis nula (H₀): Los residuos tienen una raíz unitaria, es decir, no son estacionarios. Hipótesis alternativa (H₁): Los residuos son estacionarios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(modelo_corrigido<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  modelo_corrigido$residuals
Dickey-Fuller = -3.1038, Lag order = 4, p-value = 0.1224
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>El resultado de la prueba de Dickey-Fuller aumentada (ADF) muestra un estadístico de Dickey-Fuller = -3.1038 y un p-value = 0.1224. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que los residuos no son estacionarios.</p>
<p>Esto indica que, a pesar de la incorporación de un componente autorregresivo en el modelo, los residuos aún presentan dependencia temporal no capturada correctamente, lo que sugiere la necesidad de ajustes adicionales en la estructura del modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(modelo_corrigido)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-64-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-64-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-64-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="correlación-cruzada" class="level2">
<h2 class="anchored" data-anchor-id="correlación-cruzada">Correlación cruzada</h2>
<p>En la correlación cruzada, se analiza la relación entre dos variables en diferentes desfases de tiempo (lags), es decir, cómo una variable influye en otra con cierto retraso o anticipación.</p>
<p>La magnitud de la función de correlación cruzada (CCF) indica qué tan fuerte es la relación entre las variables en cada lag. Si los valores de correlación son altos tanto en lags positivos como negativos, esto sugiere una relación bidireccional, lo que significa que ambas variables pueden influirse mutuamente con cierto desfase en el tiempo. Si la correlación es fuerte solo en los lags positivos, la variable X afecta a la variable Y con un retraso (X precede a Y). Si la correlación es fuerte solo en los lags negativos, la variable Y podría estar afectando a X en el pasado (Y precede a X), lo que indica una relación unidireccional en sentido contrario.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Temperatura</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(datos_finales<span class="sc">$</span>mass_balance  , datos_finales<span class="sc">$</span>TemperaturePromedio_Verano, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="st">"Correlación Cruzada entre Balance de masa-Temperatura"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Los valores significativos son aquellos que se encuentran fuera de las líneas azules. Se observa que la mayoría de los coeficientes significativos son negativos, lo que indica una correlación inversa entre la temperatura y el balance de masas: a mayor temperatura, menor balance de masas. Esto sugiere una relación fuerte y consistente a lo largo del tiempo. Además, los valores de correlación son más fuertes en los lags negativos, lo que significa que la temperatura en el pasado influye en el balance de masas en el presente. Por otro lado, no se detectan valores significativos en los lags positivos, lo que confirma que la relación es unidireccional: la temperatura afecta al balance de masas, pero el balance de masas no tiene un impacto significativo sobre la temperatura.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Radiación</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(datos_finales<span class="sc">$</span>mass_balance  , datos_finales<span class="sc">$</span>RadiationPromedio_Anual, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="st">"Correlación Cruzada entre Balance de masa-Radiación"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La mayoría de los coeficientes de correlación son negativos, lo que indica que una mayor radiación solar está asociada con una reducción en el balance de masa glaciar. Esto coincide con análisis previos, donde se concluye que a mayor radiación, mayor derretimiento glaciar.</p>
<p>Algunos valores en lags negativos son más pronunciados y caen fuera de las líneas azules, sugiriendo que la radiación en el pasado influyó en la disminución del balance de masa en el presente. No se observan correlaciones positivas destacadas, lo que confirma que la relación es unidireccional: el balance de masa no afecta a la radiación, ya que esta es un factor climático externo.</p>
<p>La correlación negativa en varios lags indica que la radiación no solo impacta el balance de masa en el mismo período, sino que su efecto persiste en el tiempo. Esto podría explicarse porque la radiación provoca la fusión del hielo, y su impacto en el balance de masa no es inmediato, sino que se acumula gradualmente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Profundidad de la nieve</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(datos_finales<span class="sc">$</span>mass_balance,datos_finales<span class="sc">$</span>DepthSnowPromedio_Verano, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="st">"Correlación Cruzada entre Balance de masa-Profundidad de la nieve"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La mayoría de los coeficientes están cerca de 0, lo que sugiere que la profundidad de la nieve no tiene un impacto claro en el balance de masas a lo largo del tiempo. Sin embargo, en lag 0, hay un pico positivo, indicando que una mayor profundidad de nieve en el presente está asociada con un balance de masas más alto. Esto tiene sentido, ya que una mayor acumulación de nieve puede contribuir temporalmente a un balance positivo.</p>
<p>A partir de lags positivos, se observa una tendencia hacia correlaciones negativas, sugiriendo que una gran acumulación de nieve en el presente podría reducir el balance de masas en el futuro, posiblemente debido al derretimiento en los años siguientes. Por otro lado, no hay una correlación fuerte en lags negativos, lo que indica que el balance de masas actual no está influenciado significativamente por la profundidad de la nieve en el pasado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Precipitación</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ccf</span>(datos_finales<span class="sc">$</span>mass_balance, datos_finales<span class="sc">$</span>PrecipitationPromedio_Verano, <span class="at">lag.max =</span> <span class="dv">10</span>, <span class="at">main =</span> <span class="st">"Correlación Cruzada entre Balance de masa-Precipitación"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Se observa un pico positivo en lag 0, lo que indica que una mayor precipitación en el presente está asociada con un balance de masa más alto. Además, hay algunos valores positivos en lags positivos (futuros), aunque ninguno supera el umbral de significancia (líneas azules). Esto sugiere que la precipitación en el presente podría tener un efecto leve pero prolongado en el aumento del balance de masa en el futuro. Sin embargo, dado que las correlaciones no son fuertes, su impacto a largo plazo parece limitado.</p>
<p>No se detectan correlaciones significativas en lags negativos, lo que indica que el balance de masa actual no está influenciado por la precipitación pasada. A diferencia de variables como la radiación o la temperatura, cuyos efectos pueden ser retardados, la precipitación afecta principalmente el balance de masa en el mismo período en que ocurre. Esto tiene sentido, ya que la acumulación de nieve o lluvia tiene un impacto inmediato en la masa del glaciar.</p>
</section>
</section>
<section id="análisis-arimax" class="level1">
<h1>Análisis ARIMAX</h1>
<p>Los modelos SARIMAX (Autoregresivo integrados de medias moviles estacional con variables explicativas) son una estructura matetemática que contiene todas las bondades de un modelo SARIMA adicionalmente, adicionalmente, pueden capturar informacion sobre variables exógeneas que permiten. Dentro del modelo MAX puede ser ARMAX o ARIMAX</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se separan los datos en dos tablas, una de variables exogeneas y otras de variables endogenas</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>data_exo<span class="ot">&lt;-</span>datos_finales[, <span class="fu">c</span>(<span class="st">"DepthSnowPromedio_Verano"</span>, </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"TemperaturePromedio_Verano"</span>, <span class="st">"PrecipitationPromedio_Verano"</span>, </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>                                                <span class="st">"RadiationPromedio_Anual"</span>)]</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>data_endo<span class="ot">&lt;-</span>datos_finales[, <span class="fu">c</span>(<span class="st">"mass_balance"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variables endógenas. Son aquellas que se determinan dentro del modelo o sistema que se está analizando. Su valor depende de las interacciones y relaciones entre otras variables del modelo</p>
<p>Variables exógenas. Son aquellas que se determinan fuera del modelo o sistema y se toman como dadas. Su valor no depende de las relaciones internas del modelo, sino que influye en él desde el exterior</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Serie temporal de variable dependiente </span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>endo_ts<span class="ot">&lt;-</span> <span class="fu">ts</span>(data_endo, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1934</span>), <span class="at">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Serie temporal de las vairables independientes</span></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>exo_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(data_exo, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1934</span>), <span class="at">frequency =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="análisis-de-la-variable-endógena-arima" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-la-variable-endógena-arima">Análisis de la variable Endógena /ARIMA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Prueba de Dickey-Fuller</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(endo_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  endo_ts
Dickey-Fuller = -2.7746, Lag order = 4, p-value = 0.2576
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>p-value&gt;0.05 entonces no es estacionaria</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>dendo_ts<span class="ot">&lt;-</span><span class="fu">diff</span>(endo_ts)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prueba de dickeyfuller a la serie diferenciada</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(dendo_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  dendo_ts
Dickey-Fuller = -5.7243, Lag order = 4, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>pvalue significativo, por tanto es estacionaria.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(endo_ts),<span class="at">main=</span><span class="st">"Autocorrelacion"</span>,  <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">diff</span>(endo_ts),<span class="at">main=</span><span class="st">"Autocorrelacion Parcial"</span>,  <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(endo_ts,<span class="at">trace =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 ARIMA(2,1,2) with drift         : 175.412
 ARIMA(0,1,0) with drift         : 221.1106
 ARIMA(1,1,0) with drift         : 198.0066
 ARIMA(0,1,1) with drift         : 174.1826
 ARIMA(0,1,0)                    : 219.0536
 ARIMA(1,1,1) with drift         : 175.6692
 ARIMA(0,1,2) with drift         : 175.4915
 ARIMA(1,1,2) with drift         : 177.6543
 ARIMA(0,1,1)                    : 172.4654
 ARIMA(1,1,1)                    : 173.7955
 ARIMA(0,1,2)                    : 173.5776
 ARIMA(1,1,0)                    : 195.9034
 ARIMA(1,1,2)                    : 175.6612

 Best model: ARIMA(0,1,1)                    </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: endo_ts 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.8319
s.e.   0.0570

sigma^2 = 0.4045:  log likelihood = -84.16
AIC=172.32   AICc=172.47   BIC=177.25</code></pre>
</div>
</div>
<section id="arima011." class="level3">
<h3 class="anchored" data-anchor-id="arima011.">ARIMA(0,1,1).</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>arima011<span class="ot">&lt;-</span><span class="fu">Arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">include.constant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arima011)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: endo_ts 
ARIMA(0,1,1) with drift 

Coefficients:
          ma1    drift
      -0.8471  -0.0079
s.e.   0.0598   0.0113

sigma^2 = 0.4068:  log likelihood = -83.95
AIC=173.89   AICc=174.18   BIC=181.29

Training set error measures:
                     ME      RMSE     MAE MPE MAPE    MASE        ACF1
Training set 0.03162674 0.6268702 0.49235 Inf  Inf 0.73892 -0.05204551</code></pre>
</div>
</div>
<p>Inicialmente, se analiza el modelo incluyendo un drift, el cual equivale a incorporar una pendiente en la serie. El valor estimado del drift es de -0.0079, lo que indica que, en promedio, la serie disminuye en 0.0079 unidades por período después de haber sido diferenciada. No obstante, su error estándar es de 0.0113, lo que sugiere que su impacto en la predicción es mínimo, dado que el valor del drift es cercano a cero.</p>
<p>Para evaluar la significancia del drift, se lleva a cabo la prueba de Wald, una prueba estadística utilizada para determinar si los coeficientes estimados en un modelo son significativos. En términos generales: si el drift es significativo (valor p &lt; 0.05), se incluye en el modelo. si no es significativo (valor p ≥ 0.05), se considera eliminarlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima011), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima011), <span class="at">Terms =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 200.7, df = 1, P(&gt; X2) = 0.0</code></pre>
</div>
</div>
<p>En este caso, se obtiene un p-value de 0.0, lo que indica que el drift es altamente significativo y, en principio, debería incluirse en el modelo. Sin embargo, para contrastar este resultado, se realiza un análisis excluyendo el drift.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>arima<span class="fl">.011</span><span class="ot">&lt;-</span><span class="fu">Arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">include.constant =</span> <span class="cn">FALSE</span>)</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arima<span class="fl">.011</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: endo_ts 
ARIMA(0,1,1) 

Coefficients:
          ma1
      -0.8319
s.e.   0.0570

sigma^2 = 0.4045:  log likelihood = -84.16
AIC=172.32   AICc=172.47   BIC=177.25

Training set error measures:
                      ME      RMSE       MAE MPE MAPE     MASE        ACF1
Training set -0.01044462 0.6287321 0.4971122 Inf  Inf 0.746067 -0.05919192</code></pre>
</div>
</div>
<p>Al hacerlo, se observa que el modelo sin drift presenta un AIC más bajo (172.32 frente a 173.89 del modelo con drift), lo que indica que es más eficiente en términos de ajuste y parsimonia. Además, el BIC también es menor en el modelo sin drift, lo que refuerza la preferencia por este modelo. Al no incluir el drift, se evita añadir un parámetro innecesario, simplificando el modelo sin perder capacidad predictiva.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima<span class="fl">.011</span>), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima<span class="fl">.011</span>), <span class="at">Terms =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 213.3, df = 1, P(&gt; X2) = 0.0</code></pre>
</div>
</div>
<p>En conclusión, aunque el drift es estadísticamente significativo, el AIC más bajo del modelo sin drift sugiere que este último es preferible. Por lo tanto, se recomienda utilizar el modelo ARIMA(0,1,1) sin drift.</p>
<section id="validacion-del-modelo-arima011" class="level4">
<h4 class="anchored" data-anchor-id="validacion-del-modelo-arima011">Validacion del modelo arima011</h4>
<section id="intervencion" class="level5">
<h5 class="anchored" data-anchor-id="intervencion">Intervencion</h5>
<p>Se analiza si para algun periodo se observa un error atípico (2 o 3 veces superior al error estándar).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>es<span class="ot">&lt;-</span><span class="fu">sqrt</span>(arima<span class="fl">.011</span><span class="sc">$</span>sig) </span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(arima<span class="fl">.011</span><span class="sc">$</span>residuals,<span class="dv">2</span><span class="sc">*</span>es,<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>es,<span class="dv">3</span><span class="sc">*</span>es,<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>es,<span class="at">xlab=</span><span class="st">"Periodo"</span>,<span class="at">plot.type=</span><span class="st">"single"</span>,<span class="at">ylab=</span><span class="st">""</span>, <span class="at">main=</span><span class="st">"Error de estimacion"</span>,<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"blue"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La mayoría de los residuos permanecen dentro del rango de ±2σ (rojo), lo que indica que el modelo capta bien la variabilidad de la serie. Sólo algunos valores extremos están cerca de los límites ±3σ (azul), lo cual es normal en cualquier serie temporal.</p>
</section>
<section id="autocorrelación-2" class="level5">
<h5 class="anchored" data-anchor-id="autocorrelación-2">Autocorrelación</h5>
<p>Para analizar la autocorrelación de los residuos, se aplica la prueba de Ljung-Box, la cual evalúa si los residuos del modelo presentan autocorrelación significativa o si pueden considerarse ruido blanco (es decir, si el modelo captura adecuadamente la estructura de los datos). Criterios: • p-value &lt; 0.05, los residuos no son ruido blanco, lo que indica que el modelo no captura toda la estructura de los datos y existe autocorrelación • p-value &gt; 0.05, los residuos son ruido blanco, lo que indica que el modelo captura bien la estructura de los datos y no hay autocorrelación significativa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(arima<span class="fl">.011</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,1)
Q* = 9.4145, df = 9, p-value = 0.3999

Model df: 1.   Total lags used: 10</code></pre>
</div>
</div>
<p>En este caso, dado que el p-value = 0.3999, se concluye que los residuos no presentan autocorrelación significativa, lo que indica que el modelo ARIMAX (0,1,1) es adecuado para representar la serie temporal.</p>
</section>
<section id="homocedasticidad-2" class="level5">
<h5 class="anchored" data-anchor-id="homocedasticidad-2">Homocedasticidad</h5>
<p>Para evaluar la homocedasticidad (es decir, si la varianza de los residuos es constante a lo largo del tiempo), se aplica la prueba de Box-Ljung a los residuos al cuadrado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(arima<span class="fl">.011</span><span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag=</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Ljung test

data:  arima.011$residuals^2
X-squared = 1.2258, df = 2, p-value = 0.5418</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 1.2258 con 2 grados de libertad y un p-value = 0.5418. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que no hay evidencia de heterocedasticidad en los residuos. Esto indica que la varianza de los residuos se mantiene constante, cumpliendo con el supuesto de homocedasticidad.</p>
</section>
<section id="normalidad" class="level5">
<h5 class="anchored" data-anchor-id="normalidad">Normalidad</h5>
<p>Para evaluar la normalidad de los residuos, se aplica la prueba de Jarque-Bera</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(arima<span class="fl">.011</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  arima.011$residuals
X-squared = 1.1378, df = 2, p-value = 0.5661</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 1.1378 con 2 grados de libertad y un p-value = 0.5661. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que los residuos siguen una distribución normal. Esto indica que el modelo cumple con el supuesto de normalidad en los residuos, lo cual es deseable para la validez de las inferencias estadísticas.</p>
</section>
<section id="estacionariedad-de-los-residuos" class="level5">
<h5 class="anchored" data-anchor-id="estacionariedad-de-los-residuos">Estacionariedad de los residuos</h5>
<p>Para evaluar la estacionariedad de los residuos y asegurar que se comporten como ruido blanco, se aplica la prueba de Dickey-Fuller aumentada (ADF). Esta prueba tiene como hipótesis:</p>
<p>• Hipótesis nula (H₀): Los residuos no se comportan como ruido blanco (no son estacionarios). • Hipótesis alternativa (H₁): Los residuos se comportan como ruido blanco (son estacionarios).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(arima<span class="fl">.011</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  arima.011$residuals
Dickey-Fuller = -3.6123, Lag order = 4, p-value = 0.03691
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>El resultado de la prueba muestra un estadístico de Dickey-Fuller = -3.6123 y un p-value = 0.03691 Dado que el p-value es menor que 0.05,hay evidencia sufiente para rechazar la hipótesis nula, lo que sugiere que los residuos son estacionarios y, por lo tanto, se comportan completamente como ruido blanco (sin patrones estructurados).</p>
</section>
</section>
<section id="arima111" class="level4">
<h4 class="anchored" data-anchor-id="arima111">ARIMA(111)</h4>
<p>Este modelo ARIMA(1,1,1) es ligeramente más complejo que el anterior, ya que incluye un componente autorregresivo (p=1) y un componente de media móvil (q=1). Esta mayor complejidad podría ser útil si existe una dependencia temporal que el modelo anterior no logra capturar completamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>arima111<span class="ot">&lt;-</span><span class="fu">Arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">include.constant =</span> <span class="cn">TRUE</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arima111)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: endo_ts 
ARIMA(1,1,1) with drift 

Coefficients:
          ar1      ma1    drift
      -0.1112  -0.8139  -0.0073
s.e.   0.1306   0.0800   0.0121

sigma^2 = 0.4083:  log likelihood = -83.59
AIC=175.18   AICc=175.67   BIC=185.05

Training set error measures:
                     ME      RMSE       MAE  MPE MAPE      MASE       ACF1
Training set 0.02927059 0.6242836 0.4888092 -Inf  Inf 0.7336059 0.01431708</code></pre>
</div>
</div>
<p>Inicialmente, se analiza el modelo incluyendo un drift, el cual equivale a incorporar una pendiente en la serie. El valor estimado del drift es de -0.0073, lo que indica que, en promedio, la serie disminuye en 0.0073 unidades por período después de haber sido diferenciada. No obstante, su error estándar es de 0.0121, lo que sugiere que su impacto en la predicción es mínimo, dado que el valor del drift es cercano a cero.</p>
<p>Para evaluar la significancia del drift, se lleva a cabo la prueba de Wald, una prueba estadística utilizada para determinar si los coeficientes estimados en un modelo son significativos. En términos generales: si el drift es significativo (valor p &lt; 0.05), se incluye en el modelo. si no es significativo (valor p ≥ 0.05), se considera eliminarlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima111), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima111), <span class="at">Terms =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 0.73, df = 1, P(&gt; X2) = 0.39</code></pre>
</div>
</div>
<p>En este caso, se obtiene un p-value&gt;0.05, lo que indica que el drift no es significativo y, en principio, debería eliminarse del modelo. Luego, se realiza un análisis excluyendo el drift.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>arima<span class="fl">.111</span><span class="ot">&lt;-</span><span class="fu">Arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">include.constant =</span> <span class="cn">FALSE</span>)</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arima<span class="fl">.111</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: endo_ts 
ARIMA(1,1,1) 

Coefficients:
          ar1      ma1
      -0.1185  -0.7976
s.e.   0.1299   0.0774

sigma^2 = 0.4053:  log likelihood = -83.75
AIC=173.51   AICc=173.8   BIC=180.9

Training set error measures:
                       ME     RMSE       MAE  MPE MAPE      MASE       ACF1
Training set -0.007358237 0.625688 0.4943052 -Inf  Inf 0.7418544 0.01161632</code></pre>
</div>
</div>
<p>Al hacerlo, se observa que el modelo sin drift presenta un AIC más bajo (173.51 frente a 175.18 del modelo con drift), lo que indica que es más eficiente en términos de ajuste y parsimonia. Además, el BIC también es menor en el modelo sin drift, lo que refuerza la preferencia por este modelo. Al no incluir el drift, se evita añadir un parámetro innecesario, simplificando el modelo sin perder capacidad predictiva.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(arima<span class="fl">.111</span>), <span class="at">Sigma =</span> <span class="fu">vcov</span>(arima<span class="fl">.111</span>), <span class="at">Terms =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 0.83, df = 1, P(&gt; X2) = 0.36</code></pre>
</div>
</div>
<p>En este caso, se obtiene un p-value&gt;0.05, lo que indica que el drift no es significativo y, en principio, debería elinarse del modelo, reforzando los resultados obtenidos en el anterior test.</p>
<p>En conclusión, el drift no es estadísticamente significativo, por lo tanto, se trabjará con el modelo ARIMA(1,1,1) sin drift.</p>
<section id="intervencion-1" class="level5">
<h5 class="anchored" data-anchor-id="intervencion-1">Intervencion</h5>
<p>Se analiza si para algun periodo se observa un error atípico (2 o 3 veces superior al error estándar).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>es<span class="ot">&lt;-</span><span class="fu">sqrt</span>(arima<span class="fl">.111</span><span class="sc">$</span>sig) </span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(arima<span class="fl">.111</span><span class="sc">$</span>residuals,<span class="dv">2</span><span class="sc">*</span>es,<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>es,<span class="dv">3</span><span class="sc">*</span>es,<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>es,<span class="at">xlab=</span><span class="st">"Periodo"</span>,<span class="at">plot.type=</span><span class="st">"single"</span>,<span class="at">ylab=</span><span class="st">""</span>, <span class="at">main=</span><span class="st">"Error de estimación"</span>,<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>,<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"blue"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La mayoría de los residuos permanecen dentro del rango de ±2σ (rojo), lo que indica que el modelo capta bien la variabilidad de la serie. Sólo algunos valores extremos están cerca de los límites ±3σ (azul), lo cual es normal en cualquier serie temporal.</p>
</section>
<section id="autocorrelación-3" class="level5">
<h5 class="anchored" data-anchor-id="autocorrelación-3">Autocorrelación</h5>
<p>Para analizar la autocorrelación de los residuos, se aplica la prueba de Ljung-Box, la cual evalúa si los residuos del modelo presentan autocorrelación significativa o si pueden considerarse ruido blanco (es decir, si el modelo captura adecuadamente la estructura de los datos). Criterios: • p-value &lt; 0.05, los residuos no son ruido blanco, lo que indica que el modelo no captura toda la estructura de los datos y existe autocorrelación • p-value &gt; 0.05, los residuos son ruido blanco, lo que indica que el modelo captura bien la estructura de los datos y no hay autocorrelación significativa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(arima<span class="fl">.111</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(1,1,1)
Q* = 7.6904, df = 8, p-value = 0.4643

Model df: 2.   Total lags used: 10</code></pre>
</div>
</div>
<p>En este caso, dado que el p-value = 0.4643, se concluye que los residuos no presentan autocorrelación significativa, lo que indica que el modelo ARIMA (1,1,1) es adecuado para representar la serie temporal.</p>
</section>
<section id="homocedasticidad-3" class="level5">
<h5 class="anchored" data-anchor-id="homocedasticidad-3">Homocedasticidad</h5>
<p>Para evaluar la homocedasticidad (es decir, si la varianza de los residuos es constante a lo largo del tiempo), se aplica la prueba de Box-Ljung a los residuos al cuadrado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(arima<span class="fl">.111</span><span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag=</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Ljung test

data:  arima.111$residuals^2
X-squared = 0.86226, df = 2, p-value = 0.6498</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 0.86226 con 2 grados de libertad y un p-value = 0.6498. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que no hay evidencia de heterocedasticidad en los residuos. Esto indica que la varianza de los residuos se mantiene constante, cumpliendo con el supuesto de homocedasticidad.</p>
</section>
<section id="normalidad-1" class="level5">
<h5 class="anchored" data-anchor-id="normalidad-1">Normalidad</h5>
<p>Para evaluar la normalidad de los residuos, se aplica la prueba de Jarque-Bera</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(arima<span class="fl">.111</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  arima.111$residuals
X-squared = 0.82867, df = 2, p-value = 0.6608</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 0.82867 con 2 grados de libertad y un p-value = 0.6608. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que los residuos siguen una distribución normal. Esto indica que el modelo cumple con el supuesto de normalidad en los residuos, lo cual es deseable para la validez de las inferencias estadísticas.</p>
<p>Apartir de este momento se agregara variables exogenas</p>
</section>
</section>
</section>
<section id="análsis-de-las-variables-exógenas" class="level3">
<h3 class="anchored" data-anchor-id="análsis-de-las-variables-exógenas">Análsis de las variables Exógenas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se aplica el test de estacionariedad a las variables exógenas</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(exo_ts,<span class="dv">2</span>,adf.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$DepthSnowPromedio_Verano

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -2.3474, Lag order = 4, p-value = 0.4332
alternative hypothesis: stationary


$TemperaturePromedio_Verano

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -3.3414, Lag order = 4, p-value = 0.06992
alternative hypothesis: stationary


$PrecipitationPromedio_Verano

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -2.7872, Lag order = 4, p-value = 0.2524
alternative hypothesis: stationary


$RadiationPromedio_Anual

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -3.2329, Lag order = 4, p-value = 0.08769
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>se puede ver que todas no son estacionarias, se aplica diferenciación</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>dexo_ts<span class="ot">&lt;-</span><span class="fu">diff</span>(exo_ts)</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co"># aplico el test de estacionariedad a las variables exógenas diferenciadas</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(dexo_ts,<span class="dv">2</span>,adf.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$DepthSnowPromedio_Verano

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -5.3956, Lag order = 4, p-value = 0.01
alternative hypothesis: stationary


$TemperaturePromedio_Verano

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -6.7297, Lag order = 4, p-value = 0.01
alternative hypothesis: stationary


$PrecipitationPromedio_Verano

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -6.3672, Lag order = 4, p-value = 0.01
alternative hypothesis: stationary


$RadiationPromedio_Anual

    Augmented Dickey-Fuller Test

data:  newX[, i]
Dickey-Fuller = -5.2705, Lag order = 4, p-value = 0.01
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>una vez aplicada la diferenciación se puede ver que todas son son estacionarias, ya que tienen un p-value significativo.</p>
<p>Ahora se representan las series temporales de las variables exógenas normal y diferenciadas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Se representa </span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(exo_ts, <span class="at">ylab =</span> <span class="st">"Profundidad Nieve/Radiación / Precipitación / Temp"</span>)</span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="dv">20</span>, <span class="at">ny =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">diff</span>(exo_ts))</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>(<span class="at">nx =</span> <span class="dv">20</span>, <span class="at">ny =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"gray"</span>, <span class="at">lty =</span> <span class="st">"dotted"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-94-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Identificar los valores P y Q</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"RadiationPromedio_Anual"</span>]), <span class="at">main=</span><span class="st">"ACF Radiación (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"RadiationPromedio_Anual"</span>]), <span class="at">main=</span><span class="st">"PACF Radiación (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>• ACF: No se observan rezagos con valores significativamente altos; todos los valores se encuentran dentro de los intervalos de confianza. • PACF: los dos primeros valores son significativos, y los siguientes se encuentran dentro de los límites de confianza, podría indicar un proceso AR (1) o AR (2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Identificar los valores P y Q</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"PrecipitationPromedio_Verano"</span>]), <span class="at">main=</span><span class="st">"ACF Precipitación (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"PrecipitationPromedio_Verano"</span>]), <span class="at">main=</span><span class="st">"PACF Precipitación (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>• ACF, no hay rezagos con valores significativamente altos. • PACF: Los primeros cuatro rezagos son significativos, lo que podría indicar un proceso AR (1) o AR (2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Identificar los valores P y Q</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"TemperaturePromedio_Verano"</span>]), <span class="at">main=</span><span class="st">"ACF Temperatura (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"TemperaturePromedio_Verano"</span>]), <span class="at">main=</span><span class="st">"PACF Temperatura (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>• ACF, la presencia de algunos rezagos significativos sugiere que podría haber un componente MA en el modelo. • PACF: los dos primeros valores son significativos, y los siguientes se encuentran dentro de los límites de confianza, podría indicar un proceso AR (1) o AR (2).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Identificar los valores P y Q</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"DepthSnowPromedio_Verano"</span>]), <span class="at">main=</span><span class="st">"ACF Profundidad de la nieve (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(<span class="fu">diff</span>(exo_ts[,<span class="st">"DepthSnowPromedio_Verano"</span>]), <span class="at">main=</span><span class="st">"PACF Profundidad de la nieve (diferenciada)"</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">ci.col=</span><span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>• ACF: A partir del rezago 14, se observa un valor significativo, lo que sugiere la presencia de una dependencia temporal a largo plazo. • PACF: los dos primeros valores son significativos, y los siguientes se encuentran dentro de los límites de confianza, podría indicar un proceso AR (1) o AR (2).</p>
</section>
</section>
<section id="arimax011" class="level2">
<h2 class="anchored" data-anchor-id="arimax011">ARIMAX(0,1,1)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustar modelo ARMAX final</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>modelo_armax <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xreg =</span> exo_ts)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_armax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = endo_ts, order = c(0, 1, 1), xreg = exo_ts)

Coefficients:
          ma1  DepthSnowPromedio_Verano  TemperaturePromedio_Verano
      -0.7265                    0.2519                     -0.4177
s.e.   0.0838                    0.0853                      0.0705
      PrecipitationPromedio_Verano  RadiationPromedio_Anual
                            0.0413                  -0.0044
s.e.                        0.0466                   0.0058

sigma^2 estimated as 0.2095:  log likelihood = -55.83,  aic = 121.67

Training set error measures:
              ME RMSE MAE MPE MAPE
Training set NaN  NaN NaN NaN  NaN</code></pre>
</div>
</div>
<p>Para determinar qué variables tienen un mayor impacto en el modelo, se analizan los coeficientes de las variables exógenas.</p>
<p>la profundidad de la nieve en verano tiene un impacto positivo en el balance de masa. Específicamente, si la profundidad de la nieve en verano aumenta en 1 unidad, el balance de masa aumenta en 0.2519 unidades. Este resultado tiene bastante sentido, ya que una mayor acumulación de nieve en verano contribuye positivamente al balance de masa.</p>
<p>la temperatura en verano tiene un impacto negativo en el balance de masa. Si el promedio de la temperatura en verano aumenta en 1 unidad, el balance de masa se reduce en 0.4177 unidades. Esto también es coherente, ya que temperaturas más altas pueden acelerar el derretimiento de la nieve y el hielo, reduciendo así el balance de masa.</p>
<p>La precipitación en verano tiene un impacto positivo, aunque menor, en el balance de masa. Un aumento de 1 unidad en la precipitación en verano incrementa el balance de masa en 0.0413 unidades. Este efecto, aunque pequeño, es consistente con la idea de que la precipitación contribuye a la acumulación de nieve y hielo.</p>
<p>Finalmente, la radiación anual tiene un impacto negativo casi nulo en el balance de masa. Un aumento de 1 unidad en la radiación anual reduce el balance de masa en 0.0044 unidades, lo que indica que su influencia es prácticamente insignificante.</p>
<p>Según este modelo ARIMAX (0,1,1), las variables que más impacto tienen sobre el balance de masa son la temperatura en verano y la profundidad de la nieve en verano. Por su parte, la precipitación en verano y la radiación anual tienen un impacto mucho menor. Además, se realiza una prueba de calidad mediante el AIC para evaluar si el modelo mejora al incluir o excluir algunas de estas variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con todas las variables actuales (modelo base)</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>modelo_base <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xreg =</span> exo_ts)</span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 123.6668</code></pre>
</div>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo sin la variable de radiación (porque vimos que tenía poco impacto)</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>modelo_sin_radiacion <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xreg =</span> exo_ts[, <span class="fu">c</span>(<span class="st">"DepthSnowPromedio_Verano"</span>, </span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">"TemperaturePromedio_Verano"</span>, </span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">"PrecipitationPromedio_Verano"</span>)])</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_sin_radiacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 122.2514</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo sin la variable de precipitación</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>modelo_sin_precipitacion <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xreg =</span> exo_ts[, <span class="fu">c</span>(<span class="st">"DepthSnowPromedio_Verano"</span>, </span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"TemperaturePromedio_Verano"</span>, </span>
<span id="cb205-5"><a href="#cb205-5" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"RadiationPromedio_Anual"</span>)])</span>
<span id="cb205-6"><a href="#cb205-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_sin_precipitacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 122.4514</code></pre>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar los AIC</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>aic_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"Base"</span>, <span class="st">"Sin Radiación"</span>, <span class="st">"Sin Precipitación"</span>),</span>
<span id="cb207-4"><a href="#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(modelo_base), <span class="fu">AIC</span>(modelo_sin_radiacion), <span class="fu">AIC</span>(modelo_sin_precipitacion))</span>
<span id="cb207-5"><a href="#cb207-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb207-6"><a href="#cb207-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-7"><a href="#cb207-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Modelo      AIC
1              Base 123.6668
2     Sin Radiación 122.2514
3 Sin Precipitación 122.4514</code></pre>
</div>
</div>
<p>se obtiene que el mejor modelo es sin incluir la radiacion.</p>
<section id="evaluacion" class="level4">
<h4 class="anchored" data-anchor-id="evaluacion">Evaluacion</h4>
<section id="normalidad-2" class="level5">
<h5 class="anchored" data-anchor-id="normalidad-2">Normalidad</h5>
<p>Para evaluar la normalidad de los residuos se aplica la prueba de Jarque Bera . Hipótesis nula (H₀): Los residuos siguen una distribución normal. Hipótesis alternativa (H₁): Los residuos no siguen una distribución normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>residul<span class="ot">&lt;-</span><span class="fu">resid</span>(modelo_armax)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(residul)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  residul
X-squared = 2.3218, df = 2, p-value = 0.3132</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 2.3218 con 2 grados de libertad y un p-value = 0.3132 Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que los residuos siguen una distribución normal.</p>
</section>
<section id="estacionariedad-de-los-residuos-1" class="level5">
<h5 class="anchored" data-anchor-id="estacionariedad-de-los-residuos-1">Estacionariedad de los residuos</h5>
<p>Para evaluar la normalidad de los residuos y asegurar que se comporten como ruido blanco, se aplica la prueba de Dickey-Fuller aumentada (ADF). Esta prueba tiene como hipótesis:</p>
<p>• Hipótesis nula (H₀): Los residuos no se comportan como ruido blanco (no son estacionarios). • Hipótesis alternativa (H₁): Los residuos se comportan como ruido blanco (son estacionarios).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(residul)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  residul
Dickey-Fuller = -3.192, Lag order = 4, p-value = 0.0944
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>El resultado de la prueba muestra un estadístico de Dickey-Fuller = -3.192 y un p-value = 0.0944. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que los residuos no son estacionarios y, por lo tanto, no se comportan completamente como ruido blanco. Esto indica que el modelo podría no estar capturando toda la estructura de la serie.</p>
</section>
<section id="autocorrelación-4" class="level5">
<h5 class="anchored" data-anchor-id="autocorrelación-4">Autocorrelación</h5>
<p>Para analizar la autocorrelación de los residuos, se aplica la prueba de Ljung-Box, la cual evalúa si los residuos del modelo presentan autocorrelación significativa o si pueden considerarse ruido blanco (es decir, si el modelo captura adecuadamente la estructura de los datos). Criterios:</p>
<p>p-value&lt;0.05, los residuos no son ruido blanco, (el modelo no captura toda la estructura de los datos y hay autocorrelación) p-value&gt;0.05, los residuos son ruido blanco, lo que indica que el modelo captura bien la estructura d elos datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(modelo_armax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(0,1,1)
Q* = 3.7482, df = 9, p-value = 0.9272

Model df: 1.   Total lags used: 10</code></pre>
</div>
</div>
<p>En este caso, dado que el p-value = 0.9272, se concluye que los residuos no presentan autocorrelación significativa, lo que indica que el modelo ARIMAX(0,1,1) es adecuado para representar la serie temporal.</p>
</section>
<section id="homocedasticidad-4" class="level5">
<h5 class="anchored" data-anchor-id="homocedasticidad-4">Homocedasticidad</h5>
<p>Para evaluar la homocedasticidad (es decir, si la varianza de los residuos es constante a lo largo del tiempo), se aplica la prueba de Box-Ljung a los residuos al cuadrado.</p>
<p>Hipótesis nula (H₀): No hay autocorrelación en los residuos al cuadrado (los errores son homocedásticos). Hipótesis alternativa (H₁): Hay autocorrelación en los residuos al cuadrado (posible heterocedasticidad).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(modelo_armax<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag=</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Ljung test

data:  modelo_armax$residuals^2
X-squared = 1.4333, df = 2, p-value = 0.4884</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 1.4333 con 2 grados de libertad y un p-value = 0.4884. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que no hay evidencia de heterocedasticidad en los residuos. Esto indica que la varianza de los residuos se mantiene constante, cumpliendo con el supuesto de homocedasticidad.</p>
</section>
</section>
</section>
<section id="arimax111" class="level2">
<h2 class="anchored" data-anchor-id="arimax111">ARIMAX(1,1,1)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo ARMAX(1,1,1)</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>arimax111 <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xreg =</span> exo_ts)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(arimax111)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
arima(x = endo_ts, order = c(1, 1, 1), xreg = exo_ts)

Coefficients:
          ar1      ma1  DepthSnowPromedio_Verano  TemperaturePromedio_Verano
      -0.1851  -0.6328                    0.2533                     -0.4266
s.e.   0.1534   0.1261                    0.0856                      0.0700
      PrecipitationPromedio_Verano  RadiationPromedio_Anual
                            0.0266                  -0.0057
s.e.                        0.0476                   0.0058

sigma^2 estimated as 0.2062:  log likelihood = -55.16,  aic = 122.31

Training set error measures:
              ME RMSE MAE MPE MAPE
Training set NaN  NaN NaN NaN  NaN</code></pre>
</div>
</div>
<p>Para determinar qué variables tienen un mayor impacto en el modelo ARMAX(1,1,1), se analizan los coeficientes de las variables exógenas.</p>
<p>la profundidad de la nieve en verano tiene un impacto positivo en el balance de masa. Específicamente, si la profundidad de la nieve en verano aumenta en 1 unidad, el balance de masa aumenta en 0.2533 unidades. Este resultado tiene bastante sentido, ya que una mayor acumulación de nieve en verano contribuye positivamente al balance de masa.</p>
<p>la temperatura en verano tiene un impacto negativo en el balance de masa. Si el promedio de la temperatura en verano aumenta en 1 unidad, el balance de masa se reduce en 0.4266 unidades. Esto también es coherente, ya que temperaturas más altas pueden acelerar el derretimiento de la nieve y el hielo, reduciendo así el balance de masa.</p>
<p>La precipitación en verano tiene un impacto positivo, aunque menor, en el balance de masa. Un aumento de 1 unidad en la precipitación en verano incrementa el balance de masa en 0.0266 unidades. Este efecto, aunque pequeño, es consistente con la idea de que la precipitación contribuye a la acumulación de nieve y hielo.</p>
<p>La radiación anual tiene un impacto negativo casi nulo en el balance de masa. Un aumento de 1 unidad en la radiación anual reduce el balance de masa en 0.0057 unidades, lo que indica que su influencia es prácticamente insignificante.</p>
<p>Según este modelo ARIMAX (1,1,1), las variables que más impacto tienen sobre el balance de masa son la temperatura en verano y la profundidad de la nieve en verano. Por su parte, la precipitación en verano y la radiación anual tienen un impacto mucho menor. coincidiendo con el modelo anterior.</p>
<p>Además, se realiza una prueba de calidad mediante el AIC para evaluar si el modelo mejora al incluir o excluir algunas de estas variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo con todas las variables actuales (modelo base)</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>modelo_base <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">xreg =</span> exo_ts)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_base)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 124.3131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo sin la variable de radiación (porque vimos que tenía poco impacto)</span></span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>modelo_sin_radiacion <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">xreg =</span> exo_ts[, <span class="fu">c</span>(<span class="st">"DepthSnowPromedio_Verano"</span>, </span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">"TemperaturePromedio_Verano"</span>, </span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">"PrecipitationPromedio_Verano"</span>)])</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_sin_radiacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 122.2514</code></pre>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo sin la variable de precipitación</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>modelo_sin_precipitacion <span class="ot">&lt;-</span> <span class="fu">arima</span>(endo_ts, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), </span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">xreg =</span> exo_ts[, <span class="fu">c</span>(<span class="st">"DepthSnowPromedio_Verano"</span>, </span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"TemperaturePromedio_Verano"</span>, </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>                                                     <span class="st">"RadiationPromedio_Anual"</span>)])</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(modelo_sin_precipitacion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 122.4514</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparar los AIC</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a>aic_values <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"Base"</span>, <span class="st">"Sin Radiación"</span>, <span class="st">"Sin Precipitación"</span>),</span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(modelo_base), <span class="fu">AIC</span>(modelo_sin_radiacion), <span class="fu">AIC</span>(modelo_sin_precipitacion))</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(aic_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Modelo      AIC
1              Base 124.3131
2     Sin Radiación 122.2514
3 Sin Precipitación 122.4514</code></pre>
</div>
</div>
<p>obtengo que el mejor modelo es sin incluir la radiacion.</p>
<section id="evaluacion-1" class="level4">
<h4 class="anchored" data-anchor-id="evaluacion-1">Evaluacion</h4>
<section id="normalidad-3" class="level5">
<h5 class="anchored" data-anchor-id="normalidad-3">Normalidad</h5>
<p>Para evaluar la normalidad de los residuos se aplica la prueba de Jarque Bera . Hipótesis nula (H₀): Los residuos siguen una distribución normal. Hipótesis alternativa (H₁): Los residuos no siguen una distribución normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>residul2<span class="ot">&lt;-</span><span class="fu">resid</span>(arimax111)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(residul2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  residul2
X-squared = 3.1131, df = 2, p-value = 0.2109</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 3.1131 con 2 grados de libertad y un p-value = 0.2109 Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que los residuos siguen una distribución normal. Esto indica que el modelo cumple con el supuesto de normalidad en los residuos, lo cual es deseable para la validez de las inferencias estadísticas.</p>
</section>
<section id="estacionariedad-de-los-residuos-2" class="level5">
<h5 class="anchored" data-anchor-id="estacionariedad-de-los-residuos-2">Estacionariedad de los residuos</h5>
<p>Para evaluar la normalidad de los residuos y asegurar que se comporten como ruido blanco, se aplica la prueba de Dickey-Fuller aumentada (ADF). Esta prueba tiene como hipótesis:</p>
<p>• Hipótesis nula (H₀): Los residuos no se comportan como ruido blanco (no son estacionarios). • Hipótesis alternativa (H₁): Los residuos se comportan como ruido blanco (son estacionarios).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(residul2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Augmented Dickey-Fuller Test

data:  residul2
Dickey-Fuller = -3.5589, Lag order = 4, p-value = 0.04159
alternative hypothesis: stationary</code></pre>
</div>
</div>
<p>En este caso, el resultado de la prueba muestra un estadístico de Dickey-Fuller = -3.5589 y un p-value = 0.04159. Dado que el p-value es menor que 0.05, se rechaza la hipótesis nula, lo que indica que los residuos son estacionarios y, por lo tanto, se comportan como ruido blanco. Esto sugiere que el modelo captura adecuadamente la estructura de la serie, y los residuos no presentan patrones no modelados, lo cual es un resultado favorable para la validez del modelo.</p>
</section>
<section id="autocorrelación-5" class="level5">
<h5 class="anchored" data-anchor-id="autocorrelación-5">Autocorrelación</h5>
<p>Para analizar la autocorrelación de los residuos, se aplica la prueba de Ljung-Box, la cual evalúa si los residuos del modelo presentan autocorrelación significativa o si pueden considerarse ruido blanco (es decir, si el modelo captura adecuadamente la estructura de los datos). Criterios: • p-value &lt; 0.05, los residuos no son ruido blanco, lo que indica que el modelo no captura toda la estructura de los datos y existe autocorrelación • p-value &gt; 0.05, los residuos son ruido blanco, lo que indica que el modelo captura bien la estructura de los datos y no hay autocorrelación significativa.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(arimax111)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Definitivo_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Ljung-Box test

data:  Residuals from ARIMA(1,1,1)
Q* = 2.9927, df = 8, p-value = 0.9348

Model df: 2.   Total lags used: 10</code></pre>
</div>
</div>
<p>En este caso, dado que el p-value = 0.9348, se concluye que los residuos no presentan autocorrelación significativa, lo que indica que el modelo ARIMAX (1,1,1) es adecuado para representar la serie temporal.</p>
</section>
<section id="homocedasticidad-5" class="level5">
<h5 class="anchored" data-anchor-id="homocedasticidad-5">Homocedasticidad</h5>
<p>Para evaluar la homocedasticidad (es decir, si la varianza de los residuos es constante a lo largo del tiempo), se aplica la prueba de Box-Ljung a los residuos al cuadrado.</p>
<p>Hipótesis nula (H₀): No hay autocorrelación en los residuos al cuadrado (los errores son homocedásticos). Hipótesis alternativa (H₁): Hay autocorrelación en los residuos al cuadrado (posible heterocedasticidad).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(arimax111<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>, <span class="at">lag=</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">"Ljung-Box"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Box-Ljung test

data:  arimax111$residuals^2
X-squared = 1.5558, df = 2, p-value = 0.4594</code></pre>
</div>
</div>
<p>En este caso, el resultado del test muestra un estadístico X-squared = 1.5558 con 2 grados de libertad y un p-value = 0.4594. Dado que el p-value es mayor que 0.05, no se rechaza la hipótesis nula, lo que sugiere que no hay evidencia de heterocedasticidad en los residuos. Esto indica que la varianza de los residuos se mantiene constante, cumpliendo con el supuesto de homocedasticidad.</p>
</section>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>